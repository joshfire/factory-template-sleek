/**
 * almond 0.0.3 Copyright (c) 2011, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 *//*jslint strict: false, plusplus: false *//*global setTimeout: false */var requirejs,require,define;(function(a){function g(a,b){if(a&&a.charAt(0)==="."&&b){b=b.split("/"),b=b.slice(0,b.length-1),a=b.concat(a.split("/"));var c,d;for(c=0;d=a[c];c++)if(d===".")a.splice(c,1),c-=1;else if(d===".."){if(c===1&&(a[2]===".."||a[0]===".."))break;c>0&&(a.splice(c-1,2),c-=2)}a=a.join("/")}return a}function h(b,c){return function(){return f.apply(a,d.call(arguments,0).concat([b,c]))}}function i(a){return function(b){return g(b,a)}}function j(a){return function(c){b[a]=c}}function k(d){if(c.hasOwnProperty(d)){var f=c[d];delete c[d],e.apply(a,f)}return b[d]}function l(a,b){var c,d,e=a.indexOf("!");return e!==-1?(c=g(a.slice(0,e),b),a=a.slice(e+1),d=k(c),d&&d.normalize?a=d.normalize(a,i(b)):a=g(a,b)):a=g(a,b),{f:c?c+"!"+a:a,n:a,p:d}}var b={},c={},d=[].slice,e,f;if(typeof define=="function")return;e=function(d,e,f,g){var i=[],m,n,o,p,q,r;g||(g=d);if(typeof f=="function"){!e.length&&f.length&&(e=["require","exports","module"]);for(p=0;p<e.length;p++){r=l(e[p],g),o=r.f;if(o==="require")i[p]=h(d);else if(o==="exports")i[p]=b[d]={},m=!0;else if(o==="module")n=i[p]={id:d,uri:"",exports:b[d]};else if(b.hasOwnProperty(o)||c.hasOwnProperty(o))i[p]=k(o);else{if(!r.p)throw d+" missing "+o;r.p.load(r.n,h(g,!0),j(o),{}),i[p]=b[o]}}q=f.apply(b[d],i),d&&(n&&n.exports!==a?b[d]=n.exports:m||(b[d]=q))}else d&&(b[d]=f)},requirejs=f=function(b,c,d,g){return typeof b=="string"?k(l(b,c).f):(b.splice||(c.splice?(b=c,c=arguments[2]):b=[]),g?e(a,b,c,d):setTimeout(function(){e(a,b,c,d)},15),f)},f.config=function(){return f},require||(require=f),define=function(a,b,d){b.splice||(d=b,b=[]),define.unordered?c[a]=[a,b,d]:e(a,b,d)},define.amd={jQuery:!0}})();/*!
 * Joshfire Framework 0.9.1
 * http://framework.joshfire.com/
 *
 * Copyright 2011, Joshfire
 * Dual licensed under the GPL Version 2 and a Commercial license.
 * http://framework.joshfire.com/license
 *
 * Date: Wed Jul 20 20:23:43 2011
 */
/*!
 * Joshfire Framework 0.9.1
 * http://framework.joshfire.com/
 *
 * Copyright 2011, Joshfire
 * Dual licensed under the GPL Version 2 and a Commercial license.
 * http://framework.joshfire.com/license
 *
 * Date: Wed Jul 20 20:23:43 2011
 */
/*!
 * iScroll v4.2 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */
!function(a,b){function c(a,b){function c(){}c[i]=this[i];var e=this,f=new c,g=j(a),h=g?a:this,k=g?{}:a,l=function(){this.initialize?this.initialize.apply(this,arguments):(b||g&&e.apply(this,arguments),h.apply(this,arguments))};return l.methods=function(a){return d(f,a,e),l[i]=f,this},l.methods.call(l,k).prototype.constructor=l,l.extend=arguments.callee,l[i].implement=l.statics=function(a,b){return a=typeof a=="string"?function(){var c={};return c[a]=b,c}():a,d(this,a,e),this},l}function d(a,b,c){for(var d in b)b.hasOwnProperty(d)&&(a[d]=j(b[d])&&j(c[i][d])&&g.test(b[d])?e(d,b[d],c):b[d])}function e(a,b,c){return function(){var d=this.supr;this.supr=c[i][a];var e=b.apply(this,arguments);return this.supr=d,e}}function f(a){return c.call(j(a)?a:h,a,1)}var g=/xyz/.test(function(){xyz})?/\bsupr\b/:/.*/,h=function(){},i="prototype",j=function(a){return typeof a===b};if(typeof module!="undefined"&&module.exports)module.exports=f;else{var k=a.klass;f.noConflict=function(){return a.klass=k,this},a.klass=f}}(this,"function"),define("vendor/klass",function(){}),function(a){Function.prototype.bind||(Function.prototype.bind=function(a){var b=[].slice,c=b.call(arguments,1),d=this,e=function(){},f=function(){return d.apply(this instanceof e?this:a||{},c.concat(b.call(arguments)))};return e.prototype=d.prototype,f.prototype=new e,f}),typeof a.Code=="undefined"&&(a.Code={}),a.Code.Util={registerNamespace:function(){var b=arguments,c=null,d,f,g,h,i;d=0;for(h=b.length;d<h;d++){g=b[d],g=g.split("."),c=g[0],typeof a[c]=="undefined"&&(a[c]={}),c=a[c],f=1;for(i=g.length;f<i;++f)c[g[f]]=c[g[f]]||{},c=c[g[f]]}},coalesce:function(){var a,b;a=0;for(b=arguments.length;a<b;a++)if(!this.isNothing(arguments[a]))return arguments[a];return null},extend:function(a,b,c){var d;this.isNothing(c)&&(c=!0);if(a&&b&&this.isObject(b))for(d in b)this.objectHasProperty(b,d)&&(c?a[d]=b[d]:typeof a[d]=="undefined"&&(a[d]=b[d]))},clone:function(a){var b={};return this.extend(b,a),b},isObject:function(a){return a instanceof Object},isFunction:function(a){return{}.toString.call(a)==="[object Function]"},isArray:function(a){return a instanceof Array},isLikeArray:function(a){return typeof a.length=="number"},isNumber:function(a){return typeof a=="number"},isString:function(a){return typeof a=="string"},isNothing:function(a){return typeof a=="undefined"||a===null?!0:!1},swapArrayElements:function(a,b,c){var d=a[b];a[b]=a[c],a[c]=d},trim:function(a){return a.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},toCamelCase:function(a){return a.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})},toDashedCase:function(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})},arrayIndexOf:function(a,b,c){var d,e,f,g;f=-1,d=0;for(e=b.length;d<e;d++)if(g=b[d],this.isNothing(c)){if(g===a){f=d;break}}else if(this.objectHasProperty(g,c)&&g[c]===a){f=d;break}return f},objectHasProperty:function(a,b){return a.hasOwnProperty?a.hasOwnProperty(b):"undefined"!=typeof a[b]}}}(window),function(a,b){b.Browser={ua:null,version:null,safari:null,webkit:null,opera:null,msie:null,chrome:null,mozilla:null,android:null,blackberry:null,iPad:null,iPhone:null,iPod:null,iOS:null,is3dSupported:null,isCSSTransformSupported:null,isTouchSupported:null,isGestureSupported:null,_detect:function(){this.ua=a.navigator.userAgent,this.version=this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[],this.safari=/Safari/gi.test(a.navigator.appVersion),this.webkit=/webkit/i.test(this.ua),this.opera=/opera/i.test(this.ua),this.msie=/msie/i.test(this.ua)&&!this.opera,this.chrome=/Chrome/i.test(this.ua),this.firefox=/Firefox/i.test(this.ua),this.fennec=/Fennec/i.test(this.ua),this.mozilla=/mozilla/i.test(this.ua)&&!/(compatible|webkit)/.test(this.ua),this.android=/android/i.test(this.ua),this.blackberry=/blackberry/i.test(this.ua),this.iOS=/iphone|ipod|ipad/gi.test(a.navigator.platform),this.iPad=/ipad/gi.test(a.navigator.platform),this.iPhone=/iphone/gi.test(a.navigator.platform),this.iPod=/ipod/gi.test(a.navigator.platform);var d=document.createElement("div");this.is3dSupported=!b.isNothing(d.style.WebkitPerspective),this.isCSSTransformSupported=!b.isNothing(d.style.WebkitTransform)||!b.isNothing(d.style.MozTransform)||!b.isNothing(d.style.transformProperty),this.isTouchSupported=this.isEventSupported("touchstart"),this.isGestureSupported=this.isEventSupported("gesturestart")},_eventTagNames:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},isEventSupported:function(a){var d=document.createElement(this._eventTagNames[a]||"div"),e,a="on"+a;return e=b.objectHasProperty(d,a),e||(d.setAttribute(a,"return;"),e=typeof d[a]=="function"),e},isLandscape:function(){return b.DOM.windowWidth()>b.DOM.windowHeight()}},b.Browser._detect()}(window,window.Code.Util),function(a,b){b.extend(b,{Events:{add:function(a,b,c){this._checkHandlersProperty(a),b==="mousewheel"&&(b=this._normaliseMouseWheelType()),typeof a.__eventHandlers[b]=="undefined"&&(a.__eventHandlers[b]=[]),a.__eventHandlers[b].push(c),this._isBrowserObject(a)&&a.addEventListener(b,c,!1)},remove:function(a,d,e){this._checkHandlersProperty(a),d==="mousewheel"&&(d=this._normaliseMouseWheelType());if(a.__eventHandlers[d]instanceof Array){var f,g,h=a.__eventHandlers[d];if(b.isNothing(e)){if(this._isBrowserObject(a)){f=0;for(g=h.length;f<g;f++)a.removeEventListener(d,h[f],!1)}a.__eventHandlers[d]=[]}else{f=0;for(g=h.length;f<g;f++)if(h[f]===e){h.splice(f,1);break}this._isBrowserObject(a)&&a.removeEventListener(d,e,!1)}}},fire:function(d,f){var g,h,i,j,k=Array.prototype.slice.call(arguments).splice(2);f==="mousewheel"&&(f=this._normaliseMouseWheelType());if(this._isBrowserObject(d)){if(typeof f!="string")throw"type must be a string for DOM elements";i=this._NATIVE_EVENTS[f],g=document.createEvent(i?"HTMLEvents":"UIEvents"),g[i?"initEvent":"initUIEvent"](f,!0,!0,a,1);if(k.length<1){d.dispatchEvent(g);return}}this._checkHandlersProperty(d),g=typeof f=="string"?{type:f}:f,g.target||(g.target=d);if(!g.type)throw Error("Event object missing 'type' property.");if(d.__eventHandlers[g.type]instanceof Array){i=d.__eventHandlers[g.type],k.unshift(g),g=0;for(h=i.length;g<h;g++)j=i[g],b.isNothing(j)||j.apply(d,k)}},getMousePosition:function(a){var b={x:0,y:0};return a.pageX?b.x=a.pageX:a.clientX&&(b.x=a.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)),a.pageY?b.y=a.pageY:a.clientY&&(b.y=a.clientY+(document.documentElement.scrollTop||document.body.scrollTop)),b},getTouchEvent:function(a){return a},getWheelDelta:function(a){var d=0;return b.isNothing(a.wheelDelta)?b.isNothing(a.detail)||(d=-a.detail/3):d=a.wheelDelta/120,d},domReady:function(a){document.addEventListener("DOMContentLoaded",a,!1)},_checkHandlersProperty:function(a){b.isNothing(a.__eventHandlers)&&b.extend(a,{__eventHandlers:{}})},_isBrowserObject:function(b){return b===a||b===a.document?!0:this._isElement(b)||this._isNode(b)},_isElement:function(b){return typeof a.HTMLElement=="object"?b instanceof a.HTMLElement:typeof b=="object"&&b.nodeType===1&&typeof b.nodeName=="string"},_isNode:function(b){return typeof a.Node=="object"?b instanceof a.Node:typeof b=="object"&&typeof b.nodeType=="number"&&typeof b.nodeName=="string"},_normaliseMouseWheelType:function(){return b.Browser.isEventSupported("mousewheel")?"mousewheel":"DOMMouseScroll"},_NATIVE_EVENTS:{click:1,dblclick:1,mouseup:1,mousedown:1,contextmenu:1,mousewheel:1,DOMMouseScroll:1,mouseover:1,mouseout:1,mousemove:1,selectstart:1,selectend:1,keydown:1,keypress:1,keyup:1,orientationchange:1,touchstart:1,touchmove:1,touchend:1,touchcancel:1,gesturestart:1,gesturechange:1,gestureend:1,focus:1,blur:1,change:1,reset:1,select:1,submit:1,load:1,unload:1,beforeunload:1,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1}}})}(window,window.Code.Util),function(a,b){b.extend(b,{DOM:{setData:function(a,d,e){if(b.isLikeArray(a)){var f,g;f=0;for(g=a.length;f<g;f++)b.DOM._setData(a[f],d,e)}else b.DOM._setData(a,d,e)},_setData:function(a,d,e){b.DOM.setAttribute(a,"data-"+d,e)},getData:function(a,d,e){return b.DOM.getAttribute(a,"data-"+d,e)},removeData:function(a,d){if(b.isLikeArray(a)){var e,f;e=0;for(f=a.length;e<f;e++)b.DOM._removeData(a[e],d)}else b.DOM._removeData(a,d)},_removeData:function(a,d){b.DOM.removeAttribute(a,"data-"+d)},isChildOf:function(a,b){if(b===a)return!1;for(;a&&a!==b;)a=a.parentNode;return a===b},find:function(d,f){b.isNothing(f)&&(f=a.document);var g=f.querySelectorAll(d),h=[],i,j;i=0;for(j=g.length;i<j;i++)h.push(g[i]);return h},createElement:function(a,d,e){var f,a=document.createElement(a);for(f in d)b.objectHasProperty(d,f)&&a.setAttribute(f,d[f]);return a.innerHTML=e||"",a},appendChild:function(a,b){b.appendChild(a)},insertBefore:function(a,b,c){c.insertBefore(a,b)},appendText:function(a,d){b.DOM.appendChild(document.createTextNode(a),d)},appendToBody:function(a){this.appendChild(a,document.body)},removeChild:function(a,b){b.removeChild(a)},removeChildren:function(a){if(a.hasChildNodes())for(;a.childNodes.length>=1;)a.removeChild(a.childNodes[a.childNodes.length-1])},hasAttribute:function(a,d){return!b.isNothing(a.getAttribute(d))},getAttribute:function(a,d,e){return a=a.getAttribute(d),b.isNothing(a)&&!b.isNothing(e)&&(a=e),a},setAttribute:function(a,d,e){if(b.isLikeArray(a)){var f,g;f=0;for(g=a.length;f<g;f++)b.DOM._setAttribute(a[f],d,e)}else b.DOM._setAttribute(a,d,e)},_setAttribute:function(a,b,c){a.setAttribute(b,c)},removeAttribute:function(a,d){if(b.isLikeArray(a)){var e,f;e=0;for(f=a.length;e<f;e++)b.DOM._removeAttribute(a[e],d)}else b.DOM._removeAttribute(a,d)},_removeAttribute:function(a,b){this.hasAttribute(a,b)&&a.removeAttribute(b)},addClass:function(a,d){if(b.isLikeArray(a)){var e,f;e=0;for(f=a.length;e<f;e++)b.DOM._addClass(a[e],d)}else b.DOM._addClass(a,d)},_addClass:function(a,d){var e=b.DOM.getAttribute(a,"class","");RegExp("(?:^|\\s+)"+d+"(?:\\s+|$)").test(e)||(e!==""&&(e+=" "),e+=d,b.DOM.setAttribute(a,"class",e))},removeClass:function(a,d){if(b.isLikeArray(a)){var e,f;e=0;for(f=a.length;e<f;e++)b.DOM._removeClass(a[e],d)}else b.DOM._removeClass(a,d)},_removeClass:function(a,d){var e=b.DOM.getAttribute(a,"class",""),e=b.trim(e).split(" "),f="",g,h;g=0;for(h=e.length;g<h;g++)e[g]!==d&&(f!==""&&(f+=" "),f+=e[g]);f===""?b.DOM.removeAttribute(a,"class"):b.DOM.setAttribute(a,"class",f)},hasClass:function(a,d){return RegExp("(?:^|\\s+)"+d+"(?:\\s+|$)").test(b.DOM.getAttribute(a,"class",""))},setStyle:function(a,d,e){if(b.isLikeArray(a)){var f,g;f=0;for(g=a.length;f<g;f++)b.DOM._setStyle(a[f],d,e)}else b.DOM._setStyle(a,d,e)},_setStyle:function(a,d,e){var f;if(b.isObject(d))for(f in d)b.objectHasProperty(d,f)&&(f==="width"?b.DOM.width(a,d[f]):f==="height"?b.DOM.height(a,d[f]):a.style[f]=d[f]);else a.style[d]=e},getStyle:function(b,c){var d=a.getComputedStyle(b,"").getPropertyValue(c);return d===""&&(d=b.style[c]),d},hide:function(a){if(b.isLikeArray(a)){var d,e;d=0;for(e=a.length;d<e;d++)b.DOM._hide(a[d])}else b.DOM._hide(a)},_hide:function(a){b.DOM.setData(a,"ccl-disp",b.DOM.getStyle(a,"display")),b.DOM.setStyle(a,"display","none")},show:function(a){if(b.isLikeArray(a)){var d,e;d=0;for(e=a.length;d<e;d++)b.DOM._show(a[d])}else b.DOM._show(a)},_show:function(a){if(b.DOM.getStyle(a,"display")==="none"){var d=b.DOM.getData(a,"ccl-disp","block");if(d==="none"||d==="")d="block";b.DOM.setStyle(a,"display",d)}},width:function(a,d){return b.isNothing(d)||(b.isNumber(d)&&(d+="px"),a.style.width=d),this._getDimension(a,"width")},outerWidth:function(a){var d=b.DOM.width(a);return d+=parseInt(b.DOM.getStyle(a,"padding-left"),10)+parseInt(b.DOM.getStyle(a,"padding-right"),10),d+=parseInt(b.DOM.getStyle(a,"margin-left"),10)+parseInt(b.DOM.getStyle(a,"margin-right"),10),d+=parseInt(b.DOM.getStyle(a,"border-left-width"),10)+parseInt(b.DOM.getStyle(a,"border-right-width"),10),d},height:function(a,d){return b.isNothing(d)||(b.isNumber(d)&&(d+="px"),a.style.height=d),this._getDimension(a,"height")},_getDimension:function(b,c){var d=a.parseInt(a.getComputedStyle(b,"").getPropertyValue(c)),f;return isNaN(d)&&(f={display:b.style.display,left:b.style.left},b.style.display="block",b.style.left="-1000000px",d=a.parseInt(a.getComputedStyle(b,"").getPropertyValue(c)),b.style.display=f.display,b.style.left=f.left),d},outerHeight:function(a){var d=b.DOM.height(a);return d+=parseInt(b.DOM.getStyle(a,"padding-top"),10)+parseInt(b.DOM.getStyle(a,"padding-bottom"),10),d+=parseInt(b.DOM.getStyle(a,"margin-top"),10)+parseInt(b.DOM.getStyle(a,"margin-bottom"),10),d+=parseInt(b.DOM.getStyle(a,"border-top-width"),10)+parseInt(b.DOM.getStyle(a,"border-bottom-width"),10),d},documentWidth:function(){return b.DOM.width(document.documentElement)},documentHeight:function(){return b.DOM.height(document.documentElement)},documentOuterWidth:function(){return b.DOM.width(document.documentElement)},documentOuterHeight:function(){return b.DOM.outerHeight(document.documentElement)},bodyWidth:function(){return b.DOM.width(document.body)},bodyHeight:function(){return b.DOM.height(document.body)},bodyOuterWidth:function(){return b.DOM.outerWidth(document.body)},bodyOuterHeight:function(){return b.DOM.outerHeight(document.body)},windowWidth:function(){return a.innerWidth},windowHeight:function(){return a.innerHeight},windowScrollLeft:function(){return a.pageXOffset},windowScrollTop:function(){return a.pageYOffset}}})}(window,window.Code.Util),function(a,b){b.extend(b,{Animation:{_applyTransitionDelay:50,_transitionEndLabel:a.document.documentElement.style.webkitTransition!==void 0?"webkitTransitionEnd":"transitionend",_transitionEndHandler:null,_transitionPrefix:a.document.documentElement.style.webkitTransition!==void 0?"webkitTransition":a.document.documentElement.style.MozTransition!==void 0?"MozTransition":"transition",_transformLabel:a.document.documentElement.style.webkitTransform!==void 0?"webkitTransform":a.document.documentElement.style.MozTransition!==void 0?"MozTransform":"transform",_getTransitionEndHandler:function(){return b.isNothing(this._transitionEndHandler)&&(this._transitionEndHandler=this._onTransitionEnd.bind(this)),this._transitionEndHandler},stop:function(d){if(b.Browser.isCSSTransformSupported){var f={};b.Events.remove(d,this._transitionEndLabel,this._getTransitionEndHandler()),b.isNothing(d.callbackLabel)&&delete d.callbackLabel,f[this._transitionPrefix+"Property"]="",f[this._transitionPrefix+"Duration"]="",f[this._transitionPrefix+"TimingFunction"]="",f[this._transitionPrefix+"Delay"]="",f[this._transformLabel]="",b.DOM.setStyle(d,f)}else b.isNothing(a.jQuery)||a.jQuery(d).stop(!0,!0)},fadeIn:function(d,f,g,h,i){i=b.coalesce(i,1),i<=0&&(i=1);if(f<=0&&(b.DOM.setStyle(d,"opacity",i),!b.isNothing(g))){g(d);return}b.DOM.getStyle(d,"opacity")>=1&&b.DOM.setStyle(d,"opacity",0),b.Browser.isCSSTransformSupported?this._applyTransition(d,"opacity",i,f,g,h):b.isNothing(a.jQuery)||a.jQuery(d).fadeTo(f,i,g)},fadeTo:function(a,b,c,d,e){this.fadeIn(a,c,d,e,b)},fadeOut:function(d,f,g,h){if(f<=0&&(b.DOM.setStyle(d,"opacity",0),!b.isNothing(g))){g(d);return}b.Browser.isCSSTransformSupported?this._applyTransition(d,"opacity",0,f,g,h):a.jQuery(d).fadeTo(f,0,g)},slideBy:function(d,f,g,h,i,j){var k={},f=b.coalesce(f,0),g=b.coalesce(g,0),j=b.coalesce(j,"ease-out");k[this._transitionPrefix+"Property"]="all",k[this._transitionPrefix+"Delay"]="0",h===0?(k[this._transitionPrefix+"Duration"]="",k[this._transitionPrefix+"TimingFunction"]=""):(k[this._transitionPrefix+"Duration"]=h+"ms",k[this._transitionPrefix+"TimingFunction"]=b.coalesce(j,"ease-out"),b.Events.add(d,this._transitionEndLabel,this._getTransitionEndHandler())),k[this._transformLabel]=b.Browser.is3dSupported?"translate3d("+f+"px, "+g+"px, 0px)":"translate("+f+"px, "+g+"px)",b.isNothing(i)||(d.cclallcallback=i),b.DOM.setStyle(d,k),h===0&&a.setTimeout(function(){this._leaveTransforms(d)}.bind(this),this._applyTransitionDelay)},resetTranslate:function(a){var d={};d[this._transformLabel]=d[this._transformLabel]=b.Browser.is3dSupported?"translate3d(0px, 0px, 0px)":"translate(0px, 0px)",b.DOM.setStyle(a,d)},_applyTransition:function(d,f,g,h,i,j){var k={},j=b.coalesce(j,"ease-in");k[this._transitionPrefix+"Property"]=f,k[this._transitionPrefix+"Duration"]=h+"ms",k[this._transitionPrefix+"TimingFunction"]=j,k[this._transitionPrefix+"Delay"]="0",b.Events.add(d,this._transitionEndLabel,this._getTransitionEndHandler()),b.DOM.setStyle(d,k),b.isNothing(i)||(d["ccl"+f+"callback"]=i),a.setTimeout(function(){b.DOM.setStyle(d,f,g)},this._applyTransitionDelay)},_onTransitionEnd:function(a){b.Events.remove(a.currentTarget,this._transitionEndLabel,this._getTransitionEndHandler()),this._leaveTransforms(a.currentTarget)},_leaveTransforms:function(d){var f=d.style[this._transitionPrefix+"Property"],g=f!==""?"ccl"+f+"callback":"cclallcallback",h,f=b.coalesce(d.style.webkitTransform,d.style.MozTransform,d.style.transform),i,j=a.parseInt(b.DOM.getStyle(d,"left"),0),k=a.parseInt(b.DOM.getStyle(d,"top"),0),l,m,n={};f!==""&&(f=b.Browser.is3dSupported?f.match(/translate3d\((.*?)\)/):f.match(/translate\((.*?)\)/),b.isNothing(f)||(i=f[1].split(", "),l=a.parseInt(i[0],0),m=a.parseInt(i[1],0))),n[this._transitionPrefix+"Property"]="",n[this._transitionPrefix+"Duration"]="",n[this._transitionPrefix+"TimingFunction"]="",n[this._transitionPrefix+"Delay"]="",b.DOM.setStyle(d,n),a.setTimeout(function(){b.isNothing(i)||(n={},n[this._transformLabel]="",n.left=j+l+"px",n.top=k+m+"px",b.DOM.setStyle(d,n)),b.isNothing(d[g])||(h=d[g],delete d[g],h(d))}.bind(this),this._applyTransitionDelay)}}})}(window,window.Code.Util),function(a,b,c){c.registerNamespace("Code.Util.TouchElement"),c.TouchElement.EventTypes={onTouch:"CodeUtilTouchElementOnTouch"},c.TouchElement.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",tap:"tap",doubleTap:"doubleTap",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",gestureStart:"gestureStart",gestureChange:"gestureChange",gestureEnd:"gestureEnd"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.Util.TouchElement"),c.TouchElement.TouchElementClass=b({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,doubleTapTimeout:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,mouseDownHandler:null,mouseMoveHandler:null,mouseUpHandler:null,mouseOutHandler:null,gestureStartHandler:null,gestureChangeHandler:null,gestureEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,doubleTapSpeed:null,dispose:function(){var a;this.removeEventHandlers();for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(a,b){this.el=a,this.captureSettings={swipe:!1,move:!1,gesture:!1,doubleTap:!1,preventDefaultTouchEvents:!0},c.extend(this.captureSettings,b),this.swipeThreshold=50,this.doubleTapSpeed=this.swipeTimeThreshold=250,this.touchStartPoint={x:0,y:0},this.touchEndPoint={x:0,y:0}},addEventHandlers:function(){c.isNothing(this.touchStartHandler)&&(this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndHandler=this.onTouchEnd.bind(this),this.mouseDownHandler=this.onMouseDown.bind(this),this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),this.mouseOutHandler=this.onMouseOut.bind(this),this.gestureStartHandler=this.onGestureStart.bind(this),this.gestureChangeHandler=this.onGestureChange.bind(this),this.gestureEndHandler=this.onGestureEnd.bind(this)),c.Events.add(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&c.Events.add(this.el,"touchmove",this.touchMoveHandler),c.Events.add(this.el,"touchend",this.touchEndHandler),c.Events.add(this.el,"mousedown",this.mouseDownHandler),c.Browser.isGestureSupported&&this.captureSettings.gesture&&(c.Events.add(this.el,"gesturestart",this.gestureStartHandler),c.Events.add(this.el,"gesturechange",this.gestureChangeHandler),c.Events.add(this.el,"gestureend",this.gestureEndHandler))},removeEventHandlers:function(){c.Events.remove(this.el,"touchstart",this.touchStartHandler),this.captureSettings.move&&c.Events.remove(this.el,"touchmove",this.touchMoveHandler),c.Events.remove(this.el,"touchend",this.touchEndHandler),c.Events.remove(this.el,"mousedown",this.mouseDownHandler),c.Browser.isGestureSupported&&this.captureSettings.gesture&&(c.Events.remove(this.el,"gesturestart",this.gestureStartHandler),c.Events.remove(this.el,"gesturechange",this.gestureChangeHandler),c.Events.remove(this.el,"gestureend",this.gestureEndHandler))},getTouchPoint:function(a){return{x:a[0].pageX,y:a[0].pageY}},fireTouchEvent:function(b){var d=0,f=0,g=0,h,d=this.touchEndPoint.x-this.touchStartPoint.x,f=this.touchEndPoint.y-this.touchStartPoint.y,g=Math.sqrt(d*d+f*f);if(this.captureSettings.swipe&&(h=new Date,h-=this.touchStartTime,h<=this.swipeTimeThreshold)){if(a.Math.abs(d)>=this.swipeThreshold){c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:d<0?c.TouchElement.ActionTypes.swipeLeft:c.TouchElement.ActionTypes.swipeRight,targetEl:b.target,currentTargetEl:b.currentTarget});return}if(a.Math.abs(f)>=this.swipeThreshold){c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:f<0?c.TouchElement.ActionTypes.swipeUp:c.TouchElement.ActionTypes.swipeDown,targetEl:b.target,currentTargetEl:b.currentTarget});return}}g>1?c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:b.target,currentTargetEl:b.currentTarget}):this.captureSettings.doubleTap?c.isNothing(this.doubleTapTimeout)?this.doubleTapTimeout=a.setTimeout(function(){this.doubleTapTimeout=null,c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.tap,targetEl:b.target,currentTargetEl:b.currentTarget})}.bind(this),this.doubleTapSpeed):(a.clearTimeout(this.doubleTapTimeout),this.doubleTapTimeout=null,c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.doubleTap,targetEl:b.target,currentTargetEl:b.currentTarget})):c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:c.TouchElement.ActionTypes.tap,targetEl:b.target,currentTargetEl:b.currentTarget})},onTouchStart:function(a){this.captureSettings.preventDefaultTouchEvents&&a.preventDefault(),c.Events.remove(this.el,"mousedown",this.mouseDownHandler);var b=c.Events.getTouchEvent(a).touches;b.length>1&&this.captureSettings.gesture?this.isGesture=!0:(this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=this.getTouchPoint(b),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:a.target,currentTargetEl:a.currentTarget}))},onTouchMove:function(a){this.captureSettings.preventDefaultTouchEvents&&a.preventDefault();if(!this.isGesture||!this.captureSettings.gesture){var b=c.Events.getTouchEvent(a).touches;c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMove,point:this.getTouchPoint(b),targetEl:a.target,currentTargetEl:a.currentTarget})}},onTouchEnd:function(a){if(!this.isGesture||!this.captureSettings.gesture){this.captureSettings.preventDefaultTouchEvents&&a.preventDefault();var b=c.Events.getTouchEvent(a);this.touchEndPoint=this.getTouchPoint(c.isNothing(b.changedTouches)?b.touches:b.changedTouches),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:a.target,currentTargetEl:a.currentTarget}),this.fireTouchEvent(a)}},onMouseDown:function(a){a.preventDefault(),c.Events.remove(this.el,"touchstart",this.mouseDownHandler),c.Events.remove(this.el,"touchmove",this.touchMoveHandler),c.Events.remove(this.el,"touchend",this.touchEndHandler),this.captureSettings.move&&c.Events.add(this.el,"mousemove",this.mouseMoveHandler),c.Events.add(this.el,"mouseup",this.mouseUpHandler),c.Events.add(this.el,"mouseout",this.mouseOutHandler),this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=c.Events.getMousePosition(a),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:a.target,currentTargetEl:a.currentTarget})},onMouseMove:function(a){a.preventDefault(),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchMove,point:c.Events.getMousePosition(a),targetEl:a.target,currentTargetEl:a.currentTarget})},onMouseUp:function(a){a.preventDefault(),this.captureSettings.move&&c.Events.remove(this.el,"mousemove",this.mouseMoveHandler),c.Events.remove(this.el,"mouseup",this.mouseUpHandler),c.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=c.Events.getMousePosition(a),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:a.target,currentTargetEl:a.currentTarget}),this.fireTouchEvent(a)},onMouseOut:function(a){var b=a.relatedTarget;this.el!==b&&!c.DOM.isChildOf(b,this.el)&&(a.preventDefault(),this.captureSettings.move&&c.Events.remove(this.el,"mousemove",this.mouseMoveHandler),c.Events.remove(this.el,"mouseup",this.mouseUpHandler),c.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=c.Events.getMousePosition(a),c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:a.target,currentTargetEl:a.currentTarget}),this.fireTouchEvent(a))},onGestureStart:function(a){a.preventDefault();var b=c.Events.getTouchEvent(a);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureStart,scale:b.scale,rotation:b.rotation,targetEl:a.target,currentTargetEl:a.currentTarget})},onGestureChange:function(a){a.preventDefault();var b=c.Events.getTouchEvent(a);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureChange,scale:b.scale,rotation:b.rotation,targetEl:a.target,currentTargetEl:a.currentTarget})},onGestureEnd:function(a){a.preventDefault();var b=c.Events.getTouchEvent(a);c.Events.fire(this,{type:c.TouchElement.EventTypes.onTouch,target:this,action:c.TouchElement.ActionTypes.gestureEnd,scale:b.scale,rotation:b.rotation,targetEl:a.target,currentTargetEl:a.currentTarget})}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Image"),a.Code.PhotoSwipe.Image.EventTypes={onLoad:"onLoad",onError:"onError"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Image");var d=a.Code.PhotoSwipe;d.Image.ImageClass=b({refObj:null,imageEl:null,src:null,caption:null,metaData:null,imageLoadHandler:null,imageErrorHandler:null,dispose:function(){var a;this.shrinkImage();for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,c,d,f){this.refObj=b,this.src=this.originalSrc=c,this.caption=d,this.metaData=f,this.imageEl=new a.Image,this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this)},load:function(){this.imageEl.originalSrc=c.coalesce(this.imageEl.originalSrc,""),this.imageEl.originalSrc===this.src?this.imageEl.isError?c.Events.fire(this,{type:d.Image.EventTypes.onError,target:this}):c.Events.fire(this,{type:d.Image.EventTypes.onLoad,target:this}):(this.imageEl.isError=!1,this.imageEl.isLoading=!0,this.imageEl.naturalWidth=null,this.imageEl.naturalHeight=null,this.imageEl.isLandscape=!1,this.imageEl.onload=this.imageLoadHandler,this.imageEl.onerror=this.imageErrorHandler,this.imageEl.onabort=this.imageErrorHandler,this.imageEl.originalSrc=this.src,this.imageEl.src=this.src)},shrinkImage:function(){!c.isNothing(this.imageEl)&&this.imageEl.src.indexOf(this.src)>-1&&(this.imageEl.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",c.isNothing(this.imageEl.parentNode)||c.DOM.removeChild(this.imageEl,this.imageEl.parentNode))},onImageLoad:function(){this.imageEl.onload=null,this.imageEl.naturalWidth=c.coalesce(this.imageEl.naturalWidth,this.imageEl.width),this.imageEl.naturalHeight=c.coalesce(this.imageEl.naturalHeight,this.imageEl.height),this.imageEl.isLandscape=this.imageEl.naturalWidth>this.imageEl.naturalHeight,this.imageEl.isLoading=!1,c.Events.fire(this,{type:d.Image.EventTypes.onLoad,target:this})},onImageError:function(){this.imageEl.onload=null,this.imageEl.onerror=null,this.imageEl.onabort=null,this.imageEl.isLoading=!1,this.imageEl.isError=!0,c.Events.fire(this,{type:d.Image.EventTypes.onError,target:this})}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Cache"),a=a.Code.PhotoSwipe,a.Cache.Mode={normal:"normal",aggressive:"aggressive"},a.Cache.Functions={getImageSource:function(a){return a.href},getImageCaption:function(a){if(a.nodeName==="IMG")return c.DOM.getAttribute(a,"alt");var b,d,e;b=0;for(d=a.childNodes.length;b<d;b++)if(e=a.childNodes[b],a.childNodes[b].nodeName==="IMG")return c.DOM.getAttribute(e,"alt")},getImageMetaData:function(){return{}}}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Cache");var d=a.Code.PhotoSwipe;d.Cache.CacheClass=b({images:null,settings:null,dispose:function(){var a,b,d;if(!c.isNothing(this.images)){b=0;for(d=this.images.length;b<d;b++)this.images[b].dispose();this.images.length=0}for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(a,b){var c,e,f,g,h,i;this.settings=b,this.images=[],c=0;for(e=a.length;c<e;c++)f=a[c],g=this.settings.getImageSource(f),h=this.settings.getImageCaption(f),i=this.settings.getImageMetaData(f),this.images.push(new d.Image.ImageClass(f,g,h,i))},getImages:function(a){var b,e,f=[],g;b=0;for(e=a.length;b<e;b++)g=this.images[a[b]],this.settings.cacheMode===d.Cache.Mode.aggressive&&(g.cacheDoNotShrink=!0),f.push(g);if(this.settings.cacheMode===d.Cache.Mode.aggressive){b=0;for(e=this.images.length;b<e;b++)g=this.images[b],c.objectHasProperty(g,"cacheDoNotShrink")?delete g.cacheDoNotShrink:g.shrinkImage()}return f}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Image),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.DocumentOverlay"),a.Code.PhotoSwipe.DocumentOverlay.CssClasses={documentOverlay:"ps-document-overlay"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var d=a.Code.PhotoSwipe;d.DocumentOverlay.DocumentOverlayClass=b({el:null,settings:null,initialBodyHeight:null,dispose:function(){var a;c.Animation.stop(this.el),c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b){this.settings=b,this.el=c.DOM.createElement("div",{"class":d.DocumentOverlay.CssClasses.documentOverlay},""),c.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,zIndex:this.settings.zIndex}),c.DOM.hide(this.el),this.settings.target===a?c.DOM.appendToBody(this.el):c.DOM.appendChild(this.el,this.settings.target),c.Animation.resetTranslate(this.el),this.initialBodyHeight=c.DOM.bodyOuterHeight()},resetPosition:function(){var b,d,f;this.settings.target===a?(b=c.DOM.windowWidth(),d=c.DOM.bodyOuterHeight()*2,f=this.settings.jQueryMobile?c.DOM.windowScrollTop()+"px":"0px",d<1&&(d=this.initialBodyHeight),c.DOM.windowHeight()>d&&(d=c.DOM.windowHeight())):(b=c.DOM.width(this.settings.target),d=c.DOM.height(this.settings.target),f="0px"),c.DOM.setStyle(this.el,{width:b,height:d,top:f})},fadeIn:function(a,b){this.resetPosition(),c.DOM.setStyle(this.el,"opacity",0),c.DOM.show(this.el),c.Animation.fadeIn(this.el,a,b)}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Carousel"),a=a.Code.PhotoSwipe,a.Carousel.EventTypes={onSlideByEnd:"PhotoSwipeCarouselOnSlideByEnd",onSlideshowStart:"PhotoSwipeCarouselOnSlideshowStart",onSlideshowStop:"PhotoSwipeCarouselOnSlideshowStop"},a.Carousel.CssClasses={carousel:"ps-carousel",content:"ps-carousel-content",item:"ps-carousel-item",itemLoading:"ps-carousel-item-loading",itemError:"ps-carousel-item-error"},a.Carousel.SlideByAction={previous:"previous",current:"current",next:"next"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Carousel");var d=a.Code.PhotoSwipe;d.Carousel.CarouselClass=b({el:null,contentEl:null,settings:null,cache:null,slideByEndHandler:null,currentCacheIndex:null,isSliding:null,isSlideshowActive:null,lastSlideByAction:null,touchStartPoint:null,touchStartPosition:null,imageLoadHandler:null,imageErrorHandler:null,slideshowTimeout:null,dispose:function(){var a,b,e;b=0;for(e=this.cache.images.length;b<e;b++)c.Events.remove(this.cache.images[b],d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.remove(this.cache.images[b],d.Image.EventTypes.onError,this.imageErrorHandler);this.stopSlideshow(),c.Animation.stop(this.el),c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,f){var g,h,i;this.cache=b,this.settings=f,this.slideByEndHandler=this.onSlideByEnd.bind(this),this.imageLoadHandler=this.onImageLoad.bind(this),this.imageErrorHandler=this.onImageError.bind(this),this.currentCacheIndex=0,this.isSlideshowActive=this.isSliding=!1,this.cache.images.length<3&&(this.settings.loop=!1),this.el=c.DOM.createElement("div",{"class":d.Carousel.CssClasses.carousel},""),c.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex}),c.DOM.hide(this.el),this.contentEl=c.DOM.createElement("div",{"class":d.Carousel.CssClasses.content},""),c.DOM.setStyle(this.contentEl,{display:"block",position:"absolute",left:0,top:0}),c.DOM.appendChild(this.contentEl,this.el),h=b.images.length<3?b.images.length:3;for(g=0;g<h;g++)i=c.DOM.createElement("div",{"class":d.Carousel.CssClasses.item+" "+d.Carousel.CssClasses.item+"-"+g},""),c.DOM.setAttribute(i,"style","float: left;"),c.DOM.setStyle(i,{display:"block",position:"relative",left:0,top:0,overflow:"hidden"}),this.settings.margin>0&&c.DOM.setStyle(i,{marginRight:this.settings.margin+"px"}),c.DOM.appendChild(i,this.contentEl);this.settings.target===a?c.DOM.appendToBody(this.el):c.DOM.appendChild(this.el,this.settings.target)},resetPosition:function(){var b,f,g,h,i,j;this.settings.target===a?(b=c.DOM.windowWidth(),f=c.DOM.windowHeight(),g=c.DOM.windowScrollTop()+"px"):(b=c.DOM.width(this.settings.target),f=c.DOM.height(this.settings.target),g="0px"),h=this.settings.margin>0?b+this.settings.margin:b,i=c.DOM.find("."+d.Carousel.CssClasses.item,this.contentEl),h*=i.length,c.DOM.setStyle(this.el,{top:g,width:b,height:f}),c.DOM.setStyle(this.contentEl,{width:h,height:f}),g=0;for(h=i.length;g<h;g++)j=i[g],c.DOM.setStyle(j,{width:b,height:f}),j=c.DOM.find("img",j)[0],c.isNothing(j)||this.resetImagePosition(j);this.setContentLeftPosition()},resetImagePosition:function(a){if(!c.isNothing(a)){c.DOM.getAttribute(a,"src");var b,d,e,f=c.DOM.width(this.el),g=c.DOM.height(this.el);this.settings.imageScaleMethod==="fitNoUpscale"?(d=a.naturalWidth,e=a.naturalHeight,d>f&&(b=f/d,d=Math.round(d*b),e=Math.round(e*b)),e>g&&(b=g/e,e=Math.round(e*b),d=Math.round(d*b))):(b=a.isLandscape?f/a.naturalWidth:g/a.naturalHeight,d=Math.round(a.naturalWidth*b),e=Math.round(a.naturalHeight*b),this.settings.imageScaleMethod==="zoom"?(b=1,e<g?b=g/e:d<f&&(b=f/d),b!==1&&(d=Math.round(d*b),e=Math.round(e*b))):this.settings.imageScaleMethod==="fit"&&(b=1,d>f?b=f/d:e>g&&(b=g/e),b!==1&&(d=Math.round(d*b),e=Math.round(e*b)))),c.DOM.setStyle(a,{position:"absolute",width:d,height:e,top:Math.round((g-e)/2)+"px",left:Math.round((f-d)/2)+"px",display:"block"})}},setContentLeftPosition:function(){var b,d,f;b=this.settings.target===a?c.DOM.windowWidth():c.DOM.width(this.settings.target),d=this.getItemEls(),f=0,this.settings.loop?f=(b+this.settings.margin)*-1:this.currentCacheIndex===this.cache.images.length-1?f=(d.length-1)*(b+this.settings.margin)*-1:this.currentCacheIndex>0&&(f=(b+this.settings.margin)*-1),c.DOM.setStyle(this.contentEl,{left:f+"px"})},show:function(a){this.currentCacheIndex=a,this.resetPosition(),this.setImages(!1),c.DOM.show(this.el),c.Animation.resetTranslate(this.contentEl);var a=this.getItemEls(),b,e;b=0;for(e=a.length;b<e;b++)c.Animation.resetTranslate(a[b]);c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideByEnd,target:this,action:d.Carousel.SlideByAction.current,cacheIndex:this.currentCacheIndex})},setImages:function(a){var b,c=this.getItemEls();b=this.currentCacheIndex+1;var d=this.currentCacheIndex-1;this.settings.loop?(b>this.cache.images.length-1&&(b=0),d<0&&(d=this.cache.images.length-1),b=this.cache.getImages([d,this.currentCacheIndex,b]),a||this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[2],c[2]),this.addCacheImageToItemEl(b[0],c[0])):c.length===1?a||(b=this.cache.getImages([this.currentCacheIndex]),this.addCacheImageToItemEl(b[0],c[0])):c.length===2?this.currentCacheIndex===0?(b=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1]),a||this.addCacheImageToItemEl(b[0],c[0]),this.addCacheImageToItemEl(b[1],c[1])):(b=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex]),a||this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[0],c[0])):this.currentCacheIndex===0?(b=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1,this.currentCacheIndex+2]),a||this.addCacheImageToItemEl(b[0],c[0]),this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[2],c[2])):(this.currentCacheIndex===this.cache.images.length-1?(b=this.cache.getImages([this.currentCacheIndex-2,this.currentCacheIndex-1,this.currentCacheIndex]),a||this.addCacheImageToItemEl(b[2],c[2]),this.addCacheImageToItemEl(b[1],c[1])):(b=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex,this.currentCacheIndex+1]),a||this.addCacheImageToItemEl(b[1],c[1]),this.addCacheImageToItemEl(b[2],c[2])),this.addCacheImageToItemEl(b[0],c[0]))},addCacheImageToItemEl:function(a,b){c.DOM.removeClass(b,d.Carousel.CssClasses.itemError),c.DOM.addClass(b,d.Carousel.CssClasses.itemLoading),c.DOM.removeChildren(b),c.DOM.setStyle(a.imageEl,{display:"none"}),c.DOM.appendChild(a.imageEl,b),c.Animation.resetTranslate(a.imageEl),c.Events.add(a,d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.add(a,d.Image.EventTypes.onError,this.imageErrorHandler),a.load()},slideCarousel:function(b,f,g){if(!this.isSliding){var h,i;h=this.settings.target===a?c.DOM.windowWidth()+this.settings.margin:c.DOM.width(this.settings.target)+this.settings.margin,g=c.coalesce(g,this.settings.slideSpeed);if(!(a.Math.abs(i)<1)){switch(f){case c.TouchElement.ActionTypes.swipeLeft:b=h*-1;break;case c.TouchElement.ActionTypes.swipeRight:b=h;break;default:i=b.x-this.touchStartPoint.x,b=a.Math.abs(i)>h/2?i>0?h:h*-1:0}this.lastSlideByAction=b<0?d.Carousel.SlideByAction.next:b>0?d.Carousel.SlideByAction.previous:d.Carousel.SlideByAction.current,!this.settings.loop&&(this.lastSlideByAction===d.Carousel.SlideByAction.previous&&this.currentCacheIndex===0||this.lastSlideByAction===d.Carousel.SlideByAction.next&&this.currentCacheIndex===this.cache.images.length-1)&&(b=0,this.lastSlideByAction=d.Carousel.SlideByAction.current),this.isSliding=!0,this.doSlideCarousel(b,g)}}},moveCarousel:function(a){this.isSliding||this.settings.enableDrag&&this.doMoveCarousel(a.x-this.touchStartPoint.x)},getItemEls:function(){return c.DOM.find("."+d.Carousel.CssClasses.item,this.contentEl)},previous:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},c.TouchElement.ActionTypes.swipeRight,this.settings.nextPreviousSlideSpeed)},next:function(){this.stopSlideshow(),this.slideCarousel({x:0,y:0},c.TouchElement.ActionTypes.swipeLeft,this.settings.nextPreviousSlideSpeed)},slideshowNext:function(){this.slideCarousel({x:0,y:0},c.TouchElement.ActionTypes.swipeLeft)},startSlideshow:function(){this.stopSlideshow(),this.isSlideshowActive=!0,this.slideshowTimeout=a.setTimeout(this.slideshowNext.bind(this),this.settings.slideshowDelay),c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideshowStart,target:this})},stopSlideshow:function(){c.isNothing(this.slideshowTimeout)||(a.clearTimeout(this.slideshowTimeout),this.slideshowTimeout=null,this.isSlideshowActive=!1,c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideshowStop,target:this}))},onSlideByEnd:function(){if(!c.isNothing(this.isSliding)){var a=this.getItemEls();this.isSliding=!1,this.lastSlideByAction===d.Carousel.SlideByAction.next?this.currentCacheIndex+=1:this.lastSlideByAction===d.Carousel.SlideByAction.previous&&(this.currentCacheIndex-=1),this.settings.loop?(this.lastSlideByAction===d.Carousel.SlideByAction.next?c.DOM.appendChild(a[0],this.contentEl):this.lastSlideByAction===d.Carousel.SlideByAction.previous&&c.DOM.insertBefore(a[a.length-1],a[0],this.contentEl),this.currentCacheIndex<0)?this.currentCacheIndex=this.cache.images.length-1:this.currentCacheIndex===this.cache.images.length&&(this.currentCacheIndex=0):this.cache.images.length>3&&(this.currentCacheIndex>1&&this.currentCacheIndex<this.cache.images.length-2?this.lastSlideByAction===d.Carousel.SlideByAction.next?c.DOM.appendChild(a[0],this.contentEl):this.lastSlideByAction===d.Carousel.SlideByAction.previous&&c.DOM.insertBefore(a[a.length-1],a[0],this.contentEl):this.currentCacheIndex===1?this.lastSlideByAction===d.Carousel.SlideByAction.previous&&c.DOM.insertBefore(a[a.length-1],a[0],this.contentEl):this.currentCacheIndex===this.cache.images.length-2&&this.lastSlideByAction===d.Carousel.SlideByAction.next&&c.DOM.appendChild(a[0],this.contentEl)),this.lastSlideByAction!==d.Carousel.SlideByAction.current&&(this.setContentLeftPosition(),this.setImages(!0)),c.Events.fire(this,{type:d.Carousel.EventTypes.onSlideByEnd,target:this,action:this.lastSlideByAction,cacheIndex:this.currentCacheIndex}),this.isSlideshowActive&&(this.lastSlideByAction!==d.Carousel.SlideByAction.current?this.startSlideshow():this.stopSlideshow())}},onTouch:function(b,d){this.stopSlideshow();switch(b){case c.TouchElement.ActionTypes.touchStart:this.touchStartPoint=d,this.touchStartPosition={x:a.parseInt(c.DOM.getStyle(this.contentEl,"left"),0),y:a.parseInt(c.DOM.getStyle(this.contentEl,"top"),0)};break;case c.TouchElement.ActionTypes.touchMove:this.moveCarousel(d);break;case c.TouchElement.ActionTypes.touchMoveEnd:case c.TouchElement.ActionTypes.swipeLeft:case c.TouchElement.ActionTypes.swipeRight:this.slideCarousel(d,b)}},onImageLoad:function(a){a=a.target,c.isNothing(a.imageEl.parentNode)||(c.DOM.removeClass(a.imageEl.parentNode,d.Carousel.CssClasses.itemLoading),this.resetImagePosition(a.imageEl)),c.Events.remove(a,d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.remove(a,d.Image.EventTypes.onError,this.imageErrorHandler)},onImageError:function(a){a=a.target,c.isNothing(a.imageEl.parentNode)||(c.DOM.removeClass(a.imageEl.parentNode,d.Carousel.CssClasses.itemLoading),c.DOM.addClass(a.imageEl.parentNode,d.Carousel.CssClasses.itemError)),c.Events.remove(a,d.Image.EventTypes.onLoad,this.imageLoadHandler),c.Events.remove(a,d.Image.EventTypes.onError,this.imageErrorHandler)}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Carousel"),b=a.Code.PhotoSwipe,b.Carousel.CarouselClass=b.Carousel.CarouselClass.extend({getStartingPos:function(){var b=this.touchStartPosition;return c.isNothing(b)&&(b={x:a.parseInt(c.DOM.getStyle(this.contentEl,"left"),0),y:a.parseInt(c.DOM.getStyle(this.contentEl,"top"),0)}),b},doMoveCarousel:function(b){var d;c.Browser.isCSSTransformSupported?(d={},d[c.Animation._transitionPrefix+"Property"]="all",d[c.Animation._transitionPrefix+"Duration"]="",d[c.Animation._transitionPrefix+"TimingFunction"]="",d[c.Animation._transitionPrefix+"Delay"]="0",d[c.Animation._transformLabel]=c.Browser.is3dSupported?"translate3d("+b+"px, 0px, 0px)":"translate("+b+"px, 0px)",c.DOM.setStyle(this.contentEl,d)):c.isNothing(a.jQuery)||a.jQuery(this.contentEl).stop().css("left",this.getStartingPos().x+b+"px")},doSlideCarousel:function(b,d){var f;d<=0?this.slideByEndHandler():c.Browser.isCSSTransformSupported?(f=c.coalesce(this.contentEl.style.webkitTransform,this.contentEl.style.MozTransform,this.contentEl.style.transform,""),f.indexOf("translate3d("+b)===0?this.slideByEndHandler():f.indexOf("translate("+b)===0?this.slideByEndHandler():c.Animation.slideBy(this.contentEl,b,0,d,this.slideByEndHandler,this.settings.slideTimingFunction)):c.isNothing(a.jQuery)||(f={left:this.getStartingPos().x+b+"px"},this.settings.animationTimingFunction==="ease-out"&&(this.settings.animationTimingFunction="easeOutQuad"),c.isNothing(a.jQuery.easing[this.settings.animationTimingFunction])&&(this.settings.animationTimingFunction="linear"),a.jQuery(this.contentEl).animate(f,this.settings.slideSpeed,this.settings.animationTimingFunction,this.slideByEndHandler))}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.TouchElement),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Toolbar");var d=a.Code.PhotoSwipe;d.Toolbar.CssClasses={toolbar:"ps-toolbar",toolbarContent:"ps-toolbar-content",toolbarTop:"ps-toolbar-top",caption:"ps-caption",captionBottom:"ps-caption-bottom",captionContent:"ps-caption-content",close:"ps-toolbar-close",play:"ps-toolbar-play",previous:"ps-toolbar-previous",previousDisabled:"ps-toolbar-previous-disabled",next:"ps-toolbar-next",nextDisabled:"ps-toolbar-next-disabled"},d.Toolbar.ToolbarAction={close:"close",play:"play",next:"next",previous:"previous",none:"none"},d.Toolbar.EventTypes={onTap:"PhotoSwipeToolbarOnClick",onBeforeShow:"PhotoSwipeToolbarOnBeforeShow",onShow:"PhotoSwipeToolbarOnShow",onBeforeHide:"PhotoSwipeToolbarOnBeforeHide",onHide:"PhotoSwipeToolbarOnHide"},d.Toolbar.getToolbar=function(){return'<div class="'+d.Toolbar.CssClasses.close+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+d.Toolbar.CssClasses.play+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+d.Toolbar.CssClasses.previous+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+d.Toolbar.CssClasses.next+'"><div class="'+d.Toolbar.CssClasses.toolbarContent+'"></div></div>'}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.Toolbar");var d=a.Code.PhotoSwipe;d.Toolbar.ToolbarClass=b({toolbarEl:null,closeEl:null,playEl:null,previousEl:null,nextEl:null,captionEl:null,captionContentEl:null,currentCaption:null,settings:null,cache:null,timeout:null,isVisible:null,fadeOutHandler:null,touchStartHandler:null,touchMoveHandler:null,clickHandler:null,dispose:function(){var a;this.clearTimeout(),this.removeEventHandlers(),c.Animation.stop(this.toolbarEl),c.Animation.stop(this.captionEl),c.DOM.removeChild(this.toolbarEl,this.toolbarEl.parentNode),c.DOM.removeChild(this.captionEl,this.captionEl.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,f){var g;this.settings=f,this.cache=b,this.isVisible=!1,this.fadeOutHandler=this.onFadeOut.bind(this),this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.clickHandler=this.onClick.bind(this),g=d.Toolbar.CssClasses.toolbar,this.settings.captionAndToolbarFlipPosition&&(g=g+" "+d.Toolbar.CssClasses.toolbarTop),this.toolbarEl=c.DOM.createElement("div",{"class":g},this.settings.getToolbar()),c.DOM.setStyle(this.toolbarEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===a?c.DOM.appendToBody(this.toolbarEl):c.DOM.appendChild(this.toolbarEl,this.settings.target),c.DOM.hide(this.toolbarEl),this.closeEl=c.DOM.find("."+d.Toolbar.CssClasses.close,this.toolbarEl)[0],this.settings.preventHide&&!c.isNothing(this.closeEl)&&c.DOM.hide(this.closeEl),this.playEl=c.DOM.find("."+d.Toolbar.CssClasses.play,this.toolbarEl)[0],this.settings.preventSlideshow&&!c.isNothing(this.playEl)&&c.DOM.hide(this.playEl),this.nextEl=c.DOM.find("."+d.Toolbar.CssClasses.next,this.toolbarEl)[0],this.previousEl=c.DOM.find("."+d.Toolbar.CssClasses.previous,this.toolbarEl)[0],g=d.Toolbar.CssClasses.caption,this.settings.captionAndToolbarFlipPosition&&(g=g+" "+d.Toolbar.CssClasses.captionBottom),this.captionEl=c.DOM.createElement("div",{"class":g},""),c.DOM.setStyle(this.captionEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex}),this.settings.target===a?c.DOM.appendToBody(this.captionEl):c.DOM.appendChild(this.captionEl,this.settings.target),c.DOM.hide(this.captionEl),this.captionContentEl=c.DOM.createElement("div",{"class":d.Toolbar.CssClasses.captionContent},""),c.DOM.appendChild(this.captionContentEl,this.captionEl),this.addEventHandlers()},resetPosition:function(){var b,d,f;this.settings.target===a?(this.settings.captionAndToolbarFlipPosition?(d=c.DOM.windowScrollTop(),f=c.DOM.windowScrollTop()+c.DOM.windowHeight()-c.DOM.height(this.captionEl)):(d=c.DOM.windowScrollTop()+c.DOM.windowHeight()-c.DOM.height(this.toolbarEl),f=c.DOM.windowScrollTop()),b=c.DOM.windowWidth()):(this.settings.captionAndToolbarFlipPosition?(d="0",f=c.DOM.height(this.settings.target)-c.DOM.height(this.captionEl)):(d=c.DOM.height(this.settings.target)-c.DOM.height(this.toolbarEl),f=0),b=c.DOM.width(this.settings.target)),c.DOM.setStyle(this.toolbarEl,{top:d+"px",width:b}),c.DOM.setStyle(this.captionEl,{top:f+"px",width:b})},toggleVisibility:function(a){this.isVisible?this.fadeOut():this.show(a)},show:function(a){c.Animation.stop(this.toolbarEl),c.Animation.stop(this.captionEl),this.resetPosition(),this.setToolbarStatus(a),c.Events.fire(this,{type:d.Toolbar.EventTypes.onBeforeShow,target:this}),this.showToolbar(),this.setCaption(a),this.showCaption(),this.isVisible=!0,this.setTimeout(),c.Events.fire(this,{type:d.Toolbar.EventTypes.onShow,target:this})},setTimeout:function(){this.settings.captionAndToolbarAutoHideDelay>0&&(this.clearTimeout(),this.timeout=a.setTimeout(this.fadeOut.bind(this),this.settings.captionAndToolbarAutoHideDelay))},clearTimeout:function(){c.isNothing(this.timeout)||(a.clearTimeout(this.timeout),this.timeout=null)},fadeOut:function(){this.clearTimeout(),c.Events.fire(this,{type:d.Toolbar.EventTypes.onBeforeHide,target:this}),c.Animation.fadeOut(this.toolbarEl,this.settings.fadeOutSpeed),c.Animation.fadeOut(this.captionEl,this.settings.fadeOutSpeed,this.fadeOutHandler),this.isVisible=!1},addEventHandlers:function(){c.Browser.isTouchSupported&&(c.Browser.blackberry||c.Events.add(this.toolbarEl,"touchstart",this.touchStartHandler),c.Events.add(this.toolbarEl,"touchmove",this.touchMoveHandler),c.Events.add(this.captionEl,"touchmove",this.touchMoveHandler)),c.Events.add(this.toolbarEl,"click",this.clickHandler)},removeEventHandlers:function(){c.Browser.isTouchSupported&&(c.Browser.blackberry||c.Events.remove(this.toolbarEl,"touchstart",this.touchStartHandler),c.Events.remove(this.toolbarEl,"touchmove",this.touchMoveHandler),c.Events.remove(this.captionEl,"touchmove",this.touchMoveHandler)),c.Events.remove(this.toolbarEl,"click",this.clickHandler)},handleTap:function(a){this.clearTimeout();var b;if(a.target===this.nextEl||c.DOM.isChildOf(a.target,this.nextEl))b=d.Toolbar.ToolbarAction.next;else if(a.target===this.previousEl||c.DOM.isChildOf(a.target,this.previousEl))b=d.Toolbar.ToolbarAction.previous;else if(a.target===this.closeEl||c.DOM.isChildOf(a.target,this.closeEl))b=d.Toolbar.ToolbarAction.close;else if(a.target===this.playEl||c.DOM.isChildOf(a.target,this.playEl))b=d.Toolbar.ToolbarAction.play;this.setTimeout(),c.isNothing(b)&&(b=d.Toolbar.ToolbarAction.none),c.Events.fire(this,{type:d.Toolbar.EventTypes.onTap,target:this,action:b,tapTarget:a.target})},setCaption:function(a){c.DOM.removeChildren(this.captionContentEl),this.currentCaption=c.coalesce(this.cache.images[a].caption,""),c.isObject(this.currentCaption)?c.DOM.appendChild(this.currentCaption,this.captionContentEl):(this.currentCaption===""&&(this.currentCaption=""),c.DOM.appendText(this.currentCaption,this.captionContentEl)),this.currentCaption=this.currentCaption===""?"":this.currentCaption,this.resetPosition()},showToolbar:function(){c.DOM.setStyle(this.toolbarEl,{opacity:this.settings.captionAndToolbarOpacity}),c.DOM.show(this.toolbarEl)},showCaption:function(){(this.currentCaption===""||this.captionContentEl.childNodes.length<1)&&!this.settings.captionAndToolbarShowEmptyCaptions?c.DOM.hide(this.captionEl):(c.DOM.setStyle(this.captionEl,{opacity:this.settings.captionAndToolbarOpacity}),c.DOM.show(this.captionEl))},setToolbarStatus:function(a){this.settings.loop||(c.DOM.removeClass(this.previousEl,d.Toolbar.CssClasses.previousDisabled),c.DOM.removeClass(this.nextEl,d.Toolbar.CssClasses.nextDisabled),a>0&&a<this.cache.images.length-1||(a===0&&(c.isNothing(this.previousEl)||c.DOM.addClass(this.previousEl,d.Toolbar.CssClasses.previousDisabled)),a===this.cache.images.length-1&&(c.isNothing(this.nextEl)||c.DOM.addClass(this.nextEl,d.Toolbar.CssClasses.nextDisabled))))},onFadeOut:function(){c.DOM.hide(this.toolbarEl),c.DOM.hide(this.captionEl),c.Events.fire(this,{type:d.Toolbar.EventTypes.onHide,target:this})},onTouchStart:function(a){},onTouchMove:function(a){a.preventDefault()},onClick:function(a){a.preventDefault(),this.handleTap(a)}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.UILayer"),a.Code.PhotoSwipe.UILayer.CssClasses={uiLayer:"ps-uilayer"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.UILayer");var d=a.Code.PhotoSwipe;d.UILayer.UILayerClass=c.TouchElement.TouchElementClass.extend({el:null,settings:null,dispose:function(){var a;this.removeEventHandlers(),c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b){this.settings=b,this.el=c.DOM.createElement("div",{"class":d.UILayer.CssClasses.uiLayer},""),c.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex,opacity:0}),c.DOM.hide(this.el),this.settings.target===a?c.DOM.appendToBody(this.el):c.DOM.appendChild(this.el,this.settings.target),this.supr(this.el,{swipe:!0,move:!0,gesture:c.Browser.iOS,doubleTap:!0,preventDefaultTouchEvents:this.settings.preventDefaultTouchEvents})},resetPosition:function(){this.settings.target===a?c.DOM.setStyle(this.el,{top:c.DOM.windowScrollTop()+"px",width:c.DOM.windowWidth(),height:c.DOM.windowHeight()}):c.DOM.setStyle(this.el,{top:"0px",width:c.DOM.width(this.settings.target),height:c.DOM.height(this.settings.target)})},show:function(){this.resetPosition(),c.DOM.show(this.el),this.addEventHandlers()},addEventHandlers:function(){this.supr()},removeEventHandlers:function(){this.supr()}})}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.ZoomPanRotate"),a=a.Code.PhotoSwipe,a.ZoomPanRotate.CssClasses={zoomPanRotate:"ps-zoom-pan-rotate"},a.ZoomPanRotate.EventTypes={onTransform:"PhotoSwipeZoomPanRotateOnTransform"}}(window,window.klass,window.Code.Util),function(a,b,c){c.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var d=a.Code.PhotoSwipe;d.ZoomPanRotate.ZoomPanRotateClass=b({el:null,settings:null,containerEl:null,imageEl:null,transformSettings:null,panStartingPoint:null,transformEl:null,dispose:function(){var a;c.DOM.removeChild(this.el,this.el.parentNode);for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,f,g){var h,i,j;this.settings=b,this.settings.target===a?(b=document.body,h=c.DOM.windowWidth(),i=c.DOM.windowHeight(),j=c.DOM.windowScrollTop()+"px"):(b=this.settings.target,h=c.DOM.width(b),i=c.DOM.height(b),j="0px"),this.imageEl=f.imageEl.cloneNode(!1),c.DOM.setStyle(this.imageEl,{zIndex:1}),this.transformSettings={startingScale:1,scale:1,startingRotation:0,rotation:0,startingTranslateX:0,startingTranslateY:0,translateX:0,translateY:0},this.el=c.DOM.createElement("div",{"class":d.ZoomPanRotate.CssClasses.zoomPanRotate},""),c.DOM.setStyle(this.el,{left:0,top:j,position:"absolute",width:h,height:i,zIndex:this.settings.zIndex,display:"block"}),c.DOM.insertBefore(this.el,g.el,b),c.Browser.iOS?(this.containerEl=c.DOM.createElement("div"),c.DOM.setStyle(this.containerEl,{left:0,top:0,width:h,height:i,position:"absolute",zIndex:1}),c.DOM.appendChild(this.imageEl,this.containerEl),c.DOM.appendChild(this.containerEl,this.el),c.Animation.resetTranslate(this.containerEl),c.Animation.resetTranslate(this.imageEl),this.transformEl=this.containerEl):(c.DOM.appendChild(this.imageEl,this.el),this.transformEl=this.imageEl)},setStartingTranslateFromCurrentTransform:function(){var b=c.coalesce(this.transformEl.style.webkitTransform,this.transformEl.style.MozTransform,this.transformEl.style.transform);!c.isNothing(b)&&(b=b.match(/translate\((.*?)\)/),!c.isNothing(b))&&(b=b[1].split(", "),this.transformSettings.startingTranslateX=a.parseInt(b[0],10),this.transformSettings.startingTranslateY=a.parseInt(b[1],10))},getScale:function(a){return a*=this.transformSettings.startingScale,this.settings.minUserZoom!==0&&a<this.settings.minUserZoom?a=this.settings.minUserZoom:this.settings.maxUserZoom!==0&&a>this.settings.maxUserZoom&&(a=this.settings.maxUserZoom),a},setStartingScaleAndRotation:function(a,b){this.transformSettings.startingScale=this.getScale(a),this.transformSettings.startingRotation=(this.transformSettings.startingRotation+b)%360},zoomRotate:function(a,b){this.transformSettings.scale=this.getScale(a),this.transformSettings.rotation=this.transformSettings.startingRotation+b,this.applyTransform()},panStart:function(a){this.setStartingTranslateFromCurrentTransform(),this.panStartingPoint={x:a.x,y:a.y}},pan:function(a){var b=(a.y-this.panStartingPoint.y)/this.transformSettings.scale;this.transformSettings.translateX=this.transformSettings.startingTranslateX+(a.x-this.panStartingPoint.x)/this.transformSettings.scale,this.transformSettings.translateY=this.transformSettings.startingTranslateY+b,this.applyTransform()},zoomAndPanToPoint:function(b,d){if(this.settings.target===a){this.panStart({x:c.DOM.windowWidth()/2,y:c.DOM.windowHeight()/2});var f=(d.y-this.panStartingPoint.y)/this.transformSettings.scale;this.transformSettings.translateX=(this.transformSettings.startingTranslateX+(d.x-this.panStartingPoint.x)/this.transformSettings.scale)*-1,this.transformSettings.translateY=(this.transformSettings.startingTranslateY+f)*-1}this.setStartingScaleAndRotation(b,0),this.transformSettings.scale=this.transformSettings.startingScale,this.transformSettings.rotation=0,this.applyTransform()},applyTransform:function(){var b=this.transformSettings.rotation%360,f=a.parseInt(this.transformSettings.translateX,10),g=a.parseInt(this.transformSettings.translateY,10),h="scale("+this.transformSettings.scale+") rotate("+b+"deg) translate("+f+"px, "+g+"px)";c.DOM.setStyle(this.transformEl,{webkitTransform:h,MozTransform:h,msTransform:h,transform:h}),c.Events.fire(this,{target:this,type:d.ZoomPanRotate.EventTypes.onTransform,scale:this.transformSettings.scale,rotation:this.transformSettings.rotation,rotationDegs:b,translateX:f,translateY:g})}})}(window,window.klass,window.Code.Util),function(a,b){b.registerNamespace("Code.PhotoSwipe");var c=a.Code.PhotoSwipe;c.CssClasses={buildingBody:"ps-building",activeBody:"ps-active"},c.EventTypes={onBeforeShow:"PhotoSwipeOnBeforeShow",onShow:"PhotoSwipeOnShow",onBeforeHide:"PhotoSwipeOnBeforeHide",onHide:"PhotoSwipeOnHide",onDisplayImage:"PhotoSwipeOnDisplayImage",onResetPosition:"PhotoSwipeOnResetPosition",onSlideshowStart:"PhotoSwipeOnSlideshowStart",onSlideshowStop:"PhotoSwipeOnSlideshowStop",onTouch:"PhotoSwipeOnTouch",onBeforeCaptionAndToolbarShow:"PhotoSwipeOnBeforeCaptionAndToolbarShow",onCaptionAndToolbarShow:"PhotoSwipeOnCaptionAndToolbarShow",onBeforeCaptionAndToolbarHide:"PhotoSwipeOnBeforeCaptionAndToolbarHide",onCaptionAndToolbarHide:"PhotoSwipeOnCaptionAndToolbarHide",onToolbarTap:"PhotoSwipeOnToolbarTap",onBeforeZoomPanRotateShow:"PhotoSwipeOnBeforeZoomPanRotateShow",onZoomPanRotateShow:"PhotoSwipeOnZoomPanRotateShow",onBeforeZoomPanRotateHide:"PhotoSwipeOnBeforeZoomPanRotateHide",onZoomPanRotateHide:"PhotoSwipeOnZoomPanRotateHide",onZoomPanRotateTransform:"PhotoSwipeOnZoomPanRotateTransform"},c.instances=[],c.activeInstances=[],c.setActivateInstance=function(a){if(b.arrayIndexOf(a.settings.target,c.activeInstances,"target")>-1)throw"Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active for this target";c.activeInstances.push({target:a.settings.target,instance:a})},c.unsetActivateInstance=function(a){a=b.arrayIndexOf(a,c.activeInstances,"instance"),c.activeInstances.splice(a,1)},c.attach=function(a,d,e){var f,g;f=c.createInstance(a,d,e),d=0;for(e=a.length;d<e;d++)if(g=a[d],!b.isNothing(g.nodeType)&&g.nodeType===1)g.__photoSwipeClickHandler=c.onTriggerElementClick.bind(f),b.Events.remove(g,"click",g.__photoSwipeClickHandler),b.Events.add(g,"click",g.__photoSwipeClickHandler);return f},a.jQuery&&(a.jQuery.fn.photoSwipe=function(a,b){return c.attach(this,a,b)}),c.detatch=function(a){var d,e,f;d=0;for(e=a.originalImages.length;d<e;d++)f=a.originalImages[d],!b.isNothing(f.nodeType)&&f.nodeType===1&&(b.Events.remove(f,"click",f.__photoSwipeClickHandler),delete f.__photoSwipeClickHandler);c.disposeInstance(a)},c.createInstance=function(a,d,e){var f;if(b.isNothing(a))throw"Code.PhotoSwipe.attach: No images passed.";if(!b.isLikeArray(a))throw"Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls.";if(a.length<1)throw"Code.PhotoSwipe.createInstance: No images to passed.";d=b.coalesce(d,{}),f=c.getInstance(e);if(b.isNothing(f))f=new c.PhotoSwipeClass(a,d,e),c.instances.push(f);else throw'Code.PhotoSwipe.createInstance: Instance with id "'+e+' already exists."';return f},c.disposeInstance=function(a){var b=c.getInstanceIndex(a);if(b<0)throw"Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose.";a.dispose(),c.instances.splice(b,1)},c.onTriggerElementClick=function(a){a.preventDefault(),this.show(a.currentTarget)},c.getInstance=function(a){var b,d,e;b=0;for(d=c.instances.length;b<d;b++)if(e=c.instances[b],e.id===a)return e;return null},c.getInstanceIndex=function(a){var b,d,e=-1;b=0;for(d=c.instances.length;b<d;b++)if(c.instances[b]===a){e=b;break}return e}}(window,window.Code.Util),function(a,b,c,d,e,f,g,h,i){c.registerNamespace("Code.PhotoSwipe");var j=a.Code.PhotoSwipe;j.PhotoSwipeClass=b({id:null,settings:null,isBackEventSupported:null,backButtonClicked:null,currentIndex:null,originalImages:null,mouseWheelStartTime:null,windowDimensions:null,cache:null,documentOverlay:null,carousel:null,uiLayer:null,toolbar:null,zoomPanRotate:null,windowOrientationChangeHandler:null,windowScrollHandler:null,windowHashChangeHandler:null,keyDownHandler:null,windowOrientationEventName:null,uiLayerTouchHandler:null,carouselSlideByEndHandler:null,carouselSlideshowStartHandler:null,carouselSlideshowStopHandler:null,toolbarTapHandler:null,toolbarBeforeShowHandler:null,toolbarShowHandler:null,toolbarBeforeHideHandler:null,toolbarHideHandler:null,mouseWheelHandler:null,zoomPanRotateTransformHandler:null,_isResettingPosition:null,_uiWebViewResetPositionTimeout:null,dispose:function(){var a;c.Events.remove(this,j.EventTypes.onBeforeShow),c.Events.remove(this,j.EventTypes.onShow),c.Events.remove(this,j.EventTypes.onBeforeHide),c.Events.remove(this,j.EventTypes.onHide),c.Events.remove(this,j.EventTypes.onDisplayImage),c.Events.remove(this,j.EventTypes.onResetPosition),c.Events.remove(this,j.EventTypes.onSlideshowStart),c.Events.remove(this,j.EventTypes.onSlideshowStop),c.Events.remove(this,j.EventTypes.onTouch),c.Events.remove(this,j.EventTypes.onBeforeCaptionAndToolbarShow),c.Events.remove(this,j.EventTypes.onCaptionAndToolbarShow),c.Events.remove(this,j.EventTypes.onBeforeCaptionAndToolbarHide),c.Events.remove(this,j.EventTypes.onCaptionAndToolbarHide),c.Events.remove(this,j.EventTypes.onZoomPanRotateTransform),this.removeEventHandlers(),c.isNothing(this.documentOverlay)||this.documentOverlay.dispose(),c.isNothing(this.carousel)||this.carousel.dispose(),c.isNothing(this.uiLayer)||this.uiLayer.dispose(),c.isNothing(this.toolbar)||this.toolbar.dispose(),this.destroyZoomPanRotate(),c.isNothing(this.cache)||this.cache.dispose();for(a in this)c.objectHasProperty(this,a)&&(this[a]=null)},initialize:function(b,e,f){this.id=c.isNothing(f)?"PhotoSwipe"+(new Date).getTime().toString():f,this.originalImages=b,c.Browser.android&&a.navigator.userAgent.match(/Android (\d+.\d+)/).toString().replace(/^.*\,/,"")>=2.1&&(this.isBackEventSupported=!0),this.isBackEventSupported||(this.isBackEventSupported=c.objectHasProperty(a,"onhashchange")),this.settings={fadeInSpeed:250,fadeOutSpeed:250,preventHide:!1,preventSlideshow:!1,zIndex:1e3,backButtonHideEnabled:!0,enableKeyboard:!0,enableMouseWheel:!0,mouseWheelSpeed:350,autoStartSlideshow:!1,jQueryMobile:!c.isNothing(a.jQuery)&&!c.isNothing(a.jQuery.mobile),jQueryMobileDialogHash:"&ui-state=dialog",enableUIWebViewRepositionTimeout:!1,uiWebViewResetPositionDelay:500,target:a,preventDefaultTouchEvents:!0,loop:!0,slideSpeed:250,nextPreviousSlideSpeed:0,enableDrag:!0,swipeThreshold:50,swipeTimeThreshold:250,slideTimingFunction:"ease-out",slideshowDelay:3e3,doubleTapSpeed:250,margin:20,imageScaleMethod:"fit",captionAndToolbarHide:!1,captionAndToolbarFlipPosition:!1,captionAndToolbarAutoHideDelay:5e3,captionAndToolbarOpacity:.8,captionAndToolbarShowEmptyCaptions:!0,getToolbar:j.Toolbar.getToolbar,allowUserZoom:!0,allowRotationOnUserZoom:!1,maxUserZoom:5,minUserZoom:.5,doubleTapZoomLevel:2.5,getImageSource:j.Cache.Functions.getImageSource,getImageCaption:j.Cache.Functions.getImageCaption,getImageMetaData:j.Cache.Functions.getImageMetaData,cacheMode:j.Cache.Mode.normal},c.extend(this.settings,e),this.settings.target!==a&&(e=c.DOM.getStyle(this.settings.target,"position"),(e!=="relative"||e!=="absolute")&&c.DOM.setStyle(this.settings.target,"position","relative")),this.settings.target!==a?(this.isBackEventSupported=!1,this.settings.backButtonHideEnabled=!1):this.settings.preventHide&&(this.settings.backButtonHideEnabled=!1),this.cache=new d.CacheClass(b,this.settings)},show:function(b){var d,e;this.backButtonClicked=this._isResettingPosition=!1;if(c.isNumber(b))this.currentIndex=b;else{this.currentIndex=-1,d=0;for(e=this.originalImages.length;d<e;d++)if(this.originalImages[d]===b){this.currentIndex=d;break}}if(this.currentIndex<0||this.currentIndex>this.originalImages.length-1)throw"Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range";this.isAlreadyGettingPage=this.getWindowDimensions(),j.setActivateInstance(this),this.windowDimensions=this.getWindowDimensions(),this.settings.target===a?c.DOM.addClass(a.document.body,j.CssClasses.buildingBody):c.DOM.addClass(this.settings.target,j.CssClasses.buildingBody),this.createComponents(),c.Events.fire(this,{type:j.EventTypes.onBeforeShow,target:this}),this.documentOverlay.fadeIn(this.settings.fadeInSpeed,this.onDocumentOverlayFadeIn.bind(this))},getWindowDimensions:function(){return{width:c.DOM.windowWidth(),height:c.DOM.windowHeight()}},createComponents:function(){this.documentOverlay=new e.DocumentOverlayClass(this.settings),this.carousel=new f.CarouselClass(this.cache,this.settings),this.uiLayer=new h.UILayerClass(this.settings),this.settings.captionAndToolbarHide||(this.toolbar=new g.ToolbarClass(this.cache,this.settings))},resetPosition:function(){if(!this._isResettingPosition){var a=this.getWindowDimensions();if(c.isNothing(this.windowDimensions)||a.width!==this.windowDimensions.width||a.height!==this.windowDimensions.height)this._isResettingPosition=!0,this.windowDimensions=a,this.destroyZoomPanRotate(),this.documentOverlay.resetPosition(),this.carousel.resetPosition(),c.isNothing(this.toolbar)||this.toolbar.resetPosition(),this.uiLayer.resetPosition(),this._isResettingPosition=!1,c.Events.fire(this,{type:j.EventTypes.onResetPosition,target:this})}},addEventHandler:function(a,b){c.Events.add(this,a,b)},addEventHandlers:function(){c.isNothing(this.windowOrientationChangeHandler)&&(this.windowOrientationChangeHandler=this.onWindowOrientationChange.bind(this),this.windowScrollHandler=this.onWindowScroll.bind(this),this.keyDownHandler=this.onKeyDown.bind(this),this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.uiLayerTouchHandler=this.onUILayerTouch.bind(this),this.carouselSlideByEndHandler=this.onCarouselSlideByEnd.bind(this),this.carouselSlideshowStartHandler=this.onCarouselSlideshowStart.bind(this),this.carouselSlideshowStopHandler=this.onCarouselSlideshowStop.bind(this),this.toolbarTapHandler=this.onToolbarTap.bind(this),this.toolbarBeforeShowHandler=this.onToolbarBeforeShow.bind(this),this.toolbarShowHandler=this.onToolbarShow.bind(this),this.toolbarBeforeHideHandler=this.onToolbarBeforeHide.bind(this),this.toolbarHideHandler=this.onToolbarHide.bind(this),this.mouseWheelHandler=this.onMouseWheel.bind(this),this.zoomPanRotateTransformHandler=this.onZoomPanRotateTransform.bind(this)),c.Browser.android?this.orientationEventName="resize":c.Browser.iOS&&!c.Browser.safari?c.Events.add(a.document.body,"orientationchange",this.windowOrientationChangeHandler):this.orientationEventName=c.isNothing(a.onorientationchange)?"resize":"orientationchange",c.isNothing(this.orientationEventName)||c.Events.add(a,this.orientationEventName,this.windowOrientationChangeHandler),this.settings.target===a&&c.Events.add(a,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&c.Events.add(a.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.settings.jQueryMobile?a.location.hash=this.settings.jQueryMobileDialogHash:(this.currentHistoryHashValue="PhotoSwipe"+(new Date).getTime().toString(),a.location.hash=this.currentHistoryHashValue),c.Events.add(a,"hashchange",this.windowHashChangeHandler)),this.settings.enableMouseWheel&&c.Events.add(a,"mousewheel",this.mouseWheelHandler),c.Events.add(this.uiLayer,c.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),c.Events.add(this.carousel,f.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),c.Events.add(this.carousel,f.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),c.Events.add(this.carousel,f.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler),c.isNothing(this.toolbar)||(c.Events.add(this.toolbar,g.EventTypes.onTap,this.toolbarTapHandler),c.Events.add(this.toolbar,g.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),c.Events.add(this.toolbar,g.EventTypes.onShow,this.toolbarShowHandler),c.Events.add(this.toolbar,g.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),c.Events.add(this.toolbar,g.EventTypes.onHide,this.toolbarHideHandler))},removeEventHandlers:function(){c.Browser.iOS&&!c.Browser.safari&&c.Events.remove(a.document.body,"orientationchange",this.windowOrientationChangeHandler),c.isNothing(this.orientationEventName)||c.Events.remove(a,this.orientationEventName,this.windowOrientationChangeHandler),c.Events.remove(a,"scroll",this.windowScrollHandler),this.settings.enableKeyboard&&c.Events.remove(a.document,"keydown",this.keyDownHandler),this.isBackEventSupported&&this.settings.backButtonHideEnabled&&c.Events.remove(a,"hashchange",this.windowHashChangeHandler),this.settings.enableMouseWheel&&c.Events.remove(a,"mousewheel",this.mouseWheelHandler),c.isNothing(this.uiLayer)||c.Events.remove(this.uiLayer,c.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler),c.isNothing(this.toolbar)||(c.Events.remove(this.carousel,f.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),c.Events.remove(this.carousel,f.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),c.Events.remove(this.carousel,f.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler)),c.isNothing(this.toolbar)||(c.Events.remove(this.toolbar,g.EventTypes.onTap,this.toolbarTapHandler),c.Events.remove(this.toolbar,g.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),c.Events.remove(this.toolbar,g.EventTypes.onShow,this.toolbarShowHandler),c.Events.remove(this.toolbar,g.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),c.Events.remove(this.toolbar,g.EventTypes.onHide,this.toolbarHideHandler))},hide:function(){if(!this.settings.preventHide){if(c.isNothing(this.documentOverlay))throw"Code.PhotoSwipe.PhotoSwipeClass.hide: PhotoSwipe instance is already hidden";c.isNothing(this.hiding)&&(this.clearUIWebViewResetPositionTimeout(),this.destroyZoomPanRotate(),this.removeEventHandlers(),c.Events.fire(this,{type:j.EventTypes.onBeforeHide,target:this}),this.uiLayer.dispose(),this.uiLayer=null,c.isNothing(this.toolbar)||(this.toolbar.dispose(),this.toolbar=null),this.carousel.dispose(),this.carousel=null,c.DOM.removeClass(a.document.body,j.CssClasses.activeBody),this.documentOverlay.dispose(),this.documentOverlay=null,this._isResettingPosition=!1,j.unsetActivateInstance(this),c.Events.fire(this,{type:j.EventTypes.onHide,target:this}),this.goBackInHistory())}},goBackInHistory:function(){this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.backButtonClicked||a.history.back())},play:function(){!this.isZoomActive()&&!this.settings.preventSlideshow&&!c.isNothing(this.carousel)&&(!c.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut(),this.carousel.startSlideshow())},stop:function(){this.isZoomActive()||c.isNothing(this.carousel)||this.carousel.stopSlideshow()},previous:function(){this.isZoomActive()||c.isNothing(this.carousel)||this.carousel.previous()},next:function(){this.isZoomActive()||c.isNothing(this.carousel)||this.carousel.next()},toggleToolbar:function(){this.isZoomActive()||c.isNothing(this.toolbar)||this.toolbar.toggleVisibility(this.currentIndex)},fadeOutToolbarIfVisible:function(){!c.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.settings.captionAndToolbarAutoHideDelay>0&&this.toolbar.fadeOut()},createZoomPanRotate:function(){this.stop(),this.canUserZoom()&&!this.isZoomActive()&&(c.Events.fire(this,j.EventTypes.onBeforeZoomPanRotateShow),this.zoomPanRotate=new i.ZoomPanRotateClass(this.settings,this.cache.images[this.currentIndex],this.uiLayer),this.uiLayer.captureSettings.preventDefaultTouchEvents=!0,c.Events.add(this.zoomPanRotate,j.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),c.Events.fire(this,j.EventTypes.onZoomPanRotateShow),!c.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut())},destroyZoomPanRotate:function(){c.isNothing(this.zoomPanRotate)||(c.Events.fire(this,j.EventTypes.onBeforeZoomPanRotateHide),c.Events.remove(this.zoomPanRotate,j.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),this.zoomPanRotate.dispose(),this.zoomPanRotate=null,this.uiLayer.captureSettings.preventDefaultTouchEvents=this.settings.preventDefaultTouchEvents,c.Events.fire(this,j.EventTypes.onZoomPanRotateHide))},canUserZoom:function(){var a;if(c.Browser.msie){if(a=document.createElement("div"),c.isNothing(a.style.msTransform))return!1}else if(!c.Browser.isCSSTransformSupported)return!1;return this.settings.allowUserZoom?this.carousel.isSliding?!1:(a=this.cache.images[this.currentIndex],c.isNothing(a)?!1:a.isLoading?!1:!0):!1},isZoomActive:function(){return!c.isNothing(this.zoomPanRotate)},getCurrentImage:function(){return this.cache.images[this.currentIndex]},onDocumentOverlayFadeIn:function(){a.setTimeout(function(){var b=this.settings.target===a?a.document.body:this.settings.target;c.DOM.removeClass(b,j.CssClasses.buildingBody),c.DOM.addClass(b,j.CssClasses.activeBody),this.addEventHandlers(),this.carousel.show(this.currentIndex),this.uiLayer.show(),this.settings.autoStartSlideshow?this.play():c.isNothing(this.toolbar)||this.toolbar.show(this.currentIndex),c.Events.fire(this,{type:j.EventTypes.onShow,target:this}),this.setUIWebViewResetPositionTimeout()}.bind(this),250)},setUIWebViewResetPositionTimeout:function(){this.settings.enableUIWebViewRepositionTimeout&&c.Browser.iOS&&!c.Browser.safari&&(c.isNothing(this._uiWebViewResetPositionTimeout)||a.clearTimeout(this._uiWebViewResetPositionTimeout),this._uiWebViewResetPositionTimeout=a.setTimeout(function(){this.resetPosition(),this.setUIWebViewResetPositionTimeout()}.bind(this),this.settings.uiWebViewResetPositionDelay))},clearUIWebViewResetPositionTimeout:function(){c.isNothing(this._uiWebViewResetPositionTimeout)||a.clearTimeout(this._uiWebViewResetPositionTimeout)},onWindowScroll:function(){this.resetPosition()},onWindowOrientationChange:function(){this.resetPosition()},onWindowHashChange:function(){a.location.hash!=="#"+(this.settings.jQueryMobile?this.settings.jQueryMobileDialogHash:this.currentHistoryHashValue)&&(this.backButtonClicked=!0,this.hide())},onKeyDown:function(a){a.keyCode===37?(a.preventDefault(),this.previous()):a.keyCode===39?(a.preventDefault(),this.next()):a.keyCode===38||a.keyCode===40?a.preventDefault():a.keyCode===27?(a.preventDefault(),this.hide()):a.keyCode===32?(this.settings.hideToolbar?this.hide():this.toggleToolbar(),a.preventDefault()):a.keyCode===13&&(a.preventDefault(),this.play())},onUILayerTouch:function(b){if(this.isZoomActive())switch(b.action){case c.TouchElement.ActionTypes.gestureChange:this.zoomPanRotate.zoomRotate(b.scale,this.settings.allowRotationOnUserZoom?b.rotation:0);break;case c.TouchElement.ActionTypes.gestureEnd:this.zoomPanRotate.setStartingScaleAndRotation(b.scale,this.settings.allowRotationOnUserZoom?b.rotation:0);break;case c.TouchElement.ActionTypes.touchStart:this.zoomPanRotate.panStart(b.point);break;case c.TouchElement.ActionTypes.touchMove:this.zoomPanRotate.pan(b.point);break;case c.TouchElement.ActionTypes.doubleTap:this.destroyZoomPanRotate(),this.toggleToolbar();break;case c.TouchElement.ActionTypes.swipeLeft:this.destroyZoomPanRotate(),this.next(),this.toggleToolbar();break;case c.TouchElement.ActionTypes.swipeRight:this.destroyZoomPanRotate(),this.previous(),this.toggleToolbar()}else switch(b.action){case c.TouchElement.ActionTypes.touchMove:case c.TouchElement.ActionTypes.swipeLeft:case c.TouchElement.ActionTypes.swipeRight:this.fadeOutToolbarIfVisible(),this.carousel.onTouch(b.action,b.point);break;case c.TouchElement.ActionTypes.touchStart:case c.TouchElement.ActionTypes.touchMoveEnd:this.carousel.onTouch(b.action,b.point);break;case c.TouchElement.ActionTypes.tap:this.toggleToolbar();break;case c.TouchElement.ActionTypes.doubleTap:this.settings.target===a&&(b.point.x-=c.DOM.windowScrollLeft(),b.point.y-=c.DOM.windowScrollTop());var d=this.cache.images[this.currentIndex].imageEl,e=a.parseInt(c.DOM.getStyle(d,"top"),10),f=a.parseInt(c.DOM.getStyle(d,"left"),10),g=f+c.DOM.width(d),d=e+c.DOM.height(d);b.point.x<f?b.point.x=f:b.point.x>g&&(b.point.x=g),b.point.y<e?b.point.y=e:b.point.y>d&&(b.point.y=d),this.createZoomPanRotate(),this.isZoomActive()&&this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel,b.point);break;case c.TouchElement.ActionTypes.gestureStart:this.createZoomPanRotate()}c.Events.fire(this,{type:j.EventTypes.onTouch,target:this,point:b.point,action:b.action})},onCarouselSlideByEnd:function(a){this.currentIndex=a.cacheIndex,c.isNothing(this.toolbar)||(this.toolbar.setCaption(this.currentIndex),this.toolbar.setToolbarStatus(this.currentIndex)),c.Events.fire(this,{type:j.EventTypes.onDisplayImage,target:this,action:a.action,index:a.cacheIndex})},onToolbarTap:function(a){switch(a.action){case g.ToolbarAction.next:this.next();break;case g.ToolbarAction.previous:this.previous();break;case g.ToolbarAction.close:this.hide();break;case g.ToolbarAction.play:this.play()}c.Events.fire(this,{type:j.EventTypes.onToolbarTap,target:this,toolbarAction:a.action,tapTarget:a.tapTarget})},onMouseWheel:function(a){var b=c.Events.getWheelDelta(a);a.timeStamp-(this.mouseWheelStartTime||0)<this.settings.mouseWheelSpeed||(this.mouseWheelStartTime=a.timeStamp,this.settings.invertMouseWheel&&(b*=-1),b<0?this.next():b>0&&this.previous())},onCarouselSlideshowStart:function(){c.Events.fire(this,{type:j.EventTypes.onSlideshowStart,target:this})},onCarouselSlideshowStop:function(){c.Events.fire(this,{type:j.EventTypes.onSlideshowStop,target:this})},onToolbarBeforeShow:function(){c.Events.fire(this,{type:j.EventTypes.onBeforeCaptionAndToolbarShow,target:this})},onToolbarShow:function(){c.Events.fire(this,{type:j.EventTypes.onCaptionAndToolbarShow,target:this})},onToolbarBeforeHide:function(){c.Events.fire(this,{type:j.EventTypes.onBeforeCaptionAndToolbarHide,target:this})},onToolbarHide:function(){c.Events.fire(this,{type:j.EventTypes.onCaptionAndToolbarHide,target:this})},onZoomPanRotateTransform:function(a){c.Events.fire(this,{target:this,type:j.EventTypes.onZoomPanRotateTransform,scale:a.scale,rotation:a.rotation,rotationDegs:a.rotationDegs,translateX:a.translateX,translateY:a.translateY})}})}(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Cache,window.Code.PhotoSwipe.DocumentOverlay,window.Code.PhotoSwipe.Carousel,window.Code.PhotoSwipe.Toolbar,window.Code.PhotoSwipe.UILayer,window.Code.PhotoSwipe.ZoomPanRotate),define("vendor/photoswipe",function(){}),1,function(){var a;typeof Joshfire=="undefined"&&(Joshfire={}),a={version:[0,9,3],onReady:function(a){a()},adapter:"ios",adapterModules:{android:["app","dependencies.json","inputs/touch","ui/toolbar","uielements/list","uielements/panel","uielements/video.mediaelement","vendor/iscroll"],browser:["app","inputs/http","inputs/keyboard","inputs/mouse","uielement","uielements/list","uielements/mediacontrols","uielements/page","uielements/panel","uielements/panel.manager","uielements/video.mediaelement","uielements/video.popup","uielements/video.youtube.swf","utils/activitymonitor","utils/datasource","utils/dollar","utils/localstorage","utils/navigation","utils/onready","utils/stresstest"],googletv:["dependencies.json","inputs/keyboard","ui/videoplayer","uielement"],ios:["dependencies.json"],lgtv:["dependencies.json","ui/videoplayer","uielement","utils/dollar"],node:["app.factory","app","class","global.exec","inputs/http","uielements/page","uielements/panel","uielements/panel.manager","uielements/video.mediaelement","utils/datasource","utils/dollar","utils/eventsocket","utils/templatecompiler.cli","utils/templatecompiler","vendor/json2","view"],none:[],philips:["dependencies.json","ui/videoplayer","uielement","uielements/list","uielements/video.mediaelement","utils/dollar","utils/stresstest"],phone:["collection","ui/toolbar","uielement","utils/dollar","utils/onready"],qt4:[],samsungtv:["dependencies.json","inputs/remote","ui/cardpanel","ui/grid","ui/horizontallayout","ui/slidepanel","ui/toolbar","ui/verticallist","ui/videoplayer","uielement","utils/dollar","utils/onready","utils/widgetapi","view"],tv:["inputs/remote","ui/cardpanel","ui/grid","ui/horizontallayout","ui/slidepanel","ui/toolbar","ui/verticallist","ui/videoplayer","uielement","utils/dollar","utils/onready"]},adapterDeps:["phone"],debug:!1,path:(Joshfire.framework||{}).path||"joshfire"};if(typeof document!="undefined"){var b=document.getElementsByTagName("script"),c,d=new RegExp("^(.*)/adapters/"+a.adapter+"/bootstrap.js$");for(var e=b.length-1;e>=0;e--)c=d.exec(b[e].getAttribute("src")),c&&(a.path=c[1])}typeof require!="undefined"&&require.config&&require.config({paths:{"joshfire-framework":a.path},urlArgs:Joshfire.debug?"bust="+(new Date).getTime():""}),Joshfire.framework=a,typeof module!="undefined"&&module.exports&&(module.exports.JoshfireFramework=a)}.call(this),function(a){a.onReady=function(b){a.require(["joshfire/vendor/zepto"],function(a){b.call()})}}(Joshfire),define("joshlib",{normalize:function(a,b){var c=[Joshfire.framework.adapter].concat(Joshfire.framework.adapterDeps),d=Joshfire.framework.adapterModules,e="joshfire-framework/";if(a.substring(0,14)=="adapters/none/")return e+a.substring(14);if(a.substring(0,9)=="adapters/")return e+a;for(var f=0;f<c.length;f++)for(var g=0;g<d[c[f]].length;g++)if(a==d[c[f]][g])return e+"adapters/"+c[f]+"/"+a;return e+a},load:function(a,b,c,d){b([a],function(a){c(a)})}}),define("joshfire-framework/adapters/phone/utils/onready",[],function(){return function(a){/complete|loaded|interactive/.test(document.readyState)&&a(),document.addEventListener("DOMContentLoaded",a,!1)}}),define("joshfire-framework/vendor/iscroll",[],function(){return function(a,b){function E(a){return e===""?a:(a=a.charAt(0).toUpperCase()+a.substr(1),e+a)}var c=Math,d=b.createElement("div").style,e=function(){var a="t,webkitT,MozT,msT,OT".split(","),b,c=0,e=a.length;for(;c<e;c++){b=a[c]+"ransform";if(b in d)return a[c].substr(0,a[c].length-1)}return!1}(),f=e?"-"+e.toLowerCase()+"-":"",g=E("transform"),h=E("transitionProperty"),i=E("transitionDuration"),j=E("transformOrigin"),k=E("transitionTimingFunction"),l=E("transitionDelay"),m=/android/gi.test(navigator.appVersion),n=/iphone|ipad/gi.test(navigator.appVersion),o=/hp-tablet/gi.test(navigator.appVersion),p=E("perspective")in d,q="ontouchstart"in a&&!o,r=!!e,s=E("transition")in d,t="resize",u=q?"touchstart":"mousedown",v=q?"touchmove":"mousemove",w=q?"touchend":"mouseup",x=q?"touchcancel":"mouseup",y=e=="Moz"?"DOMMouseScroll":"mousewheel",z=function(){if(e===!1)return!1;var a={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"oTransitionEnd",ms:"MSTransitionEnd"};return a[e]}(),A=function(){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(a){return setTimeout(a,1)}}(),B=function(){return a.cancelRequestAnimationFrame||a.webkitCancelAnimationFrame||a.webkitCancelRequestAnimationFrame||a.mozCancelRequestAnimationFrame||a.oCancelRequestAnimationFrame||a.msCancelRequestAnimationFrame||clearTimeout}(),C=p?" translateZ(0)":"",D=function(c,d){var e=this,l;e.wrapper=typeof c=="object"?c:b.getElementById(c),e.wrapper.style.overflow="hidden",e.scroller=e.wrapper.children[0],e.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,hScrollbar:!0,vScrollbar:!0,fixedScrollbar:m,hideScrollbar:n,fadeScrollbar:n&&p,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(a){a.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(l in d)e.options[l]=d[l];e.x=e.options.x,e.y=e.options.y,e.options.useTransform=r&&e.options.useTransform,e.options.hScrollbar=e.options.hScroll&&e.options.hScrollbar,e.options.vScrollbar=e.options.vScroll&&e.options.vScrollbar,e.options.zoom=e.options.useTransform&&e.options.zoom,e.options.useTransition=s&&e.options.useTransition,e.options.zoom&&m&&(C=""),e.scroller.style[h]=e.options.useTransform?f+"transform":"top left",e.scroller.style[i]="0",e.scroller.style[j]="0 0",e.options.useTransition&&(e.scroller.style[k]="cubic-bezier(0.33,0.66,0.66,1)"),e.options.useTransform?e.scroller.style[g]="translate("+e.x+"px,"+e.y+"px)"+C:e.scroller.style.cssText+=";position:absolute;top:"+e.y+"px;left:"+e.x+"px",e.options.useTransition&&(e.options.fixedScrollbar=!0),e.refresh(),e._bind(t,a),e._bind(u),q||(e._bind("mouseout",e.wrapper),e.options.wheelAction!="none"&&e._bind(y)),e.options.checkDOMChanges&&(e.checkDOMTime=setInterval(function(){e._checkDOMChanges()},500))};D.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(a){var b=this;switch(a.type){case u:if(!q&&a.button!==0)return;b._start(a);break;case v:b._move(a);break;case w:case x:b._end(a);break;case t:b._resize();break;case y:b._wheel(a);break;case"mouseout":b._mouseout(a);break;case z:b._transitionEnd(a)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(a){var d=this,e;if(!d[a+"Scrollbar"]){d[a+"ScrollbarWrapper"]&&(r&&(d[a+"ScrollbarIndicator"].style[g]=""),d[a+"ScrollbarWrapper"].parentNode&&d[a+"ScrollbarWrapper"].parentNode.removeChild(d[a+"ScrollbarWrapper"]),d[a+"ScrollbarWrapper"]=null,d[a+"ScrollbarIndicator"]=null);return}d[a+"ScrollbarWrapper"]||(e=b.createElement("div"),d.options.scrollbarClass?e.className=d.options.scrollbarClass+a.toUpperCase():e.style.cssText="position:absolute;z-index:100;"+(a=="h"?"height:7px;bottom:1px;left:2px;right:"+(d.vScrollbar?"7":"2")+"px":"width:7px;bottom:"+(d.hScrollbar?"7":"2")+"px;top:2px;right:1px"),e.style.cssText+=";pointer-events:none;"+f+"transition-property:opacity;"+f+"transition-duration:"+(d.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(d.options.hideScrollbar?"0":"1"),d.wrapper.appendChild(e),d[a+"ScrollbarWrapper"]=e,e=b.createElement("div"),d.options.scrollbarClass||(e.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+f+"background-clip:padding-box;"+f+"box-sizing:border-box;"+(a=="h"?"height:100%":"width:100%")+";"+f+"border-radius:3px;border-radius:3px"),e.style.cssText+=";pointer-events:none;"+f+"transition-property:"+f+"transform;"+f+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+f+"transition-duration:0;"+f+"transform: translate(0,0)"+C,d.options.useTransition&&(e.style.cssText+=";"+f+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),d[a+"ScrollbarWrapper"].appendChild(e),d[a+"ScrollbarIndicator"]=e),a=="h"?(d.hScrollbarSize=d.hScrollbarWrapper.clientWidth,d.hScrollbarIndicatorSize=c.max(c.round(d.hScrollbarSize*d.hScrollbarSize/d.scrollerW),8),d.hScrollbarIndicator.style.width=d.hScrollbarIndicatorSize+"px",d.hScrollbarMaxScroll=d.hScrollbarSize-d.hScrollbarIndicatorSize,d.hScrollbarProp=d.hScrollbarMaxScroll/d.maxScrollX):(d.vScrollbarSize=d.vScrollbarWrapper.clientHeight,d.vScrollbarIndicatorSize=c.max(c.round(d.vScrollbarSize*d.vScrollbarSize/d.scrollerH),8),d.vScrollbarIndicator.style.height=d.vScrollbarIndicatorSize+"px",d.vScrollbarMaxScroll=d.vScrollbarSize-d.vScrollbarIndicatorSize,d.vScrollbarProp=d.vScrollbarMaxScroll/d.maxScrollY),d._scrollbarPos(a,!0)},_resize:function(){var a=this;setTimeout(function(){a.refresh()},m?200:0)},_pos:function(a,b){if(this.zoomed)return;a=this.hScroll?a:0,b=this.vScroll?b:0,this.options.useTransform?this.scroller.style[g]="translate("+a+"px,"+b+"px) scale("+this.scale+")"+C:(a=c.round(a),b=c.round(b),this.scroller.style.left=a+"px",this.scroller.style.top=b+"px"),this.x=a,this.y=b,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(a,b){var d=this,e=a=="h"?d.x:d.y,f;if(!d[a+"Scrollbar"])return;e=d[a+"ScrollbarProp"]*e,e<0?(d.options.fixedScrollbar||(f=d[a+"ScrollbarIndicatorSize"]+c.round(e*3),f<8&&(f=8),d[a+"ScrollbarIndicator"].style[a=="h"?"width":"height"]=f+"px"),e=0):e>d[a+"ScrollbarMaxScroll"]&&(d.options.fixedScrollbar?e=d[a+"ScrollbarMaxScroll"]:(f=d[a+"ScrollbarIndicatorSize"]-c.round((e-d[a+"ScrollbarMaxScroll"])*3),f<8&&(f=8),d[a+"ScrollbarIndicator"].style[a=="h"?"width":"height"]=f+"px",e=d[a+"ScrollbarMaxScroll"]+(d[a+"ScrollbarIndicatorSize"]-f))),d[a+"ScrollbarWrapper"].style[l]="0",d[a+"ScrollbarWrapper"].style.opacity=b&&d.options.hideScrollbar?"0":"1",d[a+"ScrollbarIndicator"].style[g]="translate("+(a=="h"?e+"px,0)":"0,"+e+"px)")+C},_start:function(a){var b=this,d=q?a.touches[0]:a,e,f,h,i,j;if(!b.enabled)return;b.options.onBeforeScrollStart&&b.options.onBeforeScrollStart.call(b,a),(b.options.useTransition||b.options.zoom)&&b._transitionTime(0),b.moved=!1,b.animating=!1,b.zoomed=!1,b.distX=0,b.distY=0,b.absDistX=0,b.absDistY=0,b.dirX=0,b.dirY=0,b.options.zoom&&q&&a.touches.length>1&&(i=c.abs(a.touches[0].pageX-a.touches[1].pageX),j=c.abs(a.touches[0].pageY-a.touches[1].pageY),b.touchesDistStart=c.sqrt(i*i+j*j),b.originX=c.abs(a.touches[0].pageX+a.touches[1].pageX-b.wrapperOffsetLeft*2)/2-b.x,b.originY=c.abs(a.touches[0].pageY+a.touches[1].pageY-b.wrapperOffsetTop*2)/2-b.y,b.options.onZoomStart&&b.options.onZoomStart.call(b,a));if(b.options.momentum){b.options.useTransform?(e=getComputedStyle(b.scroller,null)[g].replace(/[^0-9\-.,]/g,"").split(","),f=e[4]*1,h=e[5]*1):(f=getComputedStyle(b.scroller,null).left.replace(/[^0-9-]/g,"")*1,h=getComputedStyle(b.scroller,null).top.replace(/[^0-9-]/g,"")*1);if(f!=b.x||h!=b.y)b.options.useTransition?b._unbind(z):B(b.aniTime),b.steps=[],b._pos(f,h)}b.absStartX=b.x,b.absStartY=b.y,b.startX=b.x,b.startY=b.y,b.pointX=d.pageX,b.pointY=d.pageY,b.startTime=a.timeStamp||Date.now(),b.options.onScrollStart&&b.options.onScrollStart.call(b,a),b._bind(v),b._bind(w),b._bind(x)},_move:function(a){var b=this,d=q?a.touches[0]:a,e=d.pageX-b.pointX,f=d.pageY-b.pointY,h=b.x+e,i=b.y+f,j,k,l,m=a.timeStamp||Date.now();b.options.onBeforeScrollMove&&b.options.onBeforeScrollMove.call(b,a);if(b.options.zoom&&q&&a.touches.length>1){j=c.abs(a.touches[0].pageX-a.touches[1].pageX),k=c.abs(a.touches[0].pageY-a.touches[1].pageY),b.touchesDist=c.sqrt(j*j+k*k),b.zoomed=!0,l=1/b.touchesDistStart*b.touchesDist*this.scale,l<b.options.zoomMin?l=.5*b.options.zoomMin*Math.pow(2,l/b.options.zoomMin):l>b.options.zoomMax&&(l=2*b.options.zoomMax*Math.pow(.5,b.options.zoomMax/l)),b.lastScale=l/this.scale,h=this.originX-this.originX*b.lastScale+this.x,i=this.originY-this.originY*b.lastScale+this.y,this.scroller.style[g]="translate("+h+"px,"+i+"px) scale("+l+")"+C,b.options.onZoom&&b.options.onZoom.call(b,a);return}b.pointX=d.pageX,b.pointY=d.pageY;if(h>0||h<b.maxScrollX)h=b.options.bounce?b.x+e/2:h>=0||b.maxScrollX>=0?0:b.maxScrollX;if(i>b.minScrollY||i<b.maxScrollY)i=b.options.bounce?b.y+f/2:i>=b.minScrollY||b.maxScrollY>=0?b.minScrollY:b.maxScrollY;b.distX+=e,b.distY+=f,b.absDistX=c.abs(b.distX),b.absDistY=c.abs(b.distY);if(b.absDistX<6&&b.absDistY<6)return;b.options.lockDirection&&(b.absDistX>b.absDistY+5?(i=b.y,f=0):b.absDistY>b.absDistX+5&&(h=b.x,e=0)),b.moved=!0,b._pos(h,i),b.dirX=e>0?-1:e<0?1:0,b.dirY=f>0?-1:f<0?1:0,m-b.startTime>300&&(b.startTime=m,b.startX=b.x,b.startY=b.y),b.options.onScrollMove&&b.options.onScrollMove.call(b,a)},_end:function(a){if(q&&a.touches.length!==0)return;var d=this,e=q?a.changedTouches[0]:a,f,h,j={dist:0,time:0},k={dist:0,time:0},l=(a.timeStamp||Date.now())-d.startTime,m=d.x,n=d.y,o,p,r,s,t;d._unbind(v),d._unbind(w),d._unbind(x),d.options.onBeforeScrollEnd&&d.options.onBeforeScrollEnd.call(d,a);if(d.zoomed){t=d.scale*d.lastScale,t=Math.max(d.options.zoomMin,t),t=Math.min(d.options.zoomMax,t),d.lastScale=t/d.scale,d.scale=t,d.x=d.originX-d.originX*d.lastScale+d.x,d.y=d.originY-d.originY*d.lastScale+d.y,d.scroller.style[i]="200ms",d.scroller.style[g]="translate("+d.x+"px,"+d.y+"px) scale("+d.scale+")"+C,d.zoomed=!1,d.refresh(),d.options.onZoomEnd&&d.options.onZoomEnd.call(d,a);return}if(!d.moved){q&&(d.doubleTapTimer&&d.options.zoom?(clearTimeout(d.doubleTapTimer),d.doubleTapTimer=null,d.options.onZoomStart&&d.options.onZoomStart.call(d,a),d.zoom(d.pointX,d.pointY,d.scale==1?d.options.doubleTapZoom:1),d.options.onZoomEnd&&setTimeout(function(){d.options.onZoomEnd.call(d,a)},200)):this.options.handleClick&&(d.doubleTapTimer=setTimeout(function(){d.doubleTapTimer=null,f=e.target;while(f.nodeType!=1)f=f.parentNode;f.tagName!="SELECT"&&f.tagName!="INPUT"&&f.tagName!="TEXTAREA"&&(h=b.createEvent("MouseEvents"),h.initMouseEvent("click",!0,!0,a.view,1,e.screenX,e.screenY,e.clientX,e.clientY,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,0,null),h._fake=!0,f.dispatchEvent(h))},d.options.zoom?250:0))),d._resetPos(200),d.options.onTouchEnd&&d.options.onTouchEnd.call(d,a);return}if(l<300&&d.options.momentum){j=m?d._momentum(m-d.startX,l,-d.x,d.scrollerW-d.wrapperW+d.x,d.options.bounce?d.wrapperW:0):j,k=n?d._momentum(n-d.startY,l,-d.y,d.maxScrollY<0?d.scrollerH-d.wrapperH+d.y-d.minScrollY:0,d.options.bounce?d.wrapperH:0):k,m=d.x+j.dist,n=d.y+k.dist;if(d.x>0&&m>0||d.x<d.maxScrollX&&m<d.maxScrollX)j={dist:0,time:0};if(d.y>d.minScrollY&&n>d.minScrollY||d.y<d.maxScrollY&&n<d.maxScrollY)k={dist:0,time:0}}if(j.dist||k.dist){r=c.max(c.max(j.time,k.time),10),d.options.snap&&(o=m-d.absStartX,p=n-d.absStartY,c.abs(o)<d.options.snapThreshold&&c.abs(p)<d.options.snapThreshold?d.scrollTo(d.absStartX,d.absStartY,200):(s=d._snap(m,n),m=s.x,n=s.y,r=c.max(s.time,r))),d.scrollTo(c.round(m),c.round(n),r),d.options.onTouchEnd&&d.options.onTouchEnd.call(d,a);return}if(d.options.snap){o=m-d.absStartX,p=n-d.absStartY,c.abs(o)<d.options.snapThreshold&&c.abs(p)<d.options.snapThreshold?d.scrollTo(d.absStartX,d.absStartY,200):(s=d._snap(d.x,d.y),(s.x!=d.x||s.y!=d.y)&&d.scrollTo(s.x,s.y,s.time)),d.options.onTouchEnd&&d.options.onTouchEnd.call(d,a);return}d._resetPos(200),d.options.onTouchEnd&&d.options.onTouchEnd.call(d,a)},_resetPos:function(a){var b=this,c=b.x>=0?0:b.x<b.maxScrollX?b.maxScrollX:b.x,d=b.y>=b.minScrollY||b.maxScrollY>0?b.minScrollY:b.y<b.maxScrollY?b.maxScrollY:b.y;if(c==b.x&&d==b.y){b.moved&&(b.moved=!1,b.options.onScrollEnd&&b.options.onScrollEnd.call(b)),b.hScrollbar&&b.options.hideScrollbar&&(e=="webkit"&&(b.hScrollbarWrapper.style[l]="300ms"),b.hScrollbarWrapper.style.opacity="0"),b.vScrollbar&&b.options.hideScrollbar&&(e=="webkit"&&(b.vScrollbarWrapper.style[l]="300ms"),b.vScrollbarWrapper.style.opacity="0");return}b.scrollTo(c,d,a||0)},_wheel:function(a){var b=this,c,d,e,f,g;if("wheelDeltaX"in a)c=a.wheelDeltaX/12,d=a.wheelDeltaY/12;else if("wheelDelta"in a)c=d=a.wheelDelta/12;else if("detail"in a)c=d=-a.detail*3;else return;if(b.options.wheelAction=="zoom"){g=b.scale*Math.pow(2,1/3*(d?d/Math.abs(d):0)),g<b.options.zoomMin&&(g=b.options.zoomMin),g>b.options.zoomMax&&(g=b.options.zoomMax),g!=b.scale&&(!b.wheelZoomCount&&b.options.onZoomStart&&b.options.onZoomStart.call(b,a),b.wheelZoomCount++,b.zoom(a.pageX,a.pageY,g,400),setTimeout(function(){b.wheelZoomCount--,!b.wheelZoomCount&&b.options.onZoomEnd&&b.options.onZoomEnd.call(b,a)},400));return}e=b.x+c,f=b.y+d,e>0?e=0:e<b.maxScrollX&&(e=b.maxScrollX),f>b.minScrollY?f=b.minScrollY:f<b.maxScrollY&&(f=b.maxScrollY),b.maxScrollY<0&&b.scrollTo(e,f,0)},_mouseout:function(a){var b=a.relatedTarget;if(!b){this._end(a);return}while(b=b.parentNode)if(b==this.wrapper)return;this._end(a)},_transitionEnd:function(a){var b=this;if(a.target!=b.scroller)return;b._unbind(z),b._startAni()},_startAni:function(){var a=this,b=a.x,d=a.y,e=Date.now(),f,g,h;if(a.animating)return;if(!a.steps.length){a._resetPos(400);return}f=a.steps.shift(),f.x==b&&f.y==d&&(f.time=0),a.animating=!0,a.moved=!0;if(a.options.useTransition){a._transitionTime(f.time),a._pos(f.x,f.y),a.animating=!1,f.time?a._bind(z):a._resetPos(0);return}h=function(){var i=Date.now(),j,k;if(i>=e+f.time){a._pos(f.x,f.y),a.animating=!1,a.options.onAnimationEnd&&a.options.onAnimationEnd.call(a),a._startAni();return}i=(i-e)/f.time-1,g=c.sqrt(1-i*i),j=(f.x-b)*g+b,k=(f.y-d)*g+d,a._pos(j,k),a.animating&&(a.aniTime=A(h))},h()},_transitionTime:function(a){a+="ms",this.scroller.style[i]=a,this.hScrollbar&&(this.hScrollbarIndicator.style[i]=a),this.vScrollbar&&(this.vScrollbarIndicator.style[i]=a)},_momentum:function(a,b,d,e,f){var g=6e-4,h=c.abs(a)/b,i=h*h/(2*g),j=0,k=0;return a>0&&i>d?(k=f/(6/(i/h*g)),d+=k,h=h*d/i,i=d):a<0&&i>e&&(k=f/(6/(i/h*g)),e+=k,h=h*e/i,i=e),i*=a<0?-1:1,j=h/g,{dist:i,time:c.round(j)}},_offset:function(a){var b=-a.offsetLeft,c=-a.offsetTop;while(a=a.offsetParent)b-=a.offsetLeft,c-=a.offsetTop;return a!=this.wrapper&&(b*=this.scale,c*=this.scale),{left:b,top:c}},_snap:function(a,b){var d=this,e,f,g,h,i,j;g=d.pagesX.length-1;for(e=0,f=d.pagesX.length;e<f;e++)if(a>=d.pagesX[e]){g=e;break}g==d.currPageX&&g>0&&d.dirX<0&&g--,a=d.pagesX[g],i=c.abs(a-d.pagesX[d.currPageX]),i=i?c.abs(d.x-a)/i*500:0,d.currPageX=g,g=d.pagesY.length-1;for(e=0;e<g;e++)if(b>=d.pagesY[e]){g=e;break}return g==d.currPageY&&g>0&&d.dirY<0&&g--,b=d.pagesY[g],j=c.abs(b-d.pagesY[d.currPageY]),j=j?c.abs(d.y-b)/j*500:0,d.currPageY=g,h=c.round(c.max(i,j))||200,{x:a,y:b,time:h}},_bind:function(a,b,c){(b||this.scroller).addEventListener(a,this,!!c)},_unbind:function(a,b,c){(b||this.scroller).removeEventListener(a,this,!!c)},destroy:function(){var b=this;b.scroller.style[g]="",b.hScrollbar=!1,b.vScrollbar=!1,b._scrollbar("h"),b._scrollbar("v"),b._unbind(t,a),b._unbind(u),b._unbind(v),b._unbind(w),b._unbind(x),b.options.hasTouch||(b._unbind("mouseout",b.wrapper),b._unbind(y)),b.options.useTransition&&b._unbind(z),b.options.checkDOMChanges&&clearInterval(b.checkDOMTime),b.options.onDestroy&&b.options.onDestroy.call(b)},refresh:function(){var a=this,b,d,e,f,g=0,h=0;a.scale<a.options.zoomMin&&(a.scale=a.options.zoomMin),a.wrapperW=a.wrapper.clientWidth||1,a.wrapperH=a.wrapper.clientHeight||1,a.minScrollY=-a.options.topOffset||0,a.scrollerW=c.round(a.scroller.offsetWidth*a.scale),a.scrollerH=c.round((a.scroller.offsetHeight+a.minScrollY)*a.scale),a.maxScrollX=a.wrapperW-a.scrollerW,a.maxScrollY=a.wrapperH-a.scrollerH+a.minScrollY,a.dirX=0,a.dirY=0,a.options.onRefresh&&a.options.onRefresh.call(a),a.hScroll=a.options.hScroll&&a.maxScrollX<0,a.vScroll=a.options.vScroll&&(!a.options.bounceLock&&!a.hScroll||a.scrollerH>a.wrapperH),a.hScrollbar=a.hScroll&&a.options.hScrollbar,a.vScrollbar=a.vScroll&&a.options.vScrollbar&&a.scrollerH>a.wrapperH,b=a._offset(a.wrapper),a.wrapperOffsetLeft=-b.left,a.wrapperOffsetTop=-b.top;if(typeof a.options.snap=="string"){a.pagesX=[],a.pagesY=[],f=a.scroller.querySelectorAll(a.options.snap);for(d=0,e=f.length;d<e;d++)g=a._offset(f[d]),g.left+=a.wrapperOffsetLeft,g.top+=a.wrapperOffsetTop,a.pagesX[d]=g.left<a.maxScrollX?a.maxScrollX:g.left*a.scale,a.pagesY[d]=g.top<a.maxScrollY?a.maxScrollY:g.top*a.scale}else if(a.options.snap){a.pagesX=[];while(g>=a.maxScrollX)a.pagesX[h]=g,g-=a.wrapperW,h++;a.maxScrollX%a.wrapperW&&(a.pagesX[a.pagesX.length]=a.maxScrollX-a.pagesX[a.pagesX.length-1]+a.pagesX[a.pagesX.length-1]),g=0,h=0,a.pagesY=[];while(g>=a.maxScrollY)a.pagesY[h]=g,g-=a.wrapperH,h++;a.maxScrollY%a.wrapperH&&(a.pagesY[a.pagesY.length]=a.maxScrollY-a.pagesY[a.pagesY.length-1]+a.pagesY[a.pagesY.length-1])}a._scrollbar("h"),a._scrollbar("v"),a.zoomed||(a.scroller.style[i]="0",a._resetPos(200))},scrollTo:function(a,b,c,d){var e=this,f=a,g,h;e.stop(),f.length||(f=[{x:a,y:b,time:c,relative:d}]);for(g=0,h=f.length;g<h;g++)f[g].relative&&(f[g].x=e.x-f[g].x,f[g].y=e.y-f[g].y),e.steps.push({x:f[g].x,y:f[g].y,time:f[g].time||0});e._startAni()},scrollToElement:function(a,b){var d=this,e;a=a.nodeType?a:d.scroller.querySelector(a);if(!a)return;e=d._offset(a),e.left+=d.wrapperOffsetLeft,e.top+=d.wrapperOffsetTop,e.left=e.left>0?0:e.left<d.maxScrollX?d.maxScrollX:e.left,e.top=e.top>d.minScrollY?d.minScrollY:e.top<d.maxScrollY?d.maxScrollY:e.top,b=b===undefined?c.max(c.abs(e.left)*2,c.abs(e.top)*2):b,d.scrollTo(e.left,e.top,b)},scrollToPage:function(a,b,c){var d=this,e,f;c=c===undefined?400:c,d.options.onScrollStart&&d.options.onScrollStart.call(d),d.options.snap?(a=a=="next"?d.currPageX+1:a=="prev"?d.currPageX-1:a,b=b=="next"?d.currPageY+1:b=="prev"?d.currPageY-1:b,a=a<0?0:a>d.pagesX.length-1?d.pagesX.length-1:a,b=b<0?0:b>d.pagesY.length-1?d.pagesY.length-1:b,d.currPageX=a,d.currPageY=b,e=d.pagesX[a],f=d.pagesY[b]):(e=-d.wrapperW*a,f=-d.wrapperH*b,e<d.maxScrollX&&(e=d.maxScrollX),f<d.maxScrollY&&(f=d.maxScrollY)),d.scrollTo(e,f,c)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(v),this._unbind(w),this._unbind(x)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind(z):B(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(a,b,c,d){var e=this,f=c/e.scale;if(!e.options.useTransform)return;e.zoomed=!0,d=d===undefined?200:d,a=a-e.wrapperOffsetLeft-e.x,b=b-e.wrapperOffsetTop-e.y,e.x=a-a*f+e.x,e.y=b-b*f+e.y,e.scale=c,e.refresh(),e.x=e.x>0?0:e.x<e.maxScrollX?e.maxScrollX:e.x,e.y=e.y>e.minScrollY?e.minScrollY:e.y<e.maxScrollY?e.maxScrollY:e.y,e.scroller.style[i]=d+"ms",e.scroller.style[g]="translate("+e.x+"px,"+e.y+"px) scale("+c+")"+C,e.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},d=null,typeof exports!="undefined"?exports.iScroll=D:a.iScroll=D}(window,document),window.iScroll}),define("joshfire-framework/vendor/zepto",[],function(){(function(a){String.prototype.trim===a&&(String.prototype.trim=function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}),Array.prototype.reduce===a&&(Array.prototype.reduce=function(b){if(this===void 0||this===null)throw new TypeError;var c=Object(this),d=c.length>>>0,e=0,f;if(typeof b!="function")throw new TypeError;if(d==0&&arguments.length==1)throw new TypeError;if(arguments.length>=2)f=arguments[1];else do{if(e in c){f=c[e++];break}if(++e>=d)throw new TypeError}while(!0);while(e<d)e in c&&(f=b.call(a,f,c[e],e,c)),e++;return f})})();var Zepto=function(){function A(a){return v.call(a)=="[object Function]"}function B(a){return a instanceof Object}function C(b){var c,d;if(v.call(b)!=="[object Object]")return!1;d=A(b.constructor)&&b.constructor.prototype;if(!d||!hasOwnProperty.call(d,"isPrototypeOf"))return!1;for(c in b);return c===a||hasOwnProperty.call(b,c)}function D(a){return a instanceof Array}function E(a){return typeof a.length=="number"}function F(b){return b.filter(function(b){return b!==a&&b!==null})}function G(a){return a.length>0?[].concat.apply([],a):a}function H(a){return a.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function I(a){return a in i?i[a]:i[a]=new RegExp("(^|\\s)"+a+"(\\s|$)")}function J(a,b){return typeof b=="number"&&!k[H(a)]?b+"px":b}function K(a){var b,c;return h[a]||(b=g.createElement(a),g.body.appendChild(b),c=j(b,"").getPropertyValue("display"),b.parentNode.removeChild(b),c=="none"&&(c="block"),h[a]=c),h[a]}function L(b,d){return d===a?c(b):c(b).filter(d)}function M(a,b,c,d){return A(b)?b.call(a,c,d):b}function N(a,b,d){var e=a%2?b:b.parentNode;e?e.insertBefore(d,a?a==1?e.firstChild:a==2?b:null:b.nextSibling):c(d).remove()}function O(a,b){b(a);for(var c in a.childNodes)O(a.childNodes[c],b)}function P(a){var b=a.innerHTML||"",c=a.getAttribute("src"),d=null,e=null;b?window.eval.call(window,b):c&&(d=g.getElementsByTagName("head")[0]||g.documentElement,e=g.createElement("script"),e.type="text/javascript",e.setAttribute("src",c),d.insertBefore(e,d.firstChild)),a.parentNode&&a.parentNode.removeChild(a)}var a,b,c,d,e=[],f=e.slice,g=window.document,h={},i={},j=g.defaultView.getComputedStyle,k={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},l=/^\s*<(\w+|!)[^>]*>/,m=[1,3,8,9,11],n=["after","prepend","before","append"],o=g.createElement("table"),p=g.createElement("tr"),q={tr:g.createElement("tbody"),tbody:o,thead:o,tfoot:o,td:p,th:p,"*":g.createElement("div")},r=/complete|loaded|interactive/,s=/^\.([\w-]+)$/,t=/^#([\w-]+)$/,u=/^[\w-]+$/,v={}.toString,w={},x,y,z=g.createElement("div");return w.matches=function(a,b){if(!a||a.nodeType!==1)return!1;var c=a.webkitMatchesSelector||a.mozMatchesSelector||a.oMatchesSelector||a.matchesSelector;if(c)return c.call(a,b);var d,e=a.parentNode,f=!e;return f&&(e=z).appendChild(a),d=~w.qsa(e,b).indexOf(a),f&&z.removeChild(a),d},x=function(a){return a.replace(/-+(.)?/g,function(a,b){return b?b.toUpperCase():""})},y=function(a){return a.filter(function(b,c){return a.indexOf(b)==c})},w.fragment=function(b,d){d===a&&(d=l.test(b)&&RegExp.$1),d in q||(d="*");var e=q[d];return e.innerHTML=""+b,c.each(f.call(e.childNodes),function(){e.removeChild(this)})},w.Z=function(a,b){return a=a||[],a.__proto__=arguments.callee.prototype,a.selector=b||"",a},w.isZ=function(a){return a instanceof w.Z},w.init=function(b,d){if(!b)return w.Z();if(A(b))return c(g).ready(b);if(w.isZ(b))return b;var e;if(D(b))e=F(b);else if(C(b))e=[c.extend({},b)],b=null;else if(m.indexOf(b.nodeType)>=0||b===window)e=[b],b=null;else if(l.test(b))e=w.fragment(b.trim(),RegExp.$1),b=null;else{if(d!==a)return c(d).find(b);e=w.qsa(g,b)}return w.Z(e,b)},c=function(a,b){return w.init(a,b)},c.extend=function(c){return f.call(arguments,1).forEach(function(d){for(b in d)d[b]!==a&&(c[b]=d[b])}),c},w.qsa=function(a,b){var c;return a===g&&t.test(b)?(c=a.getElementById(RegExp.$1))?[c]:e:a.nodeType!==1&&a.nodeType!==9?e:f.call(s.test(b)?a.getElementsByClassName(RegExp.$1):u.test(b)?a.getElementsByTagName(b):a.querySelectorAll(b))},c.isFunction=A,c.isObject=B,c.isArray=D,c.isPlainObject=C,c.inArray=function(a,b,c){return e.indexOf.call(b,a,c)},c.trim=function(a){return a.trim()},c.uuid=0,c.map=function(a,b){var c,d=[],e,f;if(E(a))for(e=0;e<a.length;e++)c=b(a[e],e),c!=null&&d.push(c);else for(f in a)c=b(a[f],f),c!=null&&d.push(c);return G(d)},c.each=function(a,b){var c,d;if(E(a)){for(c=0;c<a.length;c++)if(b.call(a[c],c,a[c])===!1)return a}else for(d in a)if(b.call(a[d],d,a[d])===!1)return a;return a},c.fn={forEach:e.forEach,reduce:e.reduce,push:e.push,indexOf:e.indexOf,concat:e.concat,map:function(a){return c.map(this,function(b,c){return a.call(b,c,b)})},slice:function(){return c(f.apply(this,arguments))},ready:function(a){return r.test(g.readyState)?a(c):g.addEventListener("DOMContentLoaded",function(){a(c)},!1),this},get:function(b){return b===a?f.call(this):this[b]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){this.parentNode!=null&&this.parentNode.removeChild(this)})},each:function(a){return this.forEach(function(b,c){a.call(b,c,b)}),this},filter:function(a){return c([].filter.call(this,function(b){return w.matches(b,a)}))},add:function(a,b){return c(y(this.concat(c(a,b))))},is:function(a){return this.length>0&&w.matches(this[0],a)},not:function(b){var d=[];if(A(b)&&b.call!==a)this.each(function(a){b.call(this,a)||d.push(this)});else{var e=typeof b=="string"?this.filter(b):E(b)&&A(b.item)?f.call(b):c(b);this.forEach(function(a){e.indexOf(a)<0&&d.push(a)})}return c(d)},eq:function(a){return a===-1?this.slice(a):this.slice(a,+a+1)},first:function(){var a=this[0];return a&&!B(a)?a:c(a)},last:function(){var a=this[this.length-1];return a&&!B(a)?a:c(a)},find:function(a){var b;return this.length==1?b=w.qsa(this[0],a):b=this.map(function(){return w.qsa(this,a)}),c(b)},closest:function(a,b){var d=this[0];while(d&&!w.matches(d,a))d=d!==b&&d!==g&&d.parentNode;return c(d)},parents:function(a){var b=[],d=this;while(d.length>0)d=c.map(d,function(a){if((a=a.parentNode)&&a!==g&&b.indexOf(a)<0)return b.push(a),a});return L(b,a)},parent:function(a){return L(y(this.pluck("parentNode")),a)},children:function(a){return L(this.map(function(){return f.call(this.children)}),a)},siblings:function(a){return L(this.map(function(a,b){return f.call(b.parentNode.children).filter(function(a){return a!==b})}),a)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(a){return this.map(function(){return this[a]})},show:function(){return this.each(function(){this.style.display=="none"&&(this.style.display=null),j(this,"").getPropertyValue("display")=="none"&&(this.style.display=K(this.nodeName))})},replaceWith:function(a){return this.before(a).remove()},wrap:function(a){return this.each(function(){c(this).wrapAll(c(a)[0].cloneNode(!1))})},wrapAll:function(a){return this[0]&&(c(this[0]).before(a=c(a)),a.append(this)),this},unwrap:function(){return this.parent().each(function(){c(this).replaceWith(c(this).children())}),this},clone:function(){return c(this.map(function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(b){return(b===a?this.css("display")=="none":b)?this.show():this.hide()},prev:function(){return c(this.pluck("previousElementSibling"))},next:function(){return c(this.pluck("nextElementSibling"))},html:function(b){return b===a?this.length>0?this[0].innerHTML:null:this.each(function(a){var d=this.innerHTML;c(this).empty().append(M(this,b,a,d))})},text:function(b){return b===a?this.length>0?this[0].textContent:null:this.each(function(){this.textContent=b})},attr:function(c,d){var e;return typeof c=="string"&&d===a?this.length==0||this[0].nodeType!==1?a:c=="value"&&this[0].nodeName=="INPUT"?this.val():!(e=this[0].getAttribute(c))&&c in this[0]?this[0][c]:e:this.each(function(a){if(this.nodeType!==1)return;if(B(c))for(b in c)this.setAttribute(b,c[b]);else this.setAttribute(c,M(this,d,a,this.getAttribute(c)))})},removeAttr:function(a){return this.each(function(){this.nodeType===1&&this.removeAttribute(a)})},prop:function(b,c){return c===a?this[0]?this[0][b]:a:this.each(function(a){this[b]=M(this,c,a,this[b])})},data:function(b,c){var d=this.attr("data-"+H(b),c);return d!==null?d:a},val:function(b){return b===a?this.length>0?this[0].value:a:this.each(function(a){this.value=M(this,b,a,this.value)})},offset:function(){if(this.length==0)return null;var a=this[0].getBoundingClientRect();return{left:a.left+window.pageXOffset,top:a.top+window.pageYOffset,width:a.width,height:a.height}},css:function(c,d){if(d===a&&typeof c=="string")return this.length==0?a:this[0].style[x(c)]||j(this[0],"").getPropertyValue(c);var e="";for(b in c)typeof c[b]=="string"&&c[b]==""?this.each(function(){this.style.removeProperty(H(b))}):e+=H(b)+":"+J(b,c[b])+";";return typeof c=="string"&&(d==""?this.each(function(){this.style.removeProperty(H(c))}):e=H(c)+":"+J(c,d)),this.each(function(){this.style.cssText+=";"+e})},index:function(a){return a?this.indexOf(c(a)[0]):this.parent().children().indexOf(this[0])},hasClass:function(a){return this.length<1?!1:I(a).test(this[0].className)},addClass:function(a){return this.each(function(b){d=[];var e=this.className,f=M(this,a,b,e);f.split(/\s+/g).forEach(function(a){c(this).hasClass(a)||d.push(a)},this),d.length&&(this.className+=(e?" ":"")+d.join(" "))})},removeClass:function(b){return this.each(function(c){if(b===a)return this.className="";d=this.className,M(this,b,c,d).split(/\s+/g).forEach(function(a){d=d.replace(I(a)," ")}),this.className=d.trim()})},toggleClass:function(b,d){return this.each(function(e){var f=M(this,b,e,this.className);(d===a?!c(this).hasClass(f):d)?c(this).addClass(f):c(this).removeClass(f)})}},["width","height"].forEach(function(b){c.fn[b]=function(d){var e,f=b.replace(/./,function(a){return a[0].toUpperCase()});return d===a?this[0]==window?window["inner"+f]:this[0]==g?g.documentElement["offset"+f]:(e=this.offset())&&e[b]:this.each(function(a){var e=c(this);e.css(b,M(this,d,a,e[b]()))})}}),n.forEach(function(a,b){c.fn[a]=function(){var a=c.map(arguments,function(a){return B(a)?a:w.fragment(a)});if(a.length<1)return this;var d=this.length,e=d>1,f=b<2;return this.each(function(c,g){for(var h=0;h<a.length;h++){var i=a[f?a.length-h-1:h];O(i,function(a){a.nodeName!=null&&a.nodeName.toUpperCase()==="SCRIPT"&&(!a.type||a.type==="text/javascript")&&P(a)}),e&&c<d-1&&(i=i.cloneNode(!0)),N(b,g,i)}})},c.fn[b%2?a+"To":"insert"+(b?"Before":"After")]=function(b){return c(b)[a](this),this}}),w.Z.prototype=c.fn,w.camelize=x,w.uniq=y,c.zepto=w,c}();return window.Zepto=Zepto,"$"in window||(window.$=Zepto),function(a){function f(a){return a._zid||(a._zid=d++)}function g(a,b,d,e){b=h(b);if(b.ns)var g=i(b.ns);return(c[f(a)]||[]).filter(function(a){return a&&(!b.e||a.e==b.e)&&(!b.ns||g.test(a.ns))&&(!d||f(a.fn)===f(d))&&(!e||a.sel==e)})}function h(a){var b=(""+a).split(".");return{e:b[0],ns:b.slice(1).sort().join(" ")}}function i(a){return new RegExp("(?:^| )"+a.replace(" "," .* ?")+"(?: |$)")}function j(b,c,d){a.isObject(b)?a.each(b,d):b.split(/\s/).forEach(function(a){d(a,c)})}function k(b,d,e,g,i,k){k=!!k;var l=f(b),m=c[l]||(c[l]=[]);j(d,e,function(c,d){var e=i&&i(d,c),f=e||d,j=function(a){var c=f.apply(b,[a].concat(a.data));return c===!1&&a.preventDefault(),c},l=a.extend(h(c),{fn:d,proxy:j,sel:g,del:e,i:m.length});m.push(l),b.addEventListener(l.e,j,k)})}function l(a,b,d,e){var h=f(a);j(b||"",d,function(b,d){g(a,b,d,e).forEach(function(b){delete c[h][b.i],a.removeEventListener(b.e,b.proxy,!1)})})}function p(b){var c=a.extend({originalEvent:b},b);return a.each(o,function(a,d){c[a]=function(){return this[d]=m,b[a].apply(b,arguments)},c[d]=n}),c}function q(a){if(!("defaultPrevented"in a)){a.defaultPrevented=!1;var b=a.preventDefault;a.preventDefault=function(){this.defaultPrevented=!0,b.call(this)}}}var b=a.zepto.qsa,c={},d=1,e={};e.click=e.mousedown=e.mouseup=e.mousemove="MouseEvents",a.event={add:k,remove:l},a.proxy=function(b,c){if(a.isFunction(b)){var d=function(){return b.apply(c,arguments)};return d._zid=f(b),d}if(typeof c=="string")return a.proxy(b[c],b);throw new TypeError("expected function")},a.fn.bind=function(a,b){return this.each(function(){k(this,a,b)})},a.fn.unbind=function(a,b){return this.each(function(){l(this,a,b)})},a.fn.one=function(a,b){return this.each(function(c,d){k(this,a,b,null,function(a,b){return function(){var c=a.apply(d,arguments);return l(d,b,a),c}})})};var m=function(){return!0},n=function(){return!1},o={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};a.fn.delegate=function(b,c,d){var e=!1;if(c=="blur"||c=="focus")a.iswebkit?c=c=="blur"?"focusout":c=="focus"?"focusin":c:e=!0;return this.each(function(f,g){k(g,c,d,b,function(c){return function(d){var e,f=a(d.target).closest(b,g).get(0);if(f)return e=a.extend(p(d),{currentTarget:f,liveFired:g}),c.apply(f,[e].concat([].slice.call(arguments,1)))}},e)})},a.fn.undelegate=function(a,b,c){return this.each(function(){l(this,b,c,a)})},a.fn.live=function(b,c){return a(document.body).delegate(this.selector,b,c),this},a.fn.die=function(b,c){return a(document.body).undelegate(this.selector,b,c),this},a.fn.on=function(b,c,d){return c==undefined||a.isFunction(c)?this.bind(b,c):this.delegate(c,b,d)},a.fn.off=function(b,c,d){return c==undefined||a.isFunction(c)?this.unbind(b,c):this.undelegate(c,b,d)},a.fn.trigger=function(b,c){return typeof b=="string"&&(b=a.Event(b)),q(b),b.data=c,this.each(function(){"dispatchEvent"in this&&this.dispatchEvent(b)})},a.fn.triggerHandler=function(b,c){var d,e;return this.each(function(f,h){d=p(typeof b=="string"?a.Event(b):b),d.data=c,d.target=h,a.each(g(h,b.type||b),function(a,b){e=b.proxy(d);if(d.isImmediatePropagationStopped())return!1})}),e},"focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout change select keydown keypress keyup error".split(" ").forEach(function(b){a.fn[b]=function(a){return this.bind(b,a)}}),["focus","blur"].forEach(function(b){a.fn[b]=function(a){if(a)this.bind(b,a);else if(this.length)try{this.get(0)[b]()}catch(c){}return this}}),a.Event=function(a,b){var c=document.createEvent(e[a]||"Events"),d=!0;if(b)for(var f in b)f=="bubbles"?d=!!b[f]:c[f]=b[f];return c.initEvent(a,d,!0,null,null,null,null,null,null,null,null,null,null,null,null),c}}(Zepto),function(a){function b(a){var b=this.os={},c=this.browser={},d=a.match(/WebKit\/([\d.]+)/),e=a.match(/(Android)\s+([\d.]+)/),f=a.match(/(iPad).*OS\s([\d_]+)/),g=!f&&a.match(/(iPhone\sOS)\s([\d_]+)/),h=a.match(/(webOS|hpwOS)[\s\/]([\d.]+)/),i=h&&a.match(/TouchPad/),j=a.match(/Kindle\/([\d.]+)/),k=a.match(/Silk\/([\d._]+)/),l=a.match(/(BlackBerry).*Version\/([\d.]+)/);if(c.webkit=!!d)c.version=d[1];e&&(b.android=!0,b.version=e[2]),g&&(b.ios=b.iphone=!0,b.version=g[2].replace(/_/g,".")),f&&(b.ios=b.ipad=!0,b.version=f[2].replace(/_/g,".")),h&&(b.webos=!0,b.version=h[2]),i&&(b.touchpad=!0),l&&(b.blackberry=!0,b.version=l[2]),j&&(b.kindle=!0,b.version=j[1]),k&&(c.silk=!0,c.version=k[1]),!k&&b.android&&a.match(/Kindle Fire/)&&(c.silk=!0)}b.call(a,navigator.userAgent),a.__detect=b}(Zepto),function(a,b){function l(a){return a.toLowerCase()}function m(a){return d?d+a:l(a)}var c="",d,e,f,g={Webkit:"webkit",Moz:"",O:"o",ms:"MS"},h=window.document,i=h.createElement("div"),j=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,k={};a.each(g,function(a,e){if(i.style[a+"TransitionProperty"]!==b)return c="-"+l(a)+"-",d=e,!1}),k[c+"transition-property"]=k[c+"transition-duration"]=k[c+"transition-timing-function"]=k[c+"animation-name"]=k[c+"animation-duration"]="",a.fx={off:d===b&&i.style.transitionProperty===b,cssPrefix:c,transitionEnd:m("TransitionEnd"),animationEnd:m("AnimationEnd")},a.fn.animate=function(b,c,d,e){return a.isObject(c)&&(d=c.easing,e=c.complete,c=c.duration),c&&(c/=1e3),this.anim(b,c,d,e)},a.fn.anim=function(d,e,f,g){var h,i={},l,m=this,n,o=a.fx.transitionEnd;e===b&&(e=.4),a.fx.off&&(e=0);if(typeof d=="string")i[c+"animation-name"]=d,i[c+"animation-duration"]=e+"s",o=a.fx.animationEnd;else{for(l in d)j.test(l)?(h||(h=[]),h.push(l+"("+d[l]+")")):i[l]=d[l];h&&(i[c+"transform"]=h.join(" ")),!a.fx.off&&typeof d=="object"&&(i[c+"transition-property"]=Object.keys(d).join(", "),i[c+"transition-duration"]=e+"s",i[c+"transition-timing-function"]=f||"linear")}return n=function(b){if(typeof b!="undefined"){if(b.target!==b.currentTarget)return;a(b.target).unbind(o,arguments.callee)}a(this).css(k),g&&g.call(this)},e>0&&this.bind(o,n),setTimeout(function(){m.css(i),e<=0&&setTimeout(function(){m.each(function(){n.call(this)})},0)},0),this},i=null}(Zepto),function($){function triggerAndReturn(a,b,c){var d=$.Event(b);return $(a).trigger(d,c),!d.defaultPrevented}function triggerGlobal(a,b,c,d){if(a.global)return triggerAndReturn(b||document,c,d)}function ajaxStart(a){a.global&&$.active++===0&&triggerGlobal(a,null,"ajaxStart")}function ajaxStop(a){a.global&&!--$.active&&triggerGlobal(a,null,"ajaxStop")}function ajaxBeforeSend(a,b){var c=b.context;if(b.beforeSend.call(c,a,b)===!1||triggerGlobal(b,c,"ajaxBeforeSend",[a,b])===!1)return!1;triggerGlobal(b,c,"ajaxSend",[a,b])}function ajaxSuccess(a,b,c){var d=c.context,e="success";c.success.call(d,a,e,b),triggerGlobal(c,d,"ajaxSuccess",[b,c,a]),ajaxComplete(e,b,c)}function ajaxError(a,b,c,d){var e=d.context;d.error.call(e,c,b,a),triggerGlobal(d,e,"ajaxError",[c,d,a]),ajaxComplete(b,c,d)}function ajaxComplete(a,b,c){var d=c.context;c.complete.call(d,b,a),triggerGlobal(c,d,"ajaxComplete",[b,c]),ajaxStop(c)}function empty(){}function mimeToDataType(a){return a&&(a==htmlType?"html":a==jsonType?"json":scriptTypeRE.test(a)?"script":xmlTypeRE.test(a)&&"xml")||"text"}function appendQuery(a,b){return(a+"&"+b).replace(/[&?]{1,2}/,"?")}function serializeData(a){isObject(a.data)&&(!a.contentType||a.contentType==="application/x-www-form-urlencoded"?a.data=$.param(a.data):a.contentType==="application/json"&&(a.data=JSON.stringify(a.data))),a.data&&(!a.type||a.type.toUpperCase()=="GET")&&(a.url=appendQuery(a.url,a.data))}function serialize(a,b,c,d){var e=$.isArray(b);$.each(b,function(b,f){d&&(b=c?d:d+"["+(e?"":b)+"]"),!d&&e?a.add(f.name,f.value):(c?$.isArray(f):isObject(f))?serialize(a,f,c,b):a.add(b,f)})}var jsonpID=0,isObject=$.isObject,document=window.document,key,name,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,scriptTypeRE=/^(?:text|application)\/javascript/i,xmlTypeRE=/^(?:text|application)\/xml/i,jsonType="application/json",htmlType="text/html",blankRE=/^\s*$/;$.active=0,$.ajaxJSONP=function(a){var b="jsonp"+ ++jsonpID,c=document.createElement("script"),d=function(){$(c).remove(),b in window&&(window[b]=empty),ajaxComplete("abort",e,a)},e={abort:d},f;return a.error&&(c.onerror=function(){e.abort(),a.error()}),window[b]=function(d){clearTimeout(f),$(c).remove(),delete window[b],ajaxSuccess(d,e,a)},serializeData(a),c.src=a.url.replace(/=\?/,"="+b),$("head").append(c),a.timeout>0&&(f=setTimeout(function(){e.abort(),ajaxComplete("timeout",e,a)},a.timeout)),e},$.ajaxSettings={type:"GET",beforeSend:empty,success:empty,error:empty,complete:empty,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript",json:jsonType,xml:"application/xml, text/xml",html:htmlType,text:"text/plain"},crossDomain:!1,timeout:0},$.ajax=function(options){var settings=$.extend({},options||{});for(key in $.ajaxSettings)settings[key]===undefined&&(settings[key]=$.ajaxSettings[key]);ajaxStart(settings),settings.crossDomain||(settings.crossDomain=/^([\w-]+:)?\/\/([^\/]+)/.test(settings.url)&&RegExp.$2!=window.location.host);var dataType=settings.dataType,hasPlaceholder=/=\?/.test(settings.url);if(dataType=="jsonp"||hasPlaceholder)return hasPlaceholder||(settings.url=appendQuery(settings.url,"callback=?")),$.ajaxJSONP(settings);settings.url||(settings.url=window.location.toString()),serializeData(settings);var mime=settings.accepts[dataType],baseHeaders={},protocol=/^([\w-]+:)\/\//.test(settings.url)?RegExp.$1:window.location.protocol,xhr=$.ajaxSettings.xhr(),abortTimeout;settings.crossDomain||(baseHeaders["X-Requested-With"]="XMLHttpRequest"),mime&&(baseHeaders.Accept=mime,mime.indexOf(",")>-1&&(mime=mime.split(",",2)[0]),xhr.overrideMimeType&&xhr.overrideMimeType(mime));if(settings.xhrFields)for(var i in settings.xhrFields)xhr[i]=settings.xhrFields[i];if(settings.contentType||settings.data&&settings.type.toUpperCase()!="GET")baseHeaders["Content-Type"]=settings.contentType||"application/x-www-form-urlencoded";settings.headers=$.extend(baseHeaders,settings.headers||{}),xhr.onreadystatechange=function(){if(xhr.readyState==4){clearTimeout(abortTimeout);var result,error=!1;if(xhr.status>=200&&xhr.status<300||xhr.status==304||xhr.status==0&&protocol=="file:"){dataType=dataType||mimeToDataType(xhr.getResponseHeader("content-type")),result=xhr.responseText;try{dataType=="script"?(1,eval)(result):dataType=="xml"?result=xhr.responseXML:dataType=="json"&&(result=blankRE.test(result)?null:JSON.parse(result))}catch(e){error=e}error?ajaxError(error,"parsererror",xhr,settings):ajaxSuccess(result,xhr,settings)}else ajaxError(null,"error",xhr,settings)}};var async="async"in settings?settings.async:!0;xhr.open(settings.type,settings.url,async);for(name in settings.headers)xhr.setRequestHeader(name,settings.headers[name]);return ajaxBeforeSend(xhr,settings)===!1?(xhr.abort(),!1):(settings.timeout>0&&(abortTimeout=setTimeout(function(){xhr.onreadystatechange=empty,xhr.abort(),ajaxError(null,"timeout",xhr,settings)},settings.timeout)),xhr.send(settings.data?settings.data:null),xhr)},$.get=function(a,b){return $.ajax({url:a,success:b})},$.post=function(a,b,c,d){return $.isFunction(b)&&(d=d||c,c=b,b=null),$.ajax({type:"POST",url:a,data:b,success:c,dataType:d})},$.getJSON=function(a,b){return $.ajax({url:a,success:b,dataType:"json"})},$.fn.load=function(a,b){if(!this.length)return this;var c=this,d=a.split(/\s/),e;return d.length>1&&(a=d[0],e=d[1]),$.get(a,function(a){c.html(e?$(document.createElement("div")).html(a.replace(rscript,"")).find(e).html():a),b&&b.call(c)}),this};var escape=encodeURIComponent;$.param=function(a,b){var c=[];return c.add=function(a,b){this.push(escape(a)+"="+escape(b))},serialize(c,a,b),c.join("&").replace("%20","+")}}(Zepto),function(a){a.fn.serializeArray=function(){var b=[],c;return a(Array.prototype.slice.call(this.get(0).elements)).each(function(){c=a(this);var d=c.attr("type");this.nodeName.toLowerCase()!="fieldset"&&!this.disabled&&d!="submit"&&d!="reset"&&d!="button"&&(d!="radio"&&d!="checkbox"||this.checked)&&b.push({name:c.attr("name"),value:c.val()})}),b},a.fn.serialize=function(){var a=[];return this.serializeArray().forEach(function(b){a.push(encodeURIComponent(b.name)+"="+encodeURIComponent(b.value))}),a.join("&")},a.fn.submit=function(b){if(b)this.bind("submit",b);else if(this.length){var c=a.Event("submit");this.eq(0).trigger(c),c.defaultPrevented||this.get(0).submit()}return this}}(Zepto),function(a){function d(a){return"tagName"in a?a:a.parentNode}function e(a,b,c,d){var e=Math.abs(a-b),f=Math.abs(c-d);return e>=f?a-b>0?"Left":"Right":c-d>0?"Up":"Down"}function h(){g=null,b.last&&(b.el.trigger("longTap"),b={})}function i(){g&&clearTimeout(g),g=null}var b={},c,f=750,g;a(document).ready(function(){var j,k;a(document.body).bind("touchstart",function(e){j=Date.now(),k=j-(b.last||j),b.el=a(d(e.touches[0].target)),c&&clearTimeout(c),b.x1=e.touches[0].pageX,b.y1=e.touches[0].pageY,k>0&&k<=250&&(b.isDoubleTap=!0),b.last=j,g=setTimeout(h,f)}).bind("touchmove",function(a){i(),b.x2=a.touches[0].pageX,b.y2=a.touches[0].pageY}).bind("touchend",function(a){i(),b.isDoubleTap?(b.el.trigger("doubleTap"),b={}):b.x2&&Math.abs(b.x1-b.x2)>30||b.y2&&Math.abs(b.y1-b.y2)>30?(b.el.trigger("swipe")&&b.el.trigger("swipe"+e(b.x1,b.x2,b.y1,b.y2)),b={}):"last"in b&&(b.el.trigger("tap"),c=setTimeout(function(){c=null,b.el.trigger("singleTap"),b={}},250))}).bind("touchcancel",function(){c&&clearTimeout(c),g&&clearTimeout(g),g=c=null,b={}})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(b){a.fn[b]=function(a){return this.bind(b,a)}})}(Zepto),Zepto}),define("joshfire-framework/adapters/phone/utils/dollar",["joshlib!vendor/zepto"],function(a){return a}),define("joshfire-framework/vendor/underscore",[],function(){return function(){function A(a,b,c){if(a===b)return a!==0||1/a==1/b;if(a==null||b==null)return a===b;a._chain&&(a=a._wrapped),b._chain&&(b=b._wrapped);if(a.isEqual&&w.isFunction(a.isEqual))return a.isEqual(b);if(b.isEqual&&w.isFunction(b.isEqual))return b.isEqual(a);var d=i.call(a);if(d!=i.call(b))return!1;switch(d){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:a==0?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if(typeof a!="object"||typeof b!="object")return!1;var e=c.length;while(e--)if(c[e]==a)return!0;c.push(a);var f=0,g=!0;if(d=="[object Array]"){f=a.length,g=f==b.length;if(g)while(f--)if(!(g=f in a==f in b&&A(a[f],b[f],c)))break}else{if("constructor"in a!="constructor"in b||a.constructor!=b.constructor)return!1;for(var h in a)if(w.has(a,h)){f++;if(!(g=w.has(b,h)&&A(a[h],b[h],c)))break}if(g){for(h in b)if(w.has(b,h)&&!(f--))break;g=!f}}return c.pop(),g}var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.slice,h=d.unshift,i=e.toString,j=e.hasOwnProperty,k=d.forEach,l=d.map,m=d.reduce,n=d.reduceRight,o=d.filter,p=d.every,q=d.some,r=d.indexOf,s=d.lastIndexOf,t=Array.isArray,u=Object.keys,v=f.bind,w=function(a){return new I(a)};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=w),exports._=w):a._=w,w.VERSION="1.3.3";var x=w.each=w.forEach=function(a,b,d){if(a==null)return;if(k&&a.forEach===k)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;e<f;e++)if(e in a&&b.call(d,a[e],e,a)===c)return}else for(var g in a)if(w.has(a,g)&&b.call(d,a[g],g,a)===c)return};w.map=w.collect=function(a,b,c){var d=[];return a==null?d:l&&a.map===l?a.map(b,c):(x(a,function(a,e,f){d[d.length]=b.call(c,a,e,f)}),a.length===+a.length&&(d.length=a.length),d)},w.reduce=w.foldl=w.inject=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(m&&a.reduce===m)return d&&(b=w.bind(b,d)),e?a.reduce(b,c):a.reduce(b);x(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c},w.reduceRight=w.foldr=function(a,b,c,d){var e=arguments.length>2;a==null&&(a=[]);if(n&&a.reduceRight===n)return d&&(b=w.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=w.toArray(a).reverse();return d&&!e&&(b=w.bind(b,d)),e?w.reduce(f,b,c,d):w.reduce(f,b)},w.find=w.detect=function(a,b,c){var d;return y(a,function(a,e,f){if(b.call(c,a,e,f))return d=a,!0}),d},w.filter=w.select=function(a,b,c){var d=[];return a==null?d:o&&a.filter===o?a.filter(b,c):(x(a,function(a,e,f){b.call(c,a,e,f)&&(d[d.length]=a)}),d)},w.reject=function(a,b,c){var d=[];return a==null?d:(x(a,function(a,e,f){b.call(c,a,e,f)||(d[d.length]=a)}),d)},w.every=w.all=function(a,b,d){var e=!0;return a==null?e:p&&a.every===p?a.every(b,d):(x(a,function(a,f,g){if(!(e=e&&b.call(d,a,f,g)))return c}),!!e)};var y=w.some=w.any=function(a,b,d){b||(b=w.identity);var e=!1;return a==null?e:q&&a.some===q?a.some(b,d):(x(a,function(a,f,g){if(e||(e=b.call(d,a,f,g)))return c}),!!e)};w.include=w.contains=function(a,b){var c=!1;return a==null?c:r&&a.indexOf===r?a.indexOf(b)!=-1:(c=y(a,function(a){return a===b}),c)},w.invoke=function(a,b){var c=g.call(arguments,2);return w.map(a,function(a){return(w.isFunction(b)?b||a:a[b]).apply(a,c)})},w.pluck=function(a,b){return w.map(a,function(a){return a[b]})},w.max=function(a,b,c){if(!b&&w.isArray(a)&&a[0]===+a[0])return Math.max.apply(Math,a);if(!b&&w.isEmpty(a))return-Infinity;var d={computed:-Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>=d.computed&&(d={value:a,computed:g})}),d.value},w.min=function(a,b,c){if(!b&&w.isArray(a)&&a[0]===+a[0])return Math.min.apply(Math,a);if(!b&&w.isEmpty(a))return Infinity;var d={computed:Infinity};return x(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},w.shuffle=function(a){var b=[],c;return x(a,function(a,d,e){c=Math.floor(Math.random()*(d+1)),b[d]=b[c],b[c]=a}),b},w.sortBy=function(a,b,c){var d=w.isFunction(b)?b:function(a){return a[b]};return w.pluck(w.map(a,function(a,b,e){return{value:a,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;return c===void 0?1:d===void 0?-1:c<d?-1:c>d?1:0}),"value")},w.groupBy=function(a,b){var c={},d=w.isFunction(b)?b:function(a){return a[b]};return x(a,function(a,b){var e=d(a,b);(c[e]||(c[e]=[])).push(a)}),c},w.sortedIndex=function(a,b,c){c||(c=w.identity);var d=0,e=a.length;while(d<e){var f=d+e>>1;c(a[f])<c(b)?d=f+1:e=f}return d},w.toArray=function(a){return a?w.isArray(a)?g.call(a):w.isArguments(a)?g.call(a):a.toArray&&w.isFunction(a.toArray)?a.toArray():w.values(a):[]},w.size=function(a){return w.isArray(a)?a.length:w.keys(a).length},w.first=w.head=w.take=function(a,b,c){return b!=null&&!c?g.call(a,0,b):a[0]},w.initial=function(a,b,c){return g.call(a,0,a.length-(b==null||c?1:b))},w.last=function(a,b,c){return b!=null&&!c?g.call(a,Math.max(a.length-b,0)):a[a.length-1]},w.rest=w.tail=function(a,b,c){return g.call(a,b==null||c?1:b)},w.compact=function(a){return w.filter(a,function(a){return!!a})},w.flatten=function(a,b){return w.reduce(a,function(a,c){return w.isArray(c)?a.concat(b?c:w.flatten(c)):(a[a.length]=c,a)},[])},w.without=function(a){return w.difference(a,g.call(arguments,1))},w.uniq=w.unique=function(a,b,c){var d=c?w.map(a,c):a,e=[];return a.length<3&&(b=!0),w.reduce(d,function(c,d,f){if(b?w.last(c)!==d||!c.length:!w.include(c,d))c.push(d),e.push(a[f]);return c},[]),e},w.union=function(){return w.uniq(w.flatten(arguments,!0))},w.intersection=w.intersect=function(a){var b=g.call(arguments,1);return w.filter(w.uniq(a),function(a){return w.every(b,function(b){return w.indexOf(b,a)>=0})})},w.difference=function(a){var b=w.flatten(g.call(arguments,1),!0);return w.filter(a,function(a){return!w.include(b,a)})},w.zip=function(){var a=g.call(arguments),b=w.max(w.pluck(a,"length")),c=new Array(b);for(var d=0;d<b;d++)c[d]=w.pluck(a,""+d);return c},w.indexOf=function(a,b,c){if(a==null)return-1;var d,e;if(c)return d=w.sortedIndex(a,b),a[d]===b?d:-1;if(r&&a.indexOf===r)return a.indexOf(b);for(d=0,e=a.length;d<e;d++)if(d in a&&a[d]===b)return d;return-1},w.lastIndexOf=function(a,b){if(a==null)return-1;if(s&&a.lastIndexOf===s)return a.lastIndexOf(b);var c=a.length;while(c--)if(c in a&&a[c]===b)return c;return-1},w.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);while(e<d)f[e++]=a,a+=c;return f};var z=function(){};w.bind=function(b,c){var d,e;if(b.bind===v&&v)return v.apply(b,g.call(arguments,1));if(!w.isFunction(b))throw new TypeError;return e=g.call(arguments,2),d=function(){if(this instanceof d){z.prototype=b.prototype;var a=new z,f=b.apply(a,e.concat(g.call(arguments)));return Object(f)===f?f:a}return b.apply(c,e.concat(g.call(arguments)))}},w.bindAll=function(a){var b=g.call(arguments,1);return b.length==0&&(b=w.functions(a)),x(b,function(b){a[b]=w.bind(a[b],a)}),a},w.memoize=function(a,b){var c={};return b||(b=w.identity),function(){var d=b.apply(this,arguments);return w.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},w.delay=function(a,b){var c=g.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},w.defer=function(a){return w.delay.apply(w,[a,1].concat(g.call(arguments,1)))},w.throttle=function(a,b){var c,d,e,f,g,h,i=w.debounce(function(){g=f=!1},b);return function(){c=this,d=arguments;var j=function(){e=null,g&&a.apply(c,d),i()};return e||(e=setTimeout(j,b)),f?g=!0:h=a.apply(c,d),i(),f=!0,h}},w.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)};c&&!d&&a.apply(e,f),clearTimeout(d),d=setTimeout(g,b)}},w.once=function(a){var b=!1,c;return function(){return b?c:(b=!0,c=a.apply(this,arguments))}},w.wrap=function(a,b){return function(){var c=[a].concat(g.call(arguments,0));return b.apply(this,c)}},w.compose=function(){var a=arguments;return function(){var b=arguments;for(var c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},w.after=function(a,b){return a<=0?b():function(){if(--a<1)return b.apply(this,arguments)}},w.keys=u||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)w.has(a,c)&&(b[b.length]=c);return b},w.values=function(a){return w.map(a,w.identity)},w.functions=w.methods=function(a){var b=[];for(var c in a)w.isFunction(a[c])&&b.push(c);return b.sort()},w.extend=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]=b[c]}),a},w.pick=function(a){var b={};return x(w.flatten(g.call(arguments,1)),function(c){c in a&&(b[c]=a[c])}),b},w.defaults=function(a){return x(g.call(arguments,1),function(b){for(var c in b)a[c]==null&&(a[c]=b[c])}),a},w.clone=function(a){return w.isObject(a)?w.isArray(a)?a.slice():w.extend({},a):a},w.tap=function(a,b){return b(a),a},w.isEqual=function(a,b){return A(a,b,[])},w.isEmpty=function(a){if(a==null)return!0;if(w.isArray(a)||w.isString(a))return a.length===0;for(var b in a)if(w.has(a,b))return!1;return!0},w.isElement=function(a){return!!a&&a.nodeType==1},w.isArray=t||function(a){return i.call(a)=="[object Array]"},w.isObject=function(a){return a===Object(a)},w.isArguments=function(a){return i.call(a)=="[object Arguments]"},w.isArguments(arguments)||(w.isArguments=function(a){return!!a&&!!w.has(a,"callee")}),w.isFunction=function(a){return i.call(a)=="[object Function]"},w.isString=function(a){return i.call(a)=="[object String]"},w.isNumber=function(a){return i.call(a)=="[object Number]"},w.isFinite=function(a){return w.isNumber(a)&&isFinite(a)},w.isNaN=function(a){return a!==a},w.isBoolean=function(a){return a===!0||a===!1||i.call(a)=="[object Boolean]"},w.isDate=function(a){return i.call(a)=="[object Date]"},w.isRegExp=function(a){return i.call(a)=="[object RegExp]"},w.isNull=function(a){return a===null},w.isUndefined=function(a){return a===void 0},w.has=function(a,b){return j.call(a,b)},w.noConflict=function(){return a._=b,this},w.identity=function(a){return a},w.times=function(a,b,c){for(var d=0;d<a;d++)b.call(c,d)},w.escape=function(a){return(""+a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")},w.result=function(a,b){if(a==null)return null;var c=a[b];return w.isFunction(c)?c.call(a):c},w.mixin=function(a){x(w.functions(a),function(b){K(b,w[b]=a[b])})};var B=0;w.uniqueId=function(a){var b=B++;return a?a+b:b},w.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var C=/.^/,D={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};for(var E in D)D[D[E]]=E;var F=/\\|'|\r|\n|\t|\u2028|\u2029/g,G=/\\(\\|'|r|n|t|u2028|u2029)/g,H=function(a){return a.replace(G,function(a,b){return D[b]})};w.template=function(a,b,c){c=w.defaults(c||{},w.templateSettings);var d="__p+='"+a.replace(F,function(a){return"\\"+D[a]}).replace(c.escape||C,function(a,b){return"'+\n_.escape("+H(b)+")+\n'"}).replace(c.interpolate||C,function(a,b){return"'+\n("+H(b)+")+\n'"}).replace(c.evaluate||C,function(a,b){return"';\n"+H(b)+"\n;__p+='"})+"';\n";c.variable||(d="with(obj||{}){\n"+d+"}\n"),d="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+d+"return __p;\n";var e=new Function(c.variable||"obj","_",d);if(b)return e(b,w);var f=function(a){return e.call(this,a,w)};return f.source="function("+(c.variable||"obj")+"){\n"+d+"}",f},w.chain=function(a){return w(a).chain()};var I=function(a){this._wrapped=a};w.prototype=I.prototype;var J=function(a,b){return b?w(a).chain():a},K=function(a,b){I.prototype[a]=function(){var a=g.call(arguments);return h.call(a,this._wrapped),J(b.apply(w,a),this._chain)}};w.mixin(w),x(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];I.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);var d=c.length;return(a=="shift"||a=="splice")&&d===0&&delete c[0],J(c,this._chain)}}),x(["concat","join","slice"],function(a){var b=d[a];I.prototype[a]=function(){return J(b.apply(this._wrapped,arguments),this._chain)}}),I.prototype.chain=function(){return this._chain=!0,this},I.prototype.value=function(){return this._wrapped}}.call(this),typeof exports!="undefined"?typeof module!="undefined"&&module.exports?exports:exports._:this._}),function(a){var b=function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a},c=function(a){if(a["@type"]==="VideoObject"||a["@type"]==="AudioObject")return a;var b=null;switch(a["@type"]){case"MusicRecording":b=["audio","associatedMedia","video"];break;default:b=["video","associatedMedia","audio"]}for(var c=0,d=b.length;c<d;c++){var e=b[c];if(typeof a[e]!="undefined")return a[e]}},d=function(a,b){b=b||{},a=a||{};var c={width:b.width||500,height:b.height||281};a["@type"]==="AudioObject"&&(c.height=b.height||40);if(b.adjustSize){var d=4/3;a.width&&a.height?d=a.width/a.height:a["yt:aspectRatio"]==="widescreen"&&(d=16/9);var e={width:Math.round(c.height*d),height:Math.round(c.width/d)};e.width>c.width+1?c.height=e.height:e.width<c.width-1&&(c.width=e.width)}return c},e=function(a){typeof this.initialize=="function"?this.initialize(a):e.prototype.initialize.call(this,a)};e.extend=function(a){var c=function(a){e.call(this,a)};return b(c.prototype,a),c},b(e.prototype,{initialize:function(a){},toHtml:function(a){typeof a=="function"&&a(null,"",{})}});var f=function(a){if(a.match(/soundcloud/g))return"audio/mp3";var b=a.split(".").pop();switch(b){case"webm":return"video/webm";case"ogv":return"video/ogg";case"mp4":return"video/mp4";case"m4v":return"video/mp4";case"ogg":return"audio/ogg";case"mp3":return"audio/mp3";case"m4a":return"audio/mp4";default:return""}},g=e.extend({initialize:function(a){this.sources=a.sources,this.poster=a.poster,this.width=a.width||500,this.height=a.height||281,this.autoPlay=a.autoPlay||!1},toHtml:function(a){var b=this.poster?' poster="'+this.poster+'"':"",c=this.autoPlay?" autoplay":"",d='<video width="'+this.width+'" height="'+this.height+'" '+b+c+" controls "+'class="video-js vjs-default-skin" data-setup="{}">';for(var e=0;e<this.sources.length;e++){var g=this.sources[e];d+='<source src="'+g+'"  type="'+f(g)+'"></source>'}d+="</video>",typeof a=="function"&&a(null,d,{width:this.width,height:this.height})}}),h=e.extend({initialize:function(a){this.sources=a.sources,this.poster=a.poster||"",this.width=a.width||500,this.height=a.height||281,this.autoPlay=a.autoPlay||!1},addPolyFill:function(){var a=document.getElementsByTagName("body")[0],b=document.createElement("link"),c=document.createElement("script");b.setAttribute("href","http://vjs.zencdn.net/c/video-js.css"),b.setAttribute("rel","stylesheet"),c.setAttribute("src","http://vjs.zencdn.net/c/video.js"),a.appendChild(b),a.appendChild(c)},toHtml:function(a){var b=this.poster?' poster="'+this.poster+'"':"",c=this.autoPlay?" autoplay":"",d='<video width="'+this.width+'" height="'+this.height+'" '+b+c+" controls"+' class="video-js vjs-default-skin" data-setup="{}">';for(var e=0;e<this.sources.length;e++){var g=this.sources[e];d+='<source src="'+g+'"  type="'+f(g)+'"></source>'}d+="</video>",typeof window!="undefined"&&typeof window.VideoJS=="undefined"&&this.addPolyFill(),typeof a=="function"&&a(null,d,{width:this.width,height:this.height})}}),i=e.extend({initialize:function(a){this.sources=a.sources,this.width=a.width||500,this.height=a.height||40,this.autoPlay=a.autoPlay||!1},iCanHazAudioTag:function(a){if(!document)return!1;var b=document.createElement("audio");return b.canPlayType},toHtml:function(a){var b="";if(this.sources&&this.sources.length){for(var c=0;c<this.sources.length;c++)if(this.iCanHazAudioTag(this.sources[c])){var d=this.autoPlay?" autoplay":"";b='<audio controls src="'+this.sources[c]+'"'+d+"></audio>";break}b||(b='<a href="'+this.sources[0]+'" target="_blank">Play</a>')}typeof a=="function"&&a(null,b,{})}}),j=e.extend({initialize:function(a){this.sources=a.sources,this.width=a.width||500,this.height=a.height||281,this.autoPlay=a.autoPlay||!1},toHtml:function(a){var b="mediaplayerlib-mediaelement-video-"+j.nextId++,c=this.poster?' poster="'+this.poster+'"':"",d=this.autoPlay?" autoplay":"",e='<video width="'+this.width+'" height="'+this.height+'" '+c+d+" controls"+' id="'+b+'">';for(var f=0;f<this.sources.length;f++){var g=this.sources[f];e+='<source src="'+g+'"></source>'}e+="</video>",e+="<script>",e+='$("#'+b+'").mediaelementplayer({',e+="playerWidth: "+this.width+",",e+="playerHeight: "+this.height,e+="});",e+="</script>",typeof a=="function"&&a(null,e,{width:this.width,height:this.height})}});j.nextId=0;var k=e.extend({initialize:function(a){this.options=a},toHtml:function(b){var c=null;for(var d=0;d<k.endPoints.length;d++)this.options.url.match(k.endPoints[d].regexp)&&(c=k.endPoints[d]);if(!c){typeof b=="function"&&b(null,null);return}if(typeof module!="undefined"){var e=c.url(null,this.options),f=require("http"),g=require("url"),h=g.parse(e),i={host:h.hostname,path:h.pathname+h.search,port:80,method:"GET"},j=f.request(i,function(a){var c="";a.on("data",function(a){c+=a}),a.on("end",function(){typeof b!="undefined"&&b(null,JSON.parse(c).html)}),a.on("close",function(a){typeof b!="undefined"&&b(a)})});j.on("error",function(a){typeof b!="undefined"&&b(a)}),j.end()}else{var l=k.cbName(),g=c.url(l,this.options),m=document.getElementsByTagName("body")[0],n=document.createElement("script");a[l]=function(c){m.removeChild(n),delete a[l],typeof b=="function"&&b(null,c.html)},n.setAttribute("src",g),m.appendChild(n)}}});k.endPoints=[{regexp:/soundcloud\.com/i,url:function(a,b){var c=null;return a?c="http://soundcloud.com/oembed?format=js&callback="+a+"&url="+encodeURIComponent(b.url):c="http://soundcloud.com/oembed?format=json&url="+encodeURIComponent(b.url),b.width&&(c+="&maxwidth="+b.width),b.height&&(c+="&maxheight="+b.height),c}},{regexp:/vimeo\.com/i,url:function(a,b){var c=null;return a?c="http://vimeo.com/api/oembed.json?callback="+a+"&url="+encodeURIComponent(b.url):c="http://vimeo.com/api/oembed.json?url="+encodeURIComponent(b.url),b.width&&(c+="&width="+b.width),b.height&&(c+="&height="+b.height),c}},{regexp:/slideshare\.net/i,url:function(a,b){var c=null;return a?c="http://www.slideshare.net/api/oembed/2?format=jsonp&callback="+a+"&url="+encodeURIComponent(b.url):c="http://www.slideshare.net/api/oembed/2?url="+encodeURIComponent(b.url),b.width&&(c+="&maxwidth="+b.width),b.height&&(c+="&maxheight="+b.height),c}}],k.numCbName=0,k.cbName=function(){return"OEmbedCallBack"+k.numCbName++};var l=e.extend({initialize:function(a){this.url=a.url,this.width=a.width||500,this.height=a.height||281;var b=this.url.match(/youtube/gi),c=this.url.match(/vimeo/gi);a.html5&&b&&(this.url.indexOf("?")===-1?this.url+="?html5=1":this.url+="&html5=1"),a.autoPlay&&(b||c)&&(this.url.indexOf("?")===-1?this.url+="?autoplay=1":this.url+="&autoplay=1")},toHtml:function(a){var b='<iframe src="'+this.url+'" width="'+this.width+'" height="'+this.height+'" frameborder="0"></iframe>';typeof a=="function"&&a(null,b,{width:this.width,height:this.height})}}),m=e.extend({initialize:function(a){this.url=a.url,this.publisher=a.publisher,this.width=a.width||500,this.height=a.height||281},toHtml:function(a){var b=this.url||"",c="",d="",e=function(){var a=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return"mediaplayerlib-"+a()+a()+a()};d=e(),this.publisher==="Ooyala"?(b+=(b.indexOf("?")===-1?"?":"&amp;")+"width="+encodeURIComponent(this.width)+"&amp;height="+encodeURIComponent(this.height),c='<div id="'+d+'"></div>'+'<script type="text/javascript">'+'document.getElementById("'+d+'").appendChild(document.createElement("script"));'+'window.ooyalaActiveScript = document.getElementById("'+d+'").firstChild;'+"</script>"+'<script type="text/javascript" src="'+b+'"></script>'):c='<script type="text/javascript" src="'+b+'"></script>',typeof a=="function"&&a(null,c,{width:this.width,height:this.height})}}),n=e.extend({toHtml:function(a){typeof a=="function"&&a(new Error("Unknown media type."),"Unknown media type.")}}),o=function(){};b(o.prototype,{execute:function(a,b){return new n(b)}}),o.extend=function(a){var c=function(a){o.call(this,a)};return b(c.prototype,a),c};var p=o.extend({execute:function(a,e){var f,g=c(a)||{},i=d(g,e);b(e,i);if(g["@type"]==="VideoObject")if(g.playerType==="iframe")b(e,{url:g.embedURL}),f=new l(e);else if(g.playerType==="script")b(e,{url:g.embedURL,publisher:g.publisher?g.publisher.name:null}),f=new m(e);else if(g.contentURL){var j=null;g.image&&g.image.contentURL&&(j=g.image.contentURL),b(e,{poster:j,sources:[g.contentURL]}),f=new h(e)}return f||new n}}),q=o.extend({execute:function(a,e){var f,h=c(a)||{},j=d(h,e);b(e,j);if(h.playerType==="iframe")b(e,{url:h.embedURL,html5:!0}),f=new l(e);else if(h.playerType==="script")b(e,{url:h.embedURL,html5:!0,publisher:h.publisher?h.publisher.name:null}),f=new m(e);else if(h["@type"]==="VideoObject"){if(h.contentURL){var k=null;h.image&&(k=h.image.contentURL),b(e,{poster:k,sources:[h.contentURL]}),f=new g(e)}}else h["@type"]==="AudioObject"&&h.contentURL&&(b(e,{sources:[h.contentURL]}),f=new i(e));return f}}),r=o.extend({execute:function(a,e){var f=c(a)||{},g=d(f,e);b(e,g);var h;if(a["@type"]==="VideoObject"){if(typeof a.contentURL!="undefined"){var i=null;f.image&&(i=f.image.contentURL),b(e,{poster:i,sources:[a.contentURL]}),h=new j(e)}}else a["@type"]==="AudioObject"&&typeof a.contentURL!="undefined"&&b(e,{sources:[a.contentURL]});return h}}),s=o.extend({execute:function(a,c){var d;return typeof a.url!="undefined"&&(b(c,{url:a.url}),d=new k(c)),d}}),t=function(){this.strategies={def:new p,html5:new q,mediaElement:new r,oembed:new s}};b(t.prototype,{resolve:function(a,b){b=b||{};var c;if(typeof b.strategy!="undefined"&&typeof this.strategies[b.strategy]!="undefined"){var d=this.strategies[b.strategy];c=d.execute(a,b)}return c||this.strategies.def.execute(a,b)},insertFragment:function(a,b){function d(a,b){b(a);for(var c in a.childNodes)d(a.childNodes[c],b)}function e(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()}function f(a){var b=a.text||a.textContent||a.innerHTML||"",c=a.getAttribute("src"),d=document.getElementsByTagName("head")[0]||document.documentElement,e=document.createElement("script");e.type="text/javascript",c&&e.setAttribute("src",c),b&&e.appendChild(document.createTextNode(b)),d.insertBefore(e,d.firstChild),a.parentNode&&a.parentNode.removeChild(a)}var c=null;Object.prototype.toString.call(b)==="[object String]"?c=document.getElementById(b):c=b,c.innerHTML=(""+a).trim();var g=[],h=null;d(c,function(a){a.nodeName&&a.nodeName.toUpperCase()==="SCRIPT"&&(!a.type||a.type==="text/javascript")&&g.push(a)});for(h in g)f(g[h])},insert:function(a,b,c,d){var e=this,f=this.resolve(a,b).toHtml(function(a,b){e.insertFragment(b,c),typeof d=="function"&&d(null)})}}),typeof Joshfire!="undefined"&&typeof Joshfire.define!="undefined"?Joshfire.define([],function(){return new t}):typeof define!="undefined"?define("joshfire-framework/utils/mediaplayerlib",[],function(){return new t}):a.mediaFactory=new t}(typeof module!="undefined"?module.exports:window),define("joshfire-framework/vendor/backbone",["joshlib!vendor/underscore","joshlib!utils/dollar"],function(a,b){return function(){var c=this,d=c.Backbone,e=Array.prototype.slice,f=Array.prototype.splice,g;typeof exports!="undefined"?g=exports:g=c.Backbone={},g.VERSION="0.9.2",g.setDomLibrary=function(a){b=a},g.noConflict=function(){return c.Backbone=d,this},g.emulateHTTP=!1,g.emulateJSON=!1;var h=/\s+/,i=g.Events={on:function(a,b,c){var d,e,f,g,i;if(!b)return this;a=a.split(h),d=this._callbacks||(this._callbacks={});while(e=a.shift())i=d[e],f=i?i.tail:{},f.next=g={},f.context=c,f.callback=b,d[e]={tail:g,next:i?i.next:f};return this},off:function(b,c,d){var e,f,g,i,j,k;if(!(f=this._callbacks))return;if(!(b||c||d))return delete this._callbacks,this;b=b?b.split(h):a.keys(f);while(e=b.shift()){g=f[e],delete f[e];if(!g||!c&&!d)continue;i=g.tail;while((g=g.next)!==i)j=g.callback,k=g.context,(c&&j!==c||d&&k!==d)&&this.on(e,j,k)}return this},trigger:function(a){var b,c,d,f,g,i,j;if(!(d=this._callbacks))return this;i=d.all,a=a.split(h),j=e.call(arguments,1);while(b=a.shift()){if(c=d[b]){f=c.tail;while((c=c.next)!==f)c.callback.apply(c.context||this,j)}if(c=i){f=c.tail,g=[b].concat(j);while((c=c.next)!==f)c.callback.apply(c.context||this,g)}}return this}};i.bind=i.on,i.unbind=i.off;var j=g.Model=function(b,c){var d;b||(b={}),c&&c.parse&&(b=this.parse(b));if(d=A(this,"defaults"))b=a.extend({},d,b);c&&c.collection&&(this.collection=c.collection),this.attributes={},this._escapedAttributes={},this.cid=a.uniqueId("c"),this.changed={},this._silent={},this._pending={},this.set(b,{silent:!0}),this.changed={},this._silent={},this._pending={},this._previousAttributes=a.clone(this.attributes),this.initialize.apply(this,arguments)};a.extend(j.prototype,i,{changed:null,_silent:null,_pending:null,idAttribute:"id",initialize:function(){},toJSON:function(b){return a.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(b){var c;if(c=this._escapedAttributes[b])return c;var d=this.get(b);return this._escapedAttributes[b]=a.escape(d==null?"":""+d)},has:function(a){return this.get(a)!=null},set:function(b,c,d){var e,f,g;a.isObject(b)||b==null?(e=b,d=c):(e={},e[b]=c),d||(d={});if(!e)return this;e instanceof j&&(e=e.attributes);if(d.unset)for(f in e)e[f]=void 0;if(!this._validate(e,d))return!1;this.idAttribute in e&&(this.id=e[this.idAttribute]);var h=d.changes={},i=this.attributes,k=this._escapedAttributes,l=this._previousAttributes||{};for(f in e){g=e[f];if(!a.isEqual(i[f],g)||d.unset&&a.has(i,f))delete k[f],(d.silent?this._silent:h)[f]=!0;d.unset?delete i[f]:i[f]=g,!a.isEqual(l[f],g)||a.has(i,f)!=a.has(l,f)?(this.changed[f]=g,d.silent||(this._pending[f]=!0)):(delete this.changed[f],delete this._pending[f])}return d.silent||this.change(d),this},unset:function(a,b){return(b||(b={})).unset=!0,this.set(a,null,b)},clear:function(b){return(b||(b={})).unset=!0,this.set(a.clone(this.attributes),b)},fetch:function(b){b=b?a.clone(b):{};var c=this,d=b.success;return b.success=function(a,e,f){if(!c.set(c.parse(a,f),b))return!1;d&&d(c,a)},b.error=g.wrapError(b.error,c,b),(this.sync||g.sync).call(this,"read",this,b)},save:function(b,c,d){var e,f;a.isObject(b)||b==null?(e=b,d=c):(e={},e[b]=c),d=d?a.clone(d):{};if(d.wait){if(!this._validate(e,d))return!1;f=a.clone(this.attributes)}var h=a.extend({},d,{silent:!0});if(e&&!this.set(e,d.wait?h:d))return!1;var i=this,j=d.success;d.success=function(b,c,f){var g=i.parse(b,f);d.wait&&(delete d.wait,g=a.extend(e||{},g));if(!i.set(g,d))return!1;j?j(i,b):i.trigger("sync",i,b,d)},d.error=g.wrapError(d.error,i,d);var k=this.isNew()?"create":"update",l=(this.sync||g.sync).call(this,k,this,d);return d.wait&&this.set(f,h),l},destroy:function(b){b=b?a.clone(b):{};var c=this,d=b.success,e=function(){c.trigger("destroy",c,c.collection,b)};if(this.isNew())return e(),!1;b.success=function(a){b.wait&&e(),d?d(c,a):c.trigger("sync",c,a,b)},b.error=g.wrapError(b.error,c,b);var f=(this.sync||g.sync).call(this,"delete",this,b);return b.wait||e(),f},url:function(){var a=A(this,"urlRoot")||A(this.collection,"url")||B();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(b){b||(b={});var c=this._changing;this._changing=!0;for(var d in this._silent)this._pending[d]=!0;var e=a.extend({},b.changes,this._silent);this._silent={};for(var d in e)this.trigger("change:"+d,this,this.get(d),b);if(c)return this;while(!a.isEmpty(this._pending)){this._pending={},this.trigger("change",this,b);for(var d in this.changed){if(this._pending[d]||this._silent[d])continue;delete this.changed[d]}this._previousAttributes=a.clone(this.attributes)}return this._changing=!1,this},hasChanged:function(b){return arguments.length?a.has(this.changed,b):!a.isEmpty(this.changed)},changedAttributes:function(b){if(!b)return this.hasChanged()?a.clone(this.changed):!1;var c,d=!1,e=this._previousAttributes;for(var f in b){if(a.isEqual(e[f],c=b[f]))continue;(d||(d={}))[f]=c}return d},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return a.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(b,c){if(c.silent||!this.validate)return!0;b=a.extend({},this.attributes,b);var d=this.validate(b,c);return d?(c&&c.error?c.error(this,d,c):this.trigger("error",this,d,c),!1):!0}});var k=g.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,{silent:!0,parse:b.parse})};a.extend(k.prototype,i,{model:j,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},add:function(b,c){var d,e,g,h,i,j,k={},l={},m=[];c||(c={}),b=a.isArray(b)?b.slice():[b];for(d=0,g=b.length;d<g;d++){if(!(h=b[d]=this._prepareModel(b[d],c)))throw new Error("Can't add an invalid model to a collection");i=h.cid,j=h.id;if(k[i]||this._byCid[i]||j!=null&&(l[j]||this._byId[j])){m.push(d);continue}k[i]=l[j]=h}d=m.length;while(d--)b.splice(m[d],1);for(d=0,g=b.length;d<g;d++)(h=b[d]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,h.id!=null&&(this._byId[h.id]=h);this.length+=g,e=c.at!=null?c.at:this.models.length,f.apply(this.models,[e,0].concat(b)),this.comparator&&this.sort({silent:!0});if(c.silent)return this;for(d=0,g=this.models.length;d<g;d++){if(!k[(h=this.models[d]).cid])continue;c.index=d,h.trigger("add",h,this,c)}return this},remove:function(b,c){var d,e,f,g;c||(c={}),b=a.isArray(b)?b.slice():[b];for(d=0,e=b.length;d<e;d++){g=this.getByCid(b[d])||this.get(b[d]);if(!g)continue;delete this._byId[g.id],delete this._byCid[g.cid],f=this.indexOf(g),this.models.splice(f,1),this.length--,c.silent||(c.index=f,g.trigger("remove",g,this,c)),this._removeReference(g)}return this},push:function(a,b){return a=this._prepareModel(a,b),this.add(a,b),a},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(b,c){return b=this._prepareModel(b,c),this.add(b,a.extend({at:0},c)),b},shift:function(a){var b=this.at(0);return this.remove(b,a),b},get:function(a){return a==null?void 0:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},where:function(b){return a.isEmpty(b)?[]:this.filter(function(a){for(var c in b)if(b[c]!==a.get(c))return!1;return!0})},sort:function(b){b||(b={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var c=a.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(c):this.models.sort(c),b.silent||this.trigger("reset",this,b),this},pluck:function(b){return a.map(this.models,function(a){return a.get(b)})},reset:function(b,c){b||(b=[]),c||(c={});for(var d=0,e=this.models.length;d<e;d++)this._removeReference(this.models[d]);return this._reset(),this.add(b,a.extend({silent:!0},c)),c.silent||this.trigger("reset",this,c),this},fetch:function(b){b=b?a.clone(b):{},b.parse===undefined&&(b.parse=!0);var c=this,d=b.success;return b.success=function(a,e,f){c[b.add?"add":"reset"](c.parse(a,f),b),d&&d(c,a)},b.error=g.wrapError(b.error,c,b),(this.sync||g.sync).call(this,"read",this,b)},create:function(b,c){var d=this;c=c?a.clone(c):{},b=this._prepareModel(b,c);if(!b)return!1;c.wait||d.add(b,c);var e=c.success;return c.success=function(a,f,g){c.wait&&d.add(a,c),e?e(a,f):a.trigger("sync",b,f,c)},b.save(null,c),b},parse:function(a,b){return a},chain:function(){return a(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){b||(b={});if(a instanceof j)a.collection||(a.collection=this);else{var c=a;b.collection=this,a=new this.model(c,b),a._validate(a.attributes,b)||(a=!1)}return a},_removeReference:function(a){this==a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var l=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];a.each(l,function(b){k.prototype[b]=function(){return a[b].apply(a,[this.models].concat(a.toArray(arguments)))}});var m=g.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},n=/:\w+/g,o=/\*\w+/g,p=/[-[\]{}()+?.,\\^$|#\s]/g;a.extend(m.prototype,i,{initialize:function(){},route:function(b,c,d){return g.history||(g.history=new q),a.isRegExp(b)||(b=this._routeToRegExp(b)),d||(d=this[c]),g.history.route(b,a.bind(function(a){var e=this._extractParameters(b,a);d&&d.apply(this,e),this.trigger.apply(this,["route:"+c].concat(e)),g.history.trigger("route",this,c,e)},this)),this},navigate:function(a,b){g.history.navigate(a,b)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(p,"\\$&").replace(n,"([^/]+)").replace(o,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}});var q=g.History=function(){this.handlers=[],a.bindAll(this,"checkUrl")},r=/^[#\/]/,s=/msie [\w.]+/;q.started=!1,a.extend(q.prototype,i,{interval:50,getHash:function(a){var b=a?a.location:window.location,c=b.href.match(/#(.*)$/);return c?c[1]:""},getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c)}else a=this.getHash();return a.indexOf(this.options.root)||(a=a.substr(this.options.root.length)),a.replace(r,"")},start:function(c){if(q.started)throw new Error("Backbone.history has already been started");q.started=!0,this.options=a.extend({},{root:"/"},this.options,c),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var d=this.getFragment(),e=document.documentMode,f=s.exec(navigator.userAgent.toLowerCase())&&(!e||e<=7);f&&(this.iframe=b('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(d)),this._hasPushState?b(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!f?b(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=d;var g=window.location,h=g.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&g.hash&&(this.fragment=this.getHash().replace(r,""),window.history.replaceState({},document.title,g.protocol+"//"+g.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){b(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),q.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe)));if(b==this.fragment)return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(this.getHash())},loadUrl:function(b){var c=this.fragment=this.getFragment(b),d=a.any(this.handlers,function(a){if(a.route.test(c))return a.callback(c),!0});return d},navigate:function(a,b){if(!q.started)return!1;if(!b||b===!0)b={trigger:b};var c=(a||"").replace(r,"");if(this.fragment==c)return;this._hasPushState?(c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a)},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}});var t=g.View=function(b){this.cid=a.uniqueId("view"),this._configure(b||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},u=/^(\S+)\s*(.*)$/,v=["model","collection","el","id","attributes","className","tagName"];a.extend(t.prototype,i,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,c,d){var e=document.createElement(a);return c&&b(e).attr(c),d&&b(e).html(d),e},setElement:function(a,c){return this.$el&&this.undelegateEvents(),this.$el=a instanceof b?a:b(a),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(b){if(!b&&!(b=A(this,"events")))return;this.undelegateEvents();for(var c in b){var d=b[c];a.isFunction(d)||(d=this[b[c]]);if(!d)throw new Error('Method "'+b[c]+'" does not exist');var e=c.match(u),f=e[1],g=e[2];d=a.bind(d,this),f+=".delegateEvents"+this.cid,g===""?this.$el.bind(f,d):this.$el.delegate(g,f,d)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(b){this.options&&(b=a.extend({},this.options,b));for(var c=0,d=v.length;c<d;c++){var e=v[c];b[e]&&(this[e]=b[e])}this.options=b},_ensureElement:function(){if(!this.el){var a=A(this,"attributes")||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.setElement(this.make(this.tagName,a),!1)}else this.setElement(this.el,!1)}});var w=function(a,b){var c=z(this,a,b);return c.extend=this.extend,c};j.extend=k.extend=m.extend=t.extend=w;var x={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};g.sync=function(c,d,e){var f=x[c];e||(e={});var h={type:f,dataType:"json"};return e.url||(h.url=A(d,"url")||B()),!e.data&&d&&(c=="create"||c=="update")&&(h.contentType="application/json",h.data=JSON.stringify(d.toJSON())),g.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),g.emulateHTTP&&(f==="PUT"||f==="DELETE")&&(g.emulateJSON&&(h.data._method=f),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",f)}),h.type!=="GET"&&!g.emulateJSON&&(h.processData=!1),b.ajax(a.extend(h,e))},g.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d,a?a(b,e,c):b.trigger("error",b,e,c)}};var y=function(){},z=function(b,c,d){var e;return c&&c.hasOwnProperty("constructor")?e=c.constructor:e=function(){b.apply(this,arguments)},a.extend(e,b),y.prototype=b.prototype,e.prototype=new y,c&&a.extend(e.prototype,c),d&&a.extend(e,d),e.prototype.constructor=e,e.__super__=b.prototype,e},A=function(b,c){return!b||!b[c]?null:a.isFunction(b[c])?b[c]():b[c]},B=function(){throw new Error('A "url" property or function must be specified')}}.call(this),typeof exports!="undefined"?exports:this.Backbone}),define("joshfire-framework/view",["joshlib!vendor/backbone","joshlib!vendor/underscore"],function(a,b){var c=a.View.extend({compileTemplate:b.template,initialize:function(a){a?(this.data=a.data||{},this.loadingClass=a.loadingClass||null,this.loadingClass&&(b.isString(this.loadingClass)||(this.loadingClass="loading"))):this.data={}},render:function(){var a=this;this.generate(function(b,c){c!==!1&&a.setContent(c),a.enhance()})},setContent:function(a){this.$el.html(""),this.$el.append(a)},generate:function(a){a(null,"")},wrapContent:function(a){a=a||"";var b=function(a){return a?a.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;"):""};if(!this.el)return"<div>"+a+"</div>";var c="<"+this.el.nodeName.toLowerCase();for(var d=0;d<this.el.attributes.length;d++){var e=this.el.attributes[d];e.value?c+=" "+e.name+'="'+b(e.value)+'"':c+=" "+e.name}return c+=">"+a+"</"+this.el.nodeName.toLowerCase()+">",c},hide:function(){this.$el.hide(),this.trigger("hidden")},show:function(){this.$el.show(),this.trigger("shown")},enhance:function(){this.customLoadEvent||this.trigger("load"),this.loadingClass&&this.$el&&(this.$el.addClass(this.loadingClass),this.unbind("load",this.removeLoadingClass,this),this.bind("load",this.removeLoadingClass,this))},removeLoadingClass:function(){this.$el.removeClass(this.loadingClass)}});return c}),define("joshfire-framework/uielement",["joshlib!view"],function(a){var b=a.extend({});return b}),define("joshfire-framework/adapters/phone/uielement",["joshlib!adapters/none/uielement","joshlib!vendor/iscroll","joshlib!vendor/underscore"],function(a,b,c){var d=a.extend({initialize:function(b){this.options.scroller&&this.$el.css({overflow:"hidden"}),this.options.scrollerSelector&&(this.scrollerSelector=this.options.scrollerSelector),this.bind("shown",function(){this.hasScroller&&this.iScroller&&this.iScroller.refresh()},this),a.prototype.initialize.call(this,b)},enhance:function(){var b=this;if(this.options.scroller){b.insertScroller(),window.skiped&&b.iScroller.scrollToElement("li:nth-child("+window.skiped+")",200);var c=b.$("img");c.length&&b.$("img").bind("load",function(){setTimeout(function(){b.iScroller.refresh()},10)})}a.prototype.enhance.call(this)},insertScroller:function(){var a=this;this.hasScroller=!0,a.iScroller&&a.iScroller.destroy();var d=a.el;a.scrollerSelector&&(d=a.$(a.scrollerSelector).get(0)||a.el),a.iScroller=new b(d,c.extend({useTransition:!0,onScrollMove:function(){a.$("a").bind("click.iscrollprevent",function(a){a.preventDefault()})},onScrollEnd:function(){setTimeout(function(){a.$("a").unbind("click.iscrollprevent")},100)},onBeforeScrollStart:function(a){var b=a.target;while(b.nodeType!=1)b=b.parentNode;b.tagName!="SELECT"&&b.tagName!="INPUT"&&b.tagName!="TEXTAREA"&&a.preventDefault()}},a.options.scrollOptions||{})),a.options.scrollOptions&&a.options.scrollOptions.disabled&&a.iScroller.disable(),document.addEventListener("orientationChanged",function(b){a.iScroller&&a.iScroller.refresh()})}});return d}),define("joshfire-framework/ui/layout",["joshlib!uielement","joshlib!vendor/underscore"],function(a,b){var c=a.extend({rendering:!1,initialize:function(c){c.template?this.template=this.compileTemplate(c.template):c.templateEl&&(this.template=this.compileTemplate($(c.templateEl).text())),this.customLoadEvent=!0,this.setChildren(c.children),this.on("shown",function(){b.each(this.children,function(a){a.trigger("shown")})},this),this.on("hidden",function(){b.each(this.children,function(a){a.trigger("hidden")})},this),a.prototype.initialize.call(this,c)},setChildren:function(a){this.children=a,this.numChildren=0,this.numChildrenLoaded=0,a&&b.each(a,function(a){++this.numChildren,a.on("load",function(){this.rendering?(++this.numChildrenLoaded,this.numChildrenLoaded===this.numChildren&&(this.rendering=!1,this.trigger("load"))):this.trigger("load")},this)},this)},getChild:function(a){if(a)return this.children[a]},generate:function(a){if(!this.children)return a(null,"");this.childrenOffsets={},this.numChildrenLoaded=0;var c=0,d="";b.each(this.children,function(e,f){e.generate(b.bind(function(b,g){var h=e.wrapContent(g);this.childrenOffsets[f]=c,d+=h;if(++c===this.numChildren){d='<div class="joshfire-wrapper">'+d+"</div>";var i=null;this.template?i=this.template({childrenOuterHTML:d}):i=d,a(null,i)}},this))},this)},setContent:function(b){a.prototype.setContent.call(this,b),this.children&&this.el&&this.setChildrenElements(!0)},setElement:function(b,c){a.prototype.setElement.call(this,b,c),this.setChildrenElements(c)},setChildrenElements:function(a){b.each(this.children,function(a,b){var c=this.el.getElementsByClassName("joshfire-wrapper")[0].childNodes[this.childrenOffsets[b]];a.setElement(c,!0)},this)},enhance:function(){this.rendering=!0,a.prototype.enhance.call(this),this.children&&this.el&&b.each(this.children,function(a,b){a.enhance()},this);if(!this.children||this.children.length===0)this.rendering=!1,this.trigger("load")}});return c}),define("joshfire-framework/ui/cardpanel",["joshlib!ui/layout","joshlib!vendor/underscore"],function(a,b){var c=a.extend({initialize:function(b){this.showChild(b.currentChild||b.defaultChildren),a.prototype.initialize.call(this,b)},showChild:function(a){if(this.currentChild===a)return;this.canUseDOM&&this.transition(this.currentChild,a),this.currentChild=a},showChildren:function(a){this.showChild(a)},transition:function(a,c){b.each(this.children,function(a,b){b!=c&&a.hide()}),c&&this.children[c].show()},enhance:function(){a.prototype.enhance.call(this),this.currentChild&&this.transition(null,this.currentChild),this.canUseDOM=!0}});return c}),define("joshfire-framework/ui/fadeinpanel",["joshlib!ui/cardpanel","joshlib!vendor/underscore","joshlib!utils/dollar"],function(a,b,c){var d=a.extend({initialize:function(b){this.cssTransition=b.cssTransition||".4s ease-in-out all",a.prototype.initialize.call(this,b)},transition:function(a,d){var e=this.children[d];e.hide(),c(e.el).css({filter:"alpha(opacity=0)","-khtml-opacity":0,"-moz-opacity":0,"-ms-opacity":0,"-o-opacity":0,opacity:0,"-webkit-transition":"none","-moz-transition":"none","-ms-transition":"none","-o-transition":"none",transition:"none"}),b.each(this.children,b.bind(function(a,b){a.hide()},this)),e.show(),c(e.el).css({filter:"alpha(opacity=100)","-khtml-opacity":1,"-moz-opacity":1,"-ms-opacity":1,"-o-opacity":1,opacity:1,"-webkit-transition":"0.7s ease-in-out all","-moz-transition":"0.7s ease-in-out all","-ms-transition":"0.7s ease-in-out all","-o-transition":"0.7s ease-in-out all",transition:"0.7s ease-in-out all","-webkit-backface-visibility":"hidden"})}});return d}),define("joshfire-framework/ui/item",["joshlib!uielement","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c){var d=a.extend({initialize:function(c){c.template?this.template=this.compileTemplate(c.template):c.templateEl&&(this.template=this.compileTemplate(b(c.templateEl).text())),this.setModel(c.model),a.prototype.initialize.call(this,c)},setModel:function(a,b){this.model=a,a&&a.bind("change",this.render,this),b&&this.render()},generate:function(a){if(!this.template)return a(null,"");if(!this.model)return a(null,"");var b={model:this.model,obj:this.model,item:this.model?this.model.toJSON():{}};c.extend(b,this.data),a(null,this.template(b))}});return d}),define("joshfire-framework/ui/dynamiccontainer",["joshlib!uielement","joshlib!ui/item","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c,d){var e=a.extend({initialize:function(e){this.setModel(e.model),this.setCollection(e.collection),this.viewTemplateEl=e.viewTemplateEl||e.itemTemplateEl,this.viewOptions=e.viewOptions||e.itemOptions||{},this.viewOptions.templateEl=this.viewOptions.templateEl||this.viewTemplateEl,this.viewOptions.template=this.viewOptions.template||e.viewTemplate||e.itemTemplate,e.template?this.template=this.compileTemplate(e.template):e.templateEl&&(this.template=this.compileTemplate(c(e.templateEl).text())),this.viewFactory=function(a,c){var f={model:a,collection:c};return d.extend(f,this.viewOptions),factory=e.viewFactory||e.itemFactory,factory?factory(f):new b(f)},this.customLoadEvent=!0,this.bind("shown",function(){this.view&&this.view.trigger("shown")},this),this.bind("hidden",function(){this.view&&this.view.trigger("hidden")},this),a.prototype.initialize.call(this,e)},setModel:function(a,b){this.model&&this.model.unbind("change",this.render,this),this.model=a,a&&a.bind("change",this.render,this),b&&this.render()},setCollection:function(a,b){this.collection&&(this.collection.unbind("change",this.render,this),this.collection.unbind("add",this.render,this),this.collection.unbind("remove",this.render,this),this.collection.unbind("reset",this.render,this)),this.collection=a,a&&(a.bind("change",this.render,this),a.bind("add",this.render,this),a.bind("remove",this.render,this),a.bind("reset",this.render,this)),b&&this.render()},generate:function(a){var b=this;this.view&&this.view.unbind("load",this.triggerLoad,this),this.view=this.viewFactory(this.model,this.collection);if(!this.view)return a(null,"");this.view.bind("load",this.triggerLoad,this),!this.view.model&&this.view.setModel&&this.view.setModel(this.model),!this.view.collection&&this.view.setCollection&&this.view.setCollection(this.collection),this.view.generate(function(c,d){var e=b.view.wrapContent(d),f=null;return e&&b.template?f=b.template({child:e}):f=e?e:"",a(c,f)})},setContent:function(b){a.prototype.setContent.call(this,b),this.view&&this.el&&this.setViewElement(!0)},setElement:function(b,c){a.prototype.setElement.call(this,b,c),this.setViewElement(c)},setViewElement:function(a){this.view&&this.view.setElement(this.el.firstChild,a)},enhance:function(){var b=this;this.view.enhance();var c=["navUp","navRight","navDown","navLeft","navAction","navFocus","navBlur"];d.each(c,function(a){b[a]=b.view[a]}),a.prototype.enhance.call(this)},triggerLoad:function(){this.trigger("load")}});return e}),define("joshfire-framework/ui/factorymedia",["joshlib!ui/item","joshlib!utils/mediaplayerlib","joshlib!vendor/underscore"],function(a,b,c){var d=a.extend({initialize:function(b){this.mediaOptions=b.mediaOptions||{},a.prototype.initialize.call(this,b)},generate:function(d){var e=/^([0-9]{1,3})%$/,f=null,g=0,h=c.clone(this.mediaOptions);if(!this.model)return d(null,"");h.width&&c.isString(h.width)&&(f=h.width.match(e),f&&(g=parseInt(f[1],10),this.options.width?h.width=this.options.width*g/100:h.width=this.$el.width()*g/100,h.width=Math.floor(h.width))),h.height&&c.isString(h.height)&&(f=h.height.match(e),f&&(g=parseInt(f[1],10),this.options.height?h.height=this.options.height*g/100:h.height=this.$el.height()*g/100,h.height=Math.floor(h.height)));var i=b.resolve(this.model.toJSON(),h);i.toHtml(c.bind(function(b,e,f){if(this.template)c.extend(this.data,{media:{html:e,metadata:f},width:this.options.width,height:this.options.height}),a.prototype.generate.call(this,d);else return d(null,e)},this))}});return d}),define("joshfire-framework/ui/imagesloader",["joshlib!ui/item","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c){var d=a.extend({initialize:function(c){this.imageClass=c.imageClass,this.processImageEl=c.processImageEl;var d=this;this.getImages=c.getImages||function(){var a=b.map(this.$("img"),function(a){return d.imageClass&&b(a).addClass(d.imageClass),{el:a,url:b(a).attr("src")}});return a},this.customLoadEvent=!0,a.prototype.initialize.call(this,c)},enhance:function(){var d=this;if(!this.getImages){a.prototype.enhance.call(this),this.trigger("load");return}var e=this.getImages();if(!e||e.length===0){a.prototype.enhance.call(this),this.trigger("load");return}var f=0,g=function(a){a&&b(a).removeClass("loading"),f+=1,f===e.length&&d.trigger("load")};c.each(e,function(a){if(!a.el||!a.url)return g(a.el);var c=a.el;d.processImageEl&&(c=d.processImageEl(a.el)),b(c).addClass("loading");var e=new Image;e.onload=function(){g(c),e=null},e.onerror=function(){g(c),e=null},e.src=a.url}),a.prototype.enhance.call(this)}});return d}),define("joshfire-framework/ui/imageloader",["joshlib!ui/imagesloader","joshlib!vendor/underscore"],function(a,b){var c=a.extend({initialize:function(b){this.getImageUrl=b.getImageUrl||function(){return this.model?this.model.imageUrl:null};var c=this;b.getImages=function(){var a=null;return b.imageContainer&&(a=c.$(b.imageContainer)),a||(a=c.$el),[{el:a.get(0),url:c.getImageUrl()}]},a.prototype.initialize.call(this,b)},generate:function(a){if(!this.model){a(null,"");return}var c={model:this.model,obj:this.model,item:this.model?this.model.toJSON():{},imageUrl:this.getImageUrl.call(this)};b.extend(c,this.data),a(null,this.template(c))}});return c}),define("joshfire-framework/ui/listitem",["joshlib!uielement","joshlib!vendor/underscore"],function(a,b){var c=a.extend({initialize:function(c){this.view=c.view,this.offset=c.offset,this.customLoadEvent=!0,this.view&&this.view.bind("load",b.bind(function(){this.trigger("load")},this)),a.prototype.initialize.call(this,c)},setElement:function(a){this.view&&this.view.setElement(a)},generate:function(a){this.view.data.offset=this.offset,this.view.generate(a)},render:function(){this.view.render()},setContent:function(a){this.view.setContent(a)},hide:function(){this.view.hide()},show:function(){this.view.show()},enhance:function(){this.view.enhance()}});return c}),define("joshfire-framework/ui/list",["joshlib!uielement","joshlib!ui/listitem","joshlib!ui/item","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c,d,e){var f=a.extend({initialize:function(f){f.templateEl?this.template=this.compileTemplate(d(f.templateEl).text()):this.template=this.compileTemplate("<ul><%= children %></ul>"),this.UIItemClass=f.UIItemClass||b,this.itemOptions=f.itemOptions||{scroller:!1},this.itemTemplateEl=f.itemTemplateEl,this.itemOptions.templateEl=this.itemOptions.templateEl||this.itemTemplateEl,this.itemOptions.template=this.itemOptions.template||f.itemTemplate,this.contentSelector=f.contentSelector,this.items=[],this.itemFactory=f.itemFactory||function(a,b){var d={model:a,offset:b};return e.extend(d,this.itemOptions),new c(d)},this.customLoadEvent=!0,this.dataLoadingClass="loading",typeof f.dataLoadingClass!="undefined"&&(this.dataLoadingClass=f.dataLoadingClass),this.dataLoadingClass===!1&&(this.dataLoadingClass=null),this.bind("shown",function(){e.each(this.items,function(a){a.trigger("shown")})},this),this.bind("hidden",function(){e.each(this.items,function(a){a.trigger("hidden")})},this),a.prototype.initialize.call(this,f),f.collection&&this.setCollection(f.collection)},setCollection:function(a,b){this.collection&&(this.collection.unbind("change",this.update,this),this.collection.unbind("add",this.update,this),this.collection.unbind("remove",this.update,this),this.collection.unbind("reset",this.update,this),this.collection.unbind("syncstarted",this.syncStartedHandler,this),this.collection.unbind("syncsuccess",this.syncSuccessHandler,this),this.collection.unbind("syncerror",this.syncErrorHandler,this)),this.collection=a,a&&(a.bind("change",this.update,this),a.bind("add",this.update,this),a.bind("remove",this.update,this),a.bind("reset",this.update,this),a.bind("syncstarted",this.syncStartedHandler,this),a.bind("syncsuccess",this.syncSuccessHandler,this),a.bind("syncerror",this.syncErrorHandler,this)),this.update(b)},update:function(a){this.items=new Array(this.collection.length),this.itemsLoaded=0;var c=function(){++this.itemsLoaded,this.itemsLoaded===this.items.length&&this.trigger("load")};for(var d=0;d<this.collection.length;d++){var f=this.collection.at(d);this.items[d]=new b({view:this.itemFactory.call(this,f,d),model:f,offset:d}),this.items[d].bind("load",e.bind(c,this))}a&&this.render()},generate:function(a){var b=this.items,c=new Array(b.length),d=0,e=this.template;if(!b.length){var f=e({children:""});a(null,f);return}for(var g=0;g<b.length;g++)((function(f,g){this.generateItem(function(f,h){c[g]=h;if(++d===b.length){var i=e({children:c.join("")});a(null,i)}},f)})).call(this,b[g],g)},generateItem:function(a,b){b.generate(a)},enhance:function(){var b=this.$("li");for(var c=0;c<this.items.length;c++){var e=this.items[c];e.setElement(b[c]),e.enhance()}this.$(".joshfire-link").unbind("click").bind("click",function(a){a.preventDefault();var b=d(a.currentTarget).attr("data-joshfire-link-url");return window.location=b,!1}),a.prototype.enhance.call(this),this.items.length===0&&this.trigger("load")},setContent:function(a){this.contentSelector?this.$(this.contentSelector).html(a):d(this.el).html(a)},syncStartedHandler:function(){this.dataLoadingClass&&d(this.el).addClass(this.dataLoadingClass)},syncSuccessHandler:function(){var a=this;this.dataLoadingClass&&window.setTimeout(function(){d(a.el).removeClass(a.dataLoadingClass)},5e3)},syncErrorHandler:function(){this.dataLoadingClass&&d(this.el).removeClass(this.dataLoadingClass)}});return f}),define("ui/imagegallery",["joshlib!ui/list","vendor/klass","vendor/photoswipe","joshlib!vendor/underscore"],function(a,b,c,d){var e=a.extend({name:"imagegallery",initialize:function(b){this.photoswipe={getImageCaption:function(a){return a.title},minUserZoom:1},b.photoswipe&&d.extend(this.photoswipe,b.photoswipe),this.linkSelector=b.linkSelector||'a[href$=".jpg"],a[href$=".jpeg"],a[href$=".png"],a[href$=".gif"]',a.prototype.initialize.call(this,b)},enhance:function(){var b=this.$(this.linkSelector);b.length&&Code.PhotoSwipe.attach(b,this.photoswipe),a.prototype.enhance.call(this)}});return e}),define("joshfire-framework/collection",["joshlib!vendor/backbone","joshlib!vendor/underscore"],function(a,b){var c=a.Collection.extend({initialize:function(a,b){this.ds=null,this.dsq={},b=b||{},b.dataSource&&this.setDataSource(b.dataSource),b.dataSourceQuery&&this.setDataSourceQuery(b.dataSourceQuery)},setDataSource:function(a){this.ds=a},setDataSourceQuery:function(a){this.dsq=a},sync:function(a,c,d){if(!this.ds){this.trigger("syncerror",{method:a,err:"init failed, ds is null"}),d&&d.error&&d.error("init failed, ds is null");return}d=d||{};var e={};this.dsq&&(e=b.extend(e,this.dsq)),d.dataSourceQuery&&(e=b.extend(e,d.dataSourceQuery)),a==="read"&&(this.trigger("syncstarted",{method:a}),this.ds.find(e,b.bind(function(b,c){if(b){this.trigger("syncerror",{method:a,err:b}),d.error&&d.error(b);return}if(this.ds.children){var e=[];e=Array.prototype.concat.apply(e,c.entries.map(function(a){return a.entries})),d.success&&d.success(e)}else d.success&&d.success(c.entries||[]);this.trigger("syncsuccess",{method:a})},this)))}});return c}),define("joshfire-framework/adapters/phone/collection",["joshlib!adapters/none/collection"],function(a){return a.adapted=!0,a}),define("joshfire-framework/router",["joshlib!vendor/backbone","joshlib!vendor/underscore"],function(a,b){var c=function(c){b.extend(c,{historyStart:function(b){a.history.start(b)}});var d=a.Router.extend(c);return new d};return c}),define("sleek",["joshlib!collection","joshlib!ui/dynamiccontainer","joshlib!ui/item","joshlib!ui/list","joshlib!ui/cardpanel","joshlib!ui/fadeinpanel","joshlib!ui/factorymedia","joshlib!ui/imageloader","joshlib!ui/imagesloader","joshlib!router","joshlib!vendor/backbone","joshlib!vendor/underscore","joshlib!utils/dollar","ui/imagegallery"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=function(){l.bindAll(this,"initialize","setColor","slugify")};return o.extend=k.View.extend,l.extend(o.prototype,{deviceFamily:"all",clientWidth:document.body.clientWidth,initialized:!1,loadedHookTriggered:!1,convertItemType:function(a){var b=null;switch(a){case"Article/Status":b="status";break;case"NewsArticle":case"BlogPosting":case"Article":case"CreativeWork":b="news";break;case"Event":b="event";break;case"ImageObject":b="photo";break;case"VideoObject":b="video";break;case"MusicRecording":b="sound";break;case"Product":b="product";break;default:b="other"}return b},initialize:function(){var b=this;this.title=Joshfire.factory.config.app.name,this.tabs=Joshfire.factory.config.template.options.tabs||[],this.tabicons=Joshfire.factory.config.template.options.tabicons||[],this.backgroundURL=Joshfire.factory.config.template.options.backgroundimage?Joshfire.factory.config.template.options.backgroundimage.url:Joshfire.factory.config.template.options.backgroundurl,this.logoURL=Joshfire.factory.config.app.logo?Joshfire.factory.config.app.logo.contentURL:null,document.title=this.title,this.setColor(Joshfire.factory.config.template.options.color||"gray",function(){var c=b.getDatasources(),d=new Array(c.length),e=0;l.forEach(c,l.bind(function(c,e){var f=this.tabs[e]||c.name||"",g=this.tabicons[e],h=e+"--"+this.slugify(f.toLowerCase()),i=new a([],{dataSource:c,dataSourceQuery:{}}),j=c.getOutputType();d[e]={name:f,slug:h,icon:g||b.convertItemType(j),outputType:b.convertItemType(j),collection:i,index:e}},b));var f=b.createViews(d),g=b.createRoutes(d,f),h=j(g);this.initialized=!0,h.historyStart()})},getDatasources:function(){var a=Joshfire.factory.getDataSource("main"),b=[];return a&&a.children&&a.children.length>0&&(b=b.concat(a.children)),b},setColor:function(a,b){m("#color").remove(),window.Sid.css("css/"+this.deviceFamily+"."+a+".css",b)},setTitle:function(a){m("#title").html(a)},getClassName:function(a,b){if(b!=="list")return b==="single"?"single content detail":"content detail";switch(a){case"status":case"event":return"content hashed-list";case"photo":return"content mosaic-list";default:return"content simple-list"}},createToolbar:function(a){var b=new k.Collection,c=null;for(var d=0;d<a.length;d++)c=a[d],b.add({name:c.name,icon:c.icon,linkURL:"#"+c.slug,outputType:c.outputType,slug:c.slug});var e=this.createToolbarElement();return e.setCollection(b),e.render(),e},createViews:function(a){var b={},d=null;return this.createAdditionalViews(b),!a||a.length===0?(d=new c({el:"#cards",model:new k.Model,templateEl:"#template-nodata"}),d.bind("load",function(){!this.loadedHookTriggered&&this.initialized&&(this.loadedHookTriggered=!0,Joshfire.factory.getAddOns("loaded").run())},this),d.render(),d):(this.toolbarView=this.createToolbar(a),l.forEach(a,l.bind(function(a){var c=this.createSectionView(a);b[a.slug]=c},this)),d=new f({el:"#cards",children:b}),d.bind("load",function(){!this.loadedHookTriggered&&this.initialized&&(this.loadedHookTriggered=!0,Joshfire.factory.getAddOns("loaded").run())},this),d.render(),d)},createAdditionalViews:function(a){},createToolbarElement:function(){return new d({el:"#toolbar",templateEl:"#template-toolbar",itemTemplateEl:"#toolbar-item"})},createSectionView:function(a){var c=new b({collection:a.collection,viewFactory:this.viewFactory(a)});return a.view=c,c},viewFactory:function(a){return l.bind(function(b){var c=b.collection;if(a.outputType==="photo")return this.createListElement(a);if(c.length===1)return this.createDetailContainer(a,!0);var d=this.createListElement(a),e=this.createDetailContainer(a),f=this.createListAndDetailView(d,e);return f},this)},createListAndDetailView:function(a,b){},refreshList:function(a,b){a.collection.fetch({dataSourceQuery:{nocache:!0},success:l.bind(function(){this.showList(a,b)},this)})},updateList:function(a,b){a.collection.fetch({success:l.bind(function(){this.showList(a,b)},this)})},showList:function(a,b){b.view.children&&b.view.children.list?b.view.showChild("list","left"):a.collection.length&&(b.setModel(a.collection.at(0)),b.render())},moveToList:function(a){a.view.children&&a.view.children.list&&a.view.showChild("list","left")},updateDetail:function(a,b,c){a.collection.fetch({success:l.bind(function(){this.showDetail(a,b,c)},this)})},showDetail:function(a,b,c){if(b.view.children&&b.view.children.detail){var d=b.view.children.detail;a.collection.length>c&&(d.setModel(a.collection.at(c)),d.render()),b.view.showChild("detail","right")}},createListElement:function(a){return a.outputType==="photo"?new n({templateEl:"#template-list-view",scroller:!0,itemFactory:this.itemFactory(a),collection:a.collection,className:a.outputType+" "+this.getClassName(a.outputType,"list"),dataLoadingClass:"dataloading",loadingClass:"loading"}):new d({templateEl:"#template-list-view",scroller:!0,itemFactory:this.itemFactory(a),collection:a.collection,className:a.outputType+" "+this.getClassName(a.outputType,"list")})},createDetailContainer:function(a,c){var d=this;return new b({viewFactory:function(b){return l.extend(b,{slug:a.slug}),d.createDetailElement(b,c)},className:d.getClassName(a,c?"single":"detail")})},createDetailElement:function(a){if(!a.model)return new c({});var b=this.convertItemType(a.model.get("@type")),d=this;switch(b){case"video":return new g({templateEl:"#template-"+b,scroller:!0,scrollerSelector:".wrapper",width:d.getContentWidth(),height:d.getContentHeight(),mediaOptions:{strategy:"html5",width:"100%",height:"80%",adjustSize:!0}});case"sound":return new g({templateEl:"#template-"+b,mediaOptions:{strategy:"html5"}});case"status":return new h({templateEl:"#template-"+b,scroller:!0,getImageUrl:function(){return d.getAuthorThumbnail(a.model.toJSON())}});case"photo":case"product":case"other":return new h({templateEl:"#template-"+b,scroller:!0,getImageUrl:function(){return d.getThumbnail(a.model.toJSON())}});default:return new i({templateEl:"#template-"+b,scroller:!0,imageClass:"fadein",processImageEl:function(a){var b=document.createElement("div");b.setAttribute("class","loader inv");var c=document.createElement("div");return c.setAttribute("class","figure"),c.appendChild(b),a.getAttribute("width")?c.setAttribute("style","width:"+a.getAttribute("width")+"px;max-width:100%"):c.setAttribute("style","width:"+a.getAttribute("width")+"px;max-width:100%"),a.parentNode.replaceChild(c,a),c.appendChild(a),c}})}},itemFactory:function(a){var b=this;return function(d,e){var f=d.toJSON(),g=a.outputType||b.convertItemType(f["@type"]),i="#template-"+g+"-item",j={data:{section:a},model:d,offset:e,templateEl:i};switch(g){case"photo":case"video":case"product":case"news":return j.getImageUrl=function(){return b.getThumbnail(f,e,.2)},j.imageContainer=".figure",new h(j);case"status":return j.getImageUrl=function(){return b.getAuthorThumbnail(f,e)},j.imageContainer=".figure",new h(j);default:return new c(j)}}},createRoutes:function(a,b){return{routes:{"":"home"},home:function(){a.length?window.location="#"+a[0].slug:(m("#title").html("No data"),document.body.id="nodata",m("#refresh").hide())}}},getContentWidth:function(){var a=m(".slide-panel").get(),b=l.max(a,function(a){return m(a).width()});return Math.floor(m(b).width())},getContentHeight:function(){var a=m(".slide-panel").get(),b=l.max(a,function(a){return m(a).height()});return m(b).height()},getThumbnail:function(a,b,c){if(!a)return"";c=c||.2;var d=this.clientWidth*c,e=0,f=0,g=a.thumbnail,h=null,i=null,j=null;if(g&&g.length>0){j=g[0],f=j.width||0;for(var k=0;k<g.length;k++){i=g[k],e=i.width||0;if(e>=d&&(e<f||f<d)||f<d&&e>f)j=g[k]}h=j.contentURL}return h||(a["@type"]==="ImageObject"&&a.contentURL?h=a.contentURL:a.image&&a.image.contentURL&&(h=a.image.contentURL)),h||(h=""),h},getAuthorThumbnail:function(a,b){if(!a)return"";var c="";return a.author&&a.author[0]&&(c=this.getThumbnail(a.author[0],b,.2)),c||(c=this.getThumbnail(a,b,.2)),c},slugify:function(a){return a=a.replace(/[^\-a-zA-Z0-9,&\s]+/ig,""),a=a.replace(/-/gi,"_"),a=a.replace(/\s/gi,"-"),a}}),o}),define("sleek.custom",["sleek"],function(a){return a}),define("sleek.tablet",["sleek.custom","joshlib!ui/layout","joshlib!utils/dollar","joshlib!vendor/underscore"],function(a,b,c,d){return a.extend({deviceFamily:"tablet",getClassName:function(a,b){if(b!=="list")return b==="single"?"single detail":"right-panel detail";switch(a){case"status":case"event":return"left-panel hashed-list";case"photo":return"section mosaic-list";default:return"left-panel simple-list"}},createListAndDetailView:function(a,c){var d=new b({children:{list:a,detail:c},className:"split-view"});return d},getContentWidth:function(){var a=c(".right-panel").get(),b=d.max(a,function(a){return c(a).width()});return c(b).width()},getContentHeight:function(){var a=c(".right-panel").get(),b=d.max(a,function(a){return c(a).height()});return c(b).height()},showList:function(a,b){this.showDetail(a,b,0)},moveToList:function(a){},showDetail:function(a,b,d){if(a.collection.length<=d)return;var e=b.view.children||{};e.detail?(e.detail.setModel(a.collection.at(d)),e.detail.render()):a.outputType!=="photo"&&(b.setModel(a.collection.at(d)),b.render()),e.list&&(e.list.$(".active").removeClass("active"),c(e.list.$("li")[d]).addClass("active"))},createRoutes:function(b,e){var f=a.prototype.createRoutes.call(this,b,e),g=c("#toolbar"),h=this;return d.forEach(b,function(a){f.routes[a.slug]=a.slug,f[a.slug]=function(){document.body.id=a.outputType,h.setTitle(a.name),c("iframe, audio, video, object, embed","#container").remove(),g.find(".active").removeClass("active"),g.find(".section-"+a.slug).addClass("active");var b=e.children[a.slug];a.collection.length?(h.moveToList(b),e.showChild(a.slug)):(e.showChild(a.slug),h.updateList(a,b))},a.outputType!=="photo"&&(f.routes[a.slug+"/:offset"]=a.slug+"Detail",f[a.slug+"Detail"]=function(b){b=parseInt(b,10),c("iframe, audio, video, object","#container").remove(),document.body.id=a.outputType,h.setTitle(a.name),g.find(".active").removeClass("active"),g.find(".section-"+a.slug).addClass("active");var d=e.children[a.slug];e.showChild(a.slug),a.collection.length?h.showDetail(a,d,b):h.updateDetail(a,d,b)})}),f}})}),define("app.tablet",["sleek.tablet","joshlib!utils/onready"],function(a,b){var c=new a;b(c.initialize)})